Object.defineProperty&&Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(Element.prototype,"textContent")&&!Object.getOwnPropertyDescriptor(Element.prototype,"textContent").get&&function(){var e=Object.getOwnPropertyDescriptor(Element.prototype,"innerText");Object.defineProperty(Element.prototype,"textContent",{get:function(){return e.get.call(this)},set:function(t){return e.set.call(this,t)}})}(),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});
/**
 * @license wysihtml5x v0.4.13
 * https://github.com/Edicy/wysihtml5
 *
 * Author: Christopher Blum (https://github.com/tiff)
 * Secondary author of extended features: Oliver Pulges (https://github.com/pulges)
 *
 * Copyright (C) 2012 XING AG
 * Licensed under the MIT license (MIT)
 *
 */
var wysihtml5={version:"0.4.13",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"\ufeff",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46};
/**
 * Rangy, a cross-browser JavaScript range and selection library
 * http://code.google.com/p/rangy/
 *
 * Copyright 2014, Tim Down
 * Licensed under the MIT license.
 * Version: 1.3alpha.20140804
 * Build date: 4 August 2014
 */
!function(e,t){"function"==typeof define&&define.amd?define(e):t.rangy=e()}(function(){function e(e,t){var n=typeof e[t];return n==v||!(n!=y||!e[t])||"unknown"==n}function t(e,t){return!(typeof e[t]!=y||!e[t])}function n(e,t){return typeof e[t]!=w}function o(e){return function(t,n){for(var o=n.length;o--;)if(!e(t,n[o]))return!1;return!0}}function r(e){return e&&E(e,N)&&T(e,x)}function i(e){return t(e,"body")?e.body:e.getElementsByTagName("body")[0]}function a(n){t(window,"console")&&e(window.console,"log")&&window.console.log(n)}function s(e,t){t?window.alert(e):a(e)}function l(e){_.initialized=!0,_.supported=!1,s("Rangy is not supported on this page in your browser. Reason: "+e,_.config.alertOnFail)}function c(e){s("Rangy warning: "+e,_.config.alertOnWarn)}function d(e){return e.message||e.description||String(e)}function u(){if(!_.initialized){var t,n=!1,o=!1;e(document,"createRange")&&(t=document.createRange(),E(t,C)&&T(t,b)&&(n=!0));var s=i(document);if(s&&"body"==s.nodeName.toLowerCase())if(s&&e(s,"createTextRange")&&r(t=s.createTextRange())&&(o=!0),n||o){_.initialized=!0,_.features={implementsDomRange:n,implementsTextRange:o};var c;for(var u in R)(c=R[u])instanceof f&&c.init(c,_);for(var h=0,m=O.length;h<m;++h)try{O[h](_)}catch(p){a("Rangy init listener threw an exception. Continuing. Detail: "+d(p))}}else l("Neither Range nor TextRange are available");else l("No body element found")}}function h(e){e=e||window,u();for(var t=0,n=I.length;t<n;++t)I[t](e)}function f(e,t,n){this.name=e,this.dependencies=t,this.initialized=!1,this.supported=!1,this.initializer=n}function m(e,t,n,o){var r=new f(t,n,function(e){if(!e.initialized){e.initialized=!0;try{o(_,e),e.supported=!0}catch(n){a("Module '"+t+"' failed to load: "+d(n))}}});R[t]=r}function p(){}function g(){}var y="object",v="function",w="undefined",b=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],C=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],x=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],N=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],E=o(e),S=o(t),T=o(n),R={},_={version:"1.3alpha.20140804",initialized:!1,supported:!0,util:{isHostMethod:e,isHostObject:t,isHostProperty:n,areHostMethods:E,areHostObjects:S,areHostProperties:T,isTextRange:r,getBody:i},features:{},modules:R,config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==w||rangyAutoInitialize}};_.fail=l,_.warn=c,!{}.hasOwnProperty?l("hasOwnProperty not supported"):_.util.extend=function(e,t,n){var o,r;for(var i in t)t.hasOwnProperty(i)&&(o=e[i],r=t[i],n&&null!==o&&"object"==typeof o&&null!==r&&"object"==typeof r&&_.util.extend(o,r,!0),e[i]=r);return t.hasOwnProperty("toString")&&(e.toString=t.toString),e},function(){var e=document.createElement("div");e.appendChild(document.createElement("span"));var t,n=[].slice;try{1==n.call(e.childNodes,0)[0].nodeType&&(t=function(e){return n.call(e,0)})}catch(o){}t||(t=function(e){for(var t=[],n=0,o=e.length;n<o;++n)t[n]=e[n];return t}),_.util.toArray=t}();var A;e(document,"addEventListener")?A=function(e,t,n){e.addEventListener(t,n,!1)}:e(document,"attachEvent")?A=function(e,t,n){e.attachEvent("on"+t,n)}:l("Document does not have required addEventListener or attachEvent method"),_.util.addListener=A;var O=[];_.init=u,_.addInitListener=function(e){_.initialized?e(_):O.push(e)};var I=[];_.addShimListener=function(e){I.push(e)},_.shim=_.createMissingNativeApi=h,f.prototype={init:function(){for(var e,t,n=this.dependencies||[],o=0,r=n.length;o<r;++o){if(t=n[o],!((e=R[t])&&e instanceof f))throw new Error("required module '"+t+"' not found");if(e.init(),!e.supported)throw new Error("required module '"+t+"' not supported")}this.initializer(this)},fail:function(e){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+e)},warn:function(e){_.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){_.warn("DEPRECATED: "+e+" in module "+this.name+"is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},_.createModule=function(e){var t,n;2==arguments.length?(t=arguments[1],n=[]):(t=arguments[2],n=arguments[1]);var o=m(!1,e,n,t);_.initialized&&o.init()},_.createCoreModule=function(e,t,n){m(!0,e,t,n)},_.RangePrototype=p,_.rangePrototype=new p,_.selectionPrototype=new g;var k=!1,L=function(){k||(k=!0,!_.initialized&&_.config.autoInitialize&&u())};if(typeof window!=w){if(typeof document!=w)return e(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",L,!1),A(window,"load",L),_.createCoreModule("DomUtil",[],function(e,t){function n(e){var t;return typeof e.namespaceURI==A||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t}function o(e){var t=e.parentNode;return 1==t.nodeType?t:null}function r(e){for(var t=0;e=e.previousSibling;)++t;return t}function i(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}}function a(e,t){var n,o=[];for(n=e;n;n=n.parentNode)o.push(n);for(n=t;n;n=n.parentNode)if(L(o,n))return n;return null}function s(e,t,n){for(var o=n?t:t.parentNode;o;){if(o===e)return!0;o=o.parentNode}return!1}function l(e,t){return s(e,t,!0)}function c(e,t,n){for(var o,r=n?e:e.parentNode;r;){if((o=r.parentNode)===t)return r;r=o}return null}function d(e){var t=e.nodeType;return 3==t||4==t||8==t}function u(e){if(!e)return!1;var t=e.nodeType;return 3==t||8==t}function h(e,t){var n=t.nextSibling,o=t.parentNode;return n?o.insertBefore(e,n):o.appendChild(e),e}function f(e,t,n){var o=e.cloneNode(!1);if(o.deleteData(0,t),e.deleteData(t,e.length-t),h(o,e),n)for(var i,a=0;i=n[a++];)i.node==e&&i.offset>t?(i.node=o,i.offset-=t):i.node==e.parentNode&&i.offset>r(e)&&++i.offset;return o}function m(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=A)return e.ownerDocument;if(typeof e.document!=A)return e.document;if(e.parentNode)return m(e.parentNode);throw t.createError("getDocument: no document found for node")}function p(e){var n=m(e);if(typeof n.defaultView!=A)return n.defaultView;if(typeof n.parentWindow!=A)return n.parentWindow;throw t.createError("Cannot get a window object for node")}function g(e){if(typeof e.contentDocument!=A)return e.contentDocument;if(typeof e.contentWindow!=A)return e.contentWindow.document;throw t.createError("getIframeDocument: No Document object found for iframe element")}function y(e){if(typeof e.contentWindow!=A)return e.contentWindow;if(typeof e.contentDocument!=A)return e.contentDocument.defaultView;throw t.createError("getIframeWindow: No Window object found for iframe element")}function v(e){return e&&O.isHostMethod(e,"setTimeout")&&O.isHostObject(e,"document")}function w(e,t,n){var o;if(e?O.isHostProperty(e,"nodeType")?o=1==e.nodeType&&"iframe"==e.tagName.toLowerCase()?g(e):m(e):v(e)&&(o=e.document):o=document,!o)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return o}function b(e){for(var t;t=e.parentNode;)e=t;return e}function C(e,n,o,i){var s,l,d,u,h;if(e==o)return n===i?0:n<i?-1:1;if(s=c(o,e,!0))return n<=r(s)?-1:1;if(s=c(e,o,!0))return r(s)<i?-1:1;if(!(l=a(e,o)))throw new Error("comparePoints error: nodes have no common ancestor");if((d=e===l?l:c(e,l,!0))===(u=o===l?l:c(o,l,!0)))throw t.createError("comparePoints got to case 4 and childA and childB are the same!");for(h=l.firstChild;h;){if(h===d)return-1;if(h===u)return 1;h=h.nextSibling}}function x(e){try{return e.parentNode,!1}catch(t){return!0}}function N(e){if(!e)return"[No node]";if(D&&x(e))return"[Broken node]";if(d(e))return'"'+e.data+'"';if(1==e.nodeType){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">[index:"+r(e)+",length:"+e.childNodes.length+"]["+(e.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return e.nodeName}function E(e){for(var t,n=m(e).createDocumentFragment();t=e.firstChild;)n.appendChild(t);return n}function S(e){this.root=e,this._next=e}function T(e){return new S(e)}function R(e,t){this.node=e,this.offset=t}function _(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}var A="undefined",O=e.util;O.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),O.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var I=document.createElement("div");O.areHostMethods(I,["insertBefore","appendChild","cloneNode"]||!O.areHostObjects(I,["previousSibling","nextSibling","childNodes","parentNode"]))||t.fail("Incomplete Element implementation"),O.isHostProperty(I,"innerHTML")||t.fail("Element is missing innerHTML property");var k=document.createTextNode("test");O.areHostMethods(k,["splitText","deleteData","insertData","appendData","cloneNode"]||!O.areHostObjects(I,["previousSibling","nextSibling","childNodes","parentNode"])||!O.areHostProperties(k,["data"]))||t.fail("Incomplete Text Node implementation");var L=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1},D=!1;!function(){var t=document.createElement("b");t.innerHTML="1";var n=t.firstChild;t.innerHTML="<br>",D=x(n),e.features.crashyTextNodes=D}();var M;typeof window.getComputedStyle!=A?M=function(e,t){return p(e).getComputedStyle(e,null)[t]}:typeof document.documentElement.currentStyle!=A?M=function(e,t){return e.currentStyle[t]}:t.fail("No means of obtaining computed style properties found"),S.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e,t,n=this._current=this._next;if(this._current)if(e=n.firstChild)this._next=e;else{for(t=null;n!==this.root&&!(t=n.nextSibling);)n=n.parentNode;this._next=t}return this._current},detach:function(){this._current=this._next=this.root=null}},R.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+N(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},_.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},_.prototype.toString=function(){return this.message},e.dom={arrayContains:L,isHtmlNamespace:n,parentElement:o,getNodeIndex:r,getNodeLength:i,getCommonAncestor:a,isAncestorOf:s,isOrIsAncestorOf:l,getClosestAncestorIn:c,isCharacterDataNode:d,isTextOrCommentNode:u,insertAfter:h,splitDataNode:f,getDocument:m,getWindow:p,getIframeWindow:y,getIframeDocument:g,getBody:O.getBody,isWindow:v,getContentDocument:w,getRootContainer:b,comparePoints:C,isBrokenNode:x,inspectNode:N,getComputedStyleProperty:M,fragmentFromNodeChildren:E,createIterator:T,DomPosition:R},e.DOMException=_}),_.createCoreModule("DomRange",["DomUtil"],function(e){function t(e,t){return 3!=e.nodeType&&(q(e,t.startContainer)||q(e,t.endContainer))}function n(e){return e.document||V(e.startContainer)}function o(e){return new B(e.parentNode,z(e))}function r(e){return new B(e.parentNode,z(e)+1)}function i(e,t,n){var o=11==e.nodeType?e.firstChild:e;return H(t)?n==t.length?D.insertAfter(e,t):t.parentNode.insertBefore(e,0==n?t:W(t,n)):n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]),o}function a(e,t,o){if(E(e),E(t),n(t)!=n(e))throw new P("WRONG_DOCUMENT_ERR");var r=U(e.startContainer,e.startOffset,t.endContainer,t.endOffset),i=U(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return o?r<=0&&i>=0:r<0&&i>0}function s(e){for(var t,o,r,i=n(e.range).createDocumentFragment();o=e.next();){if(t=e.isPartiallySelectedSubtree(),o=o.cloneNode(!t),t&&(r=e.getSubtreeIterator(),o.appendChild(s(r)),r.detach()),10==o.nodeType)throw new P("HIERARCHY_REQUEST_ERR");i.appendChild(o)}return i}function l(e,t,n){var o,r;n=n||{stop:!1};for(var i,a;i=e.next();)if(e.isPartiallySelectedSubtree()){if(!1===t(i))return void(n.stop=!0);if(l(a=e.getSubtreeIterator(),t,n),a.detach(),n.stop)return}else for(o=D.createIterator(i);r=o.next();)if(!1===t(r))return void(n.stop=!0)}function c(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(c(t=e.getSubtreeIterator()),t.detach()):e.remove()}function d(e){for(var t,o,r=n(e.range).createDocumentFragment();t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),o=e.getSubtreeIterator(),t.appendChild(d(o)),o.detach()):e.remove(),10==t.nodeType)throw new P("HIERARCHY_REQUEST_ERR");r.appendChild(t)}return r}function u(e,t,n){var o,r=!(!t||!t.length),i=!!n;r&&(o=new RegExp("^("+t.join("|")+")$"));var a=[];return l(new f(e,!1),function(t){if((!r||o.test(t.nodeType))&&(!i||n(t))){var s=e.startContainer;if(t!=s||!H(s)||e.startOffset!=s.length){var l=e.endContainer;t==l&&H(l)&&0==e.endOffset||a.push(t)}}}),a}function h(e){return"["+("undefined"==typeof e.getName?"Range":e.getName())+"("+D.inspectNode(e.startContainer)+":"+e.startOffset+", "+D.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function f(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&H(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||H(this.sc)?j(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||H(this.ec)?j(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}function m(e){return function(t,n){for(var o,r=n?t:t.parentNode;r;){if(o=r.nodeType,K(e,o))return r;r=r.parentNode}return null}}function p(e,t){if(ne(e,t))throw new P("INVALID_NODE_TYPE_ERR")}function g(e,t){if(!K(t,e.nodeType))throw new P("INVALID_NODE_TYPE_ERR")}function y(e,t){if(t<0||t>(H(e)?e.length:e.childNodes.length))throw new P("INDEX_SIZE_ERR")}function v(e,t){if(ee(e,!0)!==ee(t,!0))throw new P("WRONG_DOCUMENT_ERR")}function w(e){if(te(e,!0))throw new P("NO_MODIFICATION_ALLOWED_ERR")}function b(e,t){if(!e)throw new P(t)}function C(e){return G&&D.isBrokenNode(e)||!K(Y,e.nodeType)&&!ee(e,!0)}function x(e,t){return t<=(H(e)?e.length:e.childNodes.length)}function N(e){return!!e.startContainer&&!!e.endContainer&&!C(e.startContainer)&&!C(e.endContainer)&&x(e.startContainer,e.startOffset)&&x(e.endContainer,e.endOffset)}function E(e){if(!N(e))throw new Error("Range error: Range is no longer valid after DOM mutation ("+e.inspect()+")")}function S(e,t){E(e);var n=e.startContainer,o=e.startOffset,r=e.endContainer,i=e.endOffset,a=n===r;H(r)&&i>0&&i<r.length&&W(r,i,t),H(n)&&o>0&&o<n.length&&(n=W(n,o,t),a?(i-=o,r=n):r==n.parentNode&&i>=z(n)&&i++,o=0),e.setStartAndEnd(n,o,r,i)}function T(e){E(e);var t=e.commonAncestorContainer.parentNode.cloneNode(!1);return t.appendChild(e.cloneContents()),t.innerHTML}function R(e){e.START_TO_START=se,e.START_TO_END=le,e.END_TO_END=ce,e.END_TO_START=de,e.NODE_BEFORE=ue,e.NODE_AFTER=he,e.NODE_BEFORE_AND_AFTER=fe,e.NODE_INSIDE=me}function _(e){R(e),R(e.prototype)}function A(e,t){return function(){E(this);var n,o=this.startContainer,i=this.startOffset,a=this.commonAncestorContainer,s=new f(this,!0);o!==a&&(o=(n=r(j(o,a,!0))).node,i=n.offset),l(s,w),s.reset();var c=e(s);return s.detach(),t(this,o,i,o,i),c}}function O(n,i){function a(e,t){return function(n){g(n,X),g($(n),Y);var i=(e?o:r)(n);(t?s:l)(this,i.node,i.offset)}}function s(e,t,n){var o=e.endContainer,r=e.endOffset;t===e.startContainer&&n===e.startOffset||($(t)==$(o)&&1!=U(t,n,o,r)||(o=t,r=n),i(e,t,n,o,r))}function l(e,t,n){var o=e.startContainer,r=e.startOffset;t===e.endContainer&&n===e.endOffset||($(t)==$(o)&&-1!=U(t,n,o,r)||(o=t,r=n),i(e,o,r,t,n))}var u=function(){};u.prototype=e.rangePrototype,n.prototype=new u,M.extend(n.prototype,{setStart:function(e,t){p(e,!0),y(e,t),s(this,e,t)},setEnd:function(e,t){p(e,!0),y(e,t),l(this,e,t)},setStartAndEnd:function(){var e=arguments,t=e[0],n=e[1],o=t,r=n;switch(e.length){case 3:r=e[2];break;case 4:o=e[2],r=e[3]}i(this,t,n,o,r)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:a(!0,!0),setStartAfter:a(!1,!0),setEndBefore:a(!0,!1),setEndAfter:a(!1,!1),collapse:function(e){E(this),e?i(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):i(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){p(e,!0),i(this,e,0,e,F(e))},selectNode:function(e){p(e,!1),g(e,X);var t=o(e),n=r(e);i(this,t.node,t.offset,n.node,n.offset)},extractContents:A(d,i),deleteContents:A(c,i),canSurroundContents:function(){E(this),w(this.startContainer),w(this.endContainer);var e=new f(this,!0),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);return e.detach(),!n},splitBoundaries:function(){S(this)},splitBoundariesPreservingPositions:function(e){S(this,e)},normalizeBoundaries:function(){E(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,o=this.endOffset,r=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(n=e,o=e.length,e.appendData(t.data),t.parentNode.removeChild(t))},a=function(r){var i=r.previousSibling;if(i&&i.nodeType==r.nodeType){e=r;var a=r.length;if(t=i.length,r.insertData(0,i.data),i.parentNode.removeChild(i),e==n)o+=t,n=e;else if(n==r.parentNode){var s=z(r);o==s?(n=r,o=a):o>s&&o--}}},s=!0;if(H(n))n.length==o&&r(n);else{if(o>0){var l=n.childNodes[o-1];l&&H(l)&&r(l)}s=!this.collapsed}if(s){if(H(e))0==t&&a(e);else if(t<e.childNodes.length){var c=e.childNodes[t];c&&H(c)&&a(c)}}else e=n,t=o;i(this,e,t,n,o)},collapseToPoint:function(e,t){p(e,!0),y(e,t),this.setStartAndEnd(e,t)}}),_(n)}function I(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:D.getCommonAncestor(e.startContainer,e.endContainer)}function k(e,t,n,o,r){e.startContainer=t,e.startOffset=n,e.endContainer=o,e.endOffset=r,e.document=D.getDocument(t),I(e)}function L(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this.document=e,I(this)}var D=e.dom,M=e.util,B=D.DomPosition,P=e.DOMException,H=D.isCharacterDataNode,z=D.getNodeIndex,q=D.isOrIsAncestorOf,V=D.getDocument,U=D.comparePoints,W=D.splitDataNode,j=D.getClosestAncestorIn,F=D.getNodeLength,K=D.arrayContains,$=D.getRootContainer,G=e.features.crashyTextNodes;f.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,H(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e,t,n=this._current;!H(n)||n!==this.sc&&n!==this.ec?n.parentNode&&n.parentNode.removeChild(n):(e=n===this.sc?this.so:0)!=(t=n===this.ec?this.eo:n.length)&&n.deleteData(e,t-e)},isPartiallySelectedSubtree:function(){return t(this._current,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)(e=this.range.cloneRange()).collapse(!1);else{e=new L(n(this.range));var t=this._current,o=t,r=0,i=t,a=F(t);q(t,this.sc)&&(o=this.sc,r=this.so),q(t,this.ec)&&(i=this.ec,a=this.eo),k(e,o,r,i,a)}return new f(e,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var X=[1,3,4,5,7,8,10],Y=[2,9,11],Q=[5,6,10,12],Z=[1,3,4,5,7,8,10,11],J=[1,3,4,5,7,8],ee=m([9,11]),te=m(Q),ne=m([6,10,12]),oe=document.createElement("style"),re=!1;try{oe.innerHTML="<b>x</b>",re=3==oe.firstChild.nodeType}catch(pe){}e.features.htmlParsingConforms=re;var ie=re?function(e){var t=this.startContainer,n=V(t);if(!t)throw new P("INVALID_STATE_ERR");var o=null;return 1==t.nodeType?o=t:H(t)&&(o=D.parentElement(t)),(o=null===o||"HTML"==o.nodeName&&D.isHtmlNamespace(V(o).documentElement)&&D.isHtmlNamespace(o)?n.createElement("body"):o.cloneNode(!1)).innerHTML=e,D.fragmentFromNodeChildren(o)}:function(e){var t=n(this).createElement("body");return t.innerHTML=e,D.fragmentFromNodeChildren(t)},ae=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],se=0,le=1,ce=2,de=3,ue=0,he=1,fe=2,me=3;M.extend(e.rangePrototype,{compareBoundaryPoints:function(e,t){E(this),v(this.startContainer,t.startContainer);var n,o,r,i,a=e==de||e==se?"start":"end",s=e==le||e==se?"start":"end";return n=this[a+"Container"],o=this[a+"Offset"],r=t[s+"Container"],i=t[s+"Offset"],U(n,o,r,i)},insertNode:function(e){if(E(this),g(e,Z),w(this.startContainer),q(e,this.startContainer))throw new P("HIERARCHY_REQUEST_ERR");var t=i(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){E(this);var e,t;if(this.collapsed)return n(this).createDocumentFragment();if(this.startContainer===this.endContainer&&H(this.startContainer))return(e=this.startContainer.cloneNode(!0)).data=e.data.slice(this.startOffset,this.endOffset),(t=n(this).createDocumentFragment()).appendChild(e),t;var o=new f(this,!0);return e=s(o),o.detach(),e},canSurroundContents:function(){E(this),w(this.startContainer),w(this.endContainer);var e=new f(this,!0),n=e._first&&t(e._first,this)||e._last&&t(e._last,this);return e.detach(),!n},surroundContents:function(e){if(g(e,J),!this.canSurroundContents())throw new P("INVALID_STATE_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);i(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){E(this);for(var e,t=new L(n(this)),o=ae.length;o--;)t[e=ae[o]]=this[e];return t},toString:function(){E(this);var e=this.startContainer;if(e===this.endContainer&&H(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new f(this,!0);return l(n,function(e){3!=e.nodeType&&4!=e.nodeType||t.push(e.data)}),n.detach(),t.join("")},compareNode:function(e){E(this);var t=e.parentNode,n=z(e);if(!t)throw new P("NOT_FOUND_ERR");var o=this.comparePoint(t,n),r=this.comparePoint(t,n+1);return o<0?r>0?fe:ue:r>0?he:me},comparePoint:function(e,t){return E(this),b(e,"HIERARCHY_REQUEST_ERR"),v(e,this.startContainer),U(e,t,this.startContainer,this.startOffset)<0?-1:U(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:ie,toHtml:function(){return T(this)},intersectsNode:function(e,t){if(E(this),b(e,"NOT_FOUND_ERR"),V(e)!==n(this))return!1;var o=e.parentNode,r=z(e);b(o,"NOT_FOUND_ERR");var i=U(o,r,this.endContainer,this.endOffset),a=U(o,r+1,this.startContainer,this.startOffset);return t?i<=0&&a>=0:i<0&&a>0},isPointInRange:function(e,t){return E(this),b(e,"HIERARCHY_REQUEST_ERR"),v(e,this.startContainer),U(e,t,this.startContainer,this.startOffset)>=0&&U(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return a(this,e,!1)},intersectsOrTouchesRange:function(e){return a(this,e,!0)},intersection:function(e){if(this.intersectsRange(e)){var t=U(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=U(this.endContainer,this.endOffset,e.endContainer,e.endOffset),o=this.cloneRange();return-1==t&&o.setStart(e.startContainer,e.startOffset),1==n&&o.setEnd(e.endContainer,e.endOffset),o}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();return-1==U(e.startContainer,e.startOffset,this.startContainer,this.startOffset)&&t.setStart(e.startContainer,e.startOffset),1==U(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new P("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==me},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,F(e))<=0},containsRange:function(e){var t=this.intersection(e);return null!==t&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var o=n.pop();return t.setEnd(o,o.length),this.containsRange(t)}return this.containsNodeContents(e)},getNodes:function(e,t){return E(this),u(this,e,t)},getDocument:function(){return n(this)},collapseBefore:function(e){this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){this.setStartAfter(e),this.collapse(!0)},getBookmark:function(t){var o=n(this),r=e.createRange(o);t=t||D.getBody(o),r.selectNodeContents(t);var i=this.intersection(r),a=0,s=0;return i&&(r.setEnd(i.startContainer,i.startOffset),s=(a=r.toString().length)+i.toString().length),{start:a,end:s,containerNode:t}},moveToBookmark:function(e){var t=e.containerNode,n=0;this.setStart(t,0),this.collapse(!0);for(var o,r,i,a,s=[t],l=!1,c=!1;!c&&(o=s.pop());)if(3==o.nodeType)r=n+o.length,!l&&e.start>=n&&e.start<=r&&(this.setStart(o,e.start-n),l=!0),l&&e.end>=n&&e.end<=r&&(this.setEnd(o,e.end-n),c=!0),n=r;else for(i=(a=o.childNodes).length;i--;)s.push(a[i])},getName:function(){return"DomRange"},equals:function(e){return L.rangesEqual(this,e)},isValid:function(){return N(this)},inspect:function(){return h(this)},detach:function(){}}),O(L,k),M.extend(L,{rangeProperties:ae,RangeIterator:f,copyComparisonConstants:_,createPrototypeRange:O,inspect:h,toHtml:T,getRangeDocument:n,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}}),e.DomRange=L}),_.createCoreModule("WrappedRange",["DomRange"],function(e,t){var n,o,r=e.dom,i=e.util,a=r.DomPosition,s=e.DomRange,l=r.getBody,c=r.getContentDocument,d=r.isCharacterDataNode;if(e.features.implementsDomRange&&function(){function o(e){for(var t,n=h.length;n--;)e[t=h[n]]=e.nativeRange[t];e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}function a(e,t,n,o,r){var i=e.startContainer!==t||e.startOffset!=n,a=e.endContainer!==o||e.endOffset!=r,s=!e.equals(e.nativeRange);(i||a||s)&&(e.setEnd(o,r),e.setStart(t,n))}var d,u,h=s.rangeProperties;n=function(e){if(!e)throw t.createError("WrappedRange: Range must be specified");this.nativeRange=e,o(this)},s.createPrototypeRange(n,a),(d=n.prototype).selectNode=function(e){this.nativeRange.selectNode(e),o(this)},d.cloneContents=function(){return this.nativeRange.cloneContents()},d.surroundContents=function(e){this.nativeRange.surroundContents(e),o(this)},d.collapse=function(e){this.nativeRange.collapse(e),o(this)},d.cloneRange=function(){return new n(this.nativeRange.cloneRange())},d.refresh=function(){o(this)},d.toString=function(){return this.nativeRange.toString()};var f=document.createTextNode("test");l(document).appendChild(f);var m=document.createRange();m.setStart(f,0),m.setEnd(f,0);try{m.setStart(f,1),d.setStart=function(e,t){this.nativeRange.setStart(e,t),o(this)},d.setEnd=function(e,t){this.nativeRange.setEnd(e,t),o(this)},u=function(e){return function(t){this.nativeRange[e](t),o(this)}}}catch(w){d.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(w){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}o(this)},d.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(w){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}o(this)},u=function(e,t){return function(n){try{this.nativeRange[e](n)}catch(w){this.nativeRange[t](n),this.nativeRange[e](n)}o(this)}}}d.setStartBefore=u("setStartBefore","setEndBefore"),d.setStartAfter=u("setStartAfter","setEndAfter"),d.setEndBefore=u("setEndBefore","setStartBefore"),d.setEndAfter=u("setEndAfter","setStartAfter"),d.selectNodeContents=function(e){this.setStartAndEnd(e,0,r.getNodeLength(e))},m.selectNodeContents(f),m.setEnd(f,3);var p=document.createRange();p.selectNodeContents(f),p.setEnd(f,4),p.setStart(f,2),-1==m.compareBoundaryPoints(m.START_TO_END,p)&&1==m.compareBoundaryPoints(m.END_TO_START,p)?d.compareBoundaryPoints=function(e,t){return e==(t=t.nativeRange||t).START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:d.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var g=document.createElement("div");g.innerHTML="123";var y=g.firstChild,v=l(document);v.appendChild(g),m.setStart(y,1),m.setEnd(y,2),m.deleteContents(),"13"==y.data&&(d.deleteContents=function(){this.nativeRange.deleteContents(),o(this)},d.extractContents=function(){var e=this.nativeRange.extractContents();return o(this),e}),v.removeChild(g),v=null,i.isHostMethod(m,"createContextualFragment")&&(d.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),l(document).removeChild(f),d.getName=function(){return"WrappedRange"},e.WrappedRange=n,e.createNativeRange=function(e){return(e=c(e,t,"createNativeRange")).createRange()}}(),e.features.implementsTextRange){var u=function(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var o=n.parentElement();(n=e.duplicate()).collapse(!1);var i=n.parentElement(),a=o==i?o:r.getCommonAncestor(o,i);return a==t?a:r.getCommonAncestor(t,a)},h=function(e){return 0==e.compareEndPoints("StartToEnd",e)},f=function(e,t,n,o,i){var s=e.duplicate();s.collapse(n);var l=s.parentElement();if(r.isOrIsAncestorOf(t,l)||(l=t),!l.canHaveHTML){var c=new a(l.parentNode,r.getNodeIndex(l));return{boundaryPosition:c,nodeInfo:{nodeIndex:c.offset,containerElement:c.node}}}var u=r.getDocument(l).createElement("span");u.parentNode&&u.parentNode.removeChild(u);for(var h,f,m,p,g,y=n?"StartToStart":"StartToEnd",v=i&&i.containerElement==l?i.nodeIndex:0,w=l.childNodes.length,b=w,C=b;C==w?l.appendChild(u):l.insertBefore(u,l.childNodes[C]),s.moveToElementText(u),0!=(h=s.compareEndPoints(y,e))&&v!=b;){if(-1==h){if(b==v+1)break;v=C}else b=b==v+1?v:C;C=Math.floor((v+b)/2),l.removeChild(u)}if(g=u.nextSibling,-1==h&&g&&d(g)){s.setEndPoint(n?"EndToStart":"EndToEnd",e);var x;if(/[\r\n]/.test(g.data)){var N=s.duplicate(),E=N.text.replace(/\r\n/g,"\r").length;for(x=N.moveStart("character",E);-1==(h=N.compareEndPoints("StartToEnd",N));)x++,N.moveStart("character",1)}else x=s.text.length;p=new a(g,x)}else f=(o||!n)&&u.previousSibling,p=(m=(o||n)&&u.nextSibling)&&d(m)?new a(m,0):f&&d(f)?new a(f,f.data.length):new a(l,r.getNodeIndex(u));return u.parentNode.removeChild(u),{boundaryPosition:p,nodeInfo:{nodeIndex:C,containerElement:l}}},m=function(e,t){var n,o,i,a,s=e.offset,c=r.getDocument(e.node),u=l(c).createTextRange(),h=d(e.node);return h?o=(n=e.node).parentNode:(n=s<(a=e.node.childNodes).length?a[s]:null,o=e.node),(i=c.createElement("span")).innerHTML="&#feff;",n?o.insertBefore(i,n):o.appendChild(i),u.moveToElementText(i),u.collapse(!t),o.removeChild(i),h&&u[t?"moveStart":"moveEnd"]("character",s),u};(o=function(e){this.textRange=e,this.refresh()}).prototype=new s(document),o.prototype.refresh=function(){var e,t,n,o=u(this.textRange);h(this.textRange)?t=e=f(this.textRange,o,!0,!0).boundaryPosition:(e=(n=f(this.textRange,o,!0,!1)).boundaryPosition,t=f(this.textRange,o,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},o.prototype.getName=function(){return"WrappedTextRange"},s.copyComparisonConstants(o);var p=function(e){if(e.collapsed)return m(new a(e.startContainer,e.startOffset),!0);var t=m(new a(e.startContainer,e.startOffset),!0),n=m(new a(e.endContainer,e.endOffset),!1),o=l(s.getRangeDocument(e)).createTextRange();return o.setEndPoint("StartToStart",t),o.setEndPoint("EndToEnd",n),o};if(o.rangeToTextRange=p,o.prototype.toTextRange=function(){return p(this)},e.WrappedTextRange=o,!e.features.implementsDomRange||e.config.preferTextRange){var g=function(){return this}();"undefined"==typeof g.Range&&(g.Range=o),e.createNativeRange=function(e){return e=c(e,t,"createNativeRange"),l(e).createTextRange()},e.WrappedRange=o}}e.createRange=function(n){return n=c(n,t,"createRange"),new e.WrappedRange(e.createNativeRange(n))},e.createRangyRange=function(e){return e=c(e,t,"createRangyRange"),new s(e)},e.createIframeRange=function(n){return t.deprecationNotice("createIframeRange()","createRange(iframeEl)"),e.createRange(n)},e.createIframeRangyRange=function(n){return t.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)"),e.createRangyRange(n)},e.addShimListener(function(t){var n=t.document;"undefined"==typeof n.createRange&&(n.createRange=function(){return e.createRange(n)}),n=t=null})}),_.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(e,t){
function n(e){return"string"==typeof e?/^backward(s)?$/i.test(e):!!e}function o(e,n){if(e){if(_.isWindow(e))return e;if(e instanceof y)return e.win;var o=_.getContentDocument(e,t,n);return _.getWindow(o)}return window}function r(e){return o(e,"getWinSelection").getSelection()}function i(e){return o(e,"getDocSelection").document.selection}function a(e){var t=!1;return e.anchorNode&&(t=1==_.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t}function s(e,t,n){var o=n?"end":"start",r=n?"start":"end";e.anchorNode=t[o+"Container"],e.anchorOffset=t[o+"Offset"],e.focusNode=t[r+"Container"],e.focusOffset=t[r+"Offset"]}function l(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function c(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function d(t){var n;return t instanceof I?((n=e.createNativeRange(t.getDocument())).setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset)):t instanceof k?n=t.nativeRange:M.implementsDomRange&&t instanceof _.getWindow(t.startContainer).Range&&(n=t),n}function u(e){if(!e.length||1!=e[0].nodeType)return!1;for(var t=1,n=e.length;t<n;++t)if(!_.isAncestorOf(e[0],e[t]))return!1;return!0}function h(e){var n=e.getNodes();if(!u(n))throw t.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return n[0]}function f(e){return!!e&&"undefined"!=typeof e.text}function m(e,t){var n=new k(t);e._ranges=[n],s(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function p(t){if(t._ranges.length=0,"None"==t.docSelection.type)c(t);else{var n=t.docSelection.createRange();if(f(n))m(t,n);else{t.rangeCount=n.length;for(var o,r=P(n.item(0)),i=0;i<t.rangeCount;++i)(o=e.createRange(r)).selectNode(n.item(i)),t._ranges.push(o);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed,s(t,t._ranges[t.rangeCount-1],!1)}}}function g(e,n){for(var o=e.docSelection.createRange(),r=h(n),i=P(o.item(0)),a=H(i).createControlRange(),s=0,l=o.length;s<l;++s)a.add(o.item(s));try{a.add(r)}catch(c){throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}a.select(),p(e)}function y(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function v(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0}function w(e,t){for(var n,o,r=te.length;r--;)if(o=(n=te[r]).selection,"deleteAll"==t)v(o);else if(n.win==e)return"delete"==t?(te.splice(r,1),!0):o;return"deleteAll"==t&&(te.length=0),null}function b(e,n){for(var o,r=P(n[0].startContainer),i=H(r).createControlRange(),a=0,s=n.length;a<s;++a){o=h(n[a]);try{i.add(o)}catch(l){throw t.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}i.select(),p(e)}function C(e,t){if(e.win.document!=P(t))throw new L("WRONG_DOCUMENT_ERR")}function x(t){return function(n,o){var r;this.rangeCount?(r=this.getRangeAt(0))["set"+(t?"Start":"End")](n,o):(r=e.createRange(this.win.document)).setStartAndEnd(n,o),this.setSingleRange(r,this.isBackward())}}function N(e){var t=[],n=new D(e.anchorNode,e.anchorOffset),o=new D(e.focusNode,e.focusOffset),r="function"==typeof e.getName?e.getName():"Selection";if("undefined"!=typeof e.rangeCount)for(var i=0,a=e.rangeCount;i<a;++i)t[i]=I.inspect(e.getRangeAt(i));return"["+r+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+o.inspect()+"]"}e.config.checkSelectionRanges=!0;var E,S,T="boolean",R="number",_=e.dom,A=e.util,O=A.isHostMethod,I=e.DomRange,k=e.WrappedRange,L=e.DOMException,D=_.DomPosition,M=e.features,B="Control",P=_.getDocument,H=_.getBody,z=I.rangesEqual,q=O(window,"getSelection"),V=A.isHostObject(document,"selection");M.implementsWinGetSelection=q,M.implementsDocSelection=V;var U=V&&(!q||e.config.preferTextRange);U?(E=i,e.isSelectionValid=function(e){var t=o(e,"isSelectionValid").document,n=t.selection;return"None"!=n.type||P(n.createRange().parentElement())==t}):q?(E=r,e.isSelectionValid=function(){return!0}):t.fail("Neither document.selection or window.getSelection() detected."),e.getNativeSelection=E;var W=E(),j=e.createNativeRange(document),F=H(document),K=A.areHostProperties(W,["anchorNode","focusNode","anchorOffset","focusOffset"]);M.selectionHasAnchorAndFocus=K;var $=O(W,"extend");M.selectionHasExtend=$;var G=typeof W.rangeCount==R;M.selectionHasRangeCount=G;var X=!1,Y=!0,Q=$?function(t,n){var o=I.getRangeDocument(n),r=e.createRange(o);r.collapseToPoint(n.endContainer,n.endOffset),t.addRange(d(r)),t.extend(n.startContainer,n.startOffset)}:null;A.areHostMethods(W,["addRange","getRangeAt","removeAllRanges"])&&typeof W.rangeCount==R&&M.implementsDomRange&&function(){var t=window.getSelection();if(t){for(var n=t.rangeCount,o=n>1,r=[],i=a(t),s=0;s<n;++s)r[s]=t.getRangeAt(s);var l=H(document),c=l.appendChild(document.createElement("div"));c.contentEditable="false";var d=c.appendChild(document.createTextNode("\xa0\xa0\xa0")),u=document.createRange();if(u.setStart(d,1),u.collapse(!0),t.addRange(u),Y=1==t.rangeCount,t.removeAllRanges(),!o){var h=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(h&&parseInt(h[1])>=36)X=!1;else{var f=u.cloneRange();u.setStart(d,0),f.setEnd(d,3),f.setStart(d,2),t.addRange(u),t.addRange(f),X=2==t.rangeCount}}for(l.removeChild(c),t.removeAllRanges(),s=0;s<n;++s)0==s&&i?Q?Q(t,r[s]):(e.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),t.addRange(r[s])):t.addRange(r[s])}}(),M.selectionSupportsMultipleRanges=X,M.collapsedNonEditableSelectionsSupported=Y;var Z,J=!1;F&&O(F,"createControlRange")&&(Z=F.createControlRange(),A.areHostProperties(Z,["item","add"])&&(J=!0)),M.implementsControlRange=J,S=K?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return!!e.rangeCount&&e.getRangeAt(e.rangeCount-1).collapsed};var ee;O(W,"getRangeAt")?ee=function(e,t){try{return e.getRangeAt(t)}catch(n){return null}}:K&&(ee=function(t){var n=P(t.anchorNode),o=e.createRange(n);return o.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),o.collapsed!==this.isCollapsed&&o.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),o}),y.prototype=e.selectionPrototype;var te=[],ne=function(e){if(e&&e instanceof y)return e.refresh(),e;var t=w(e=o(e,"getNativeSelection")),n=E(e),r=V?i(e):null;return t?(t.nativeSelection=n,t.docSelection=r,t.refresh()):(t=new y(n,r,e),te.push({win:e,selection:t})),t};e.getSelection=ne,e.getIframeSelection=function(n){return t.deprecationNotice("getIframeSelection()","getSelection(iframeEl)"),e.getSelection(_.getIframeWindow(n))};var oe=y.prototype;if(!U&&K&&A.areHostMethods(W,["removeAllRanges","addRange"])){oe.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),c(this)};var re=function(e,t){Q(e.nativeSelection,t),e.refresh()};oe.addRange=G?function(t,o){if(J&&V&&this.docSelection.type==B)g(this,t);else if(n(o)&&$)re(this,t);else{var r;if(X?r=this.rangeCount:(this.removeAllRanges(),r=0),this.nativeSelection.addRange(d(t).cloneRange()),this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==r+1){if(e.config.checkSelectionRanges){var i=ee(this.nativeSelection,this.rangeCount-1);i&&!z(i,t)&&(t=new k(i))}this._ranges[this.rangeCount-1]=t,s(this,t,se(this.nativeSelection)),this.isCollapsed=S(this)}else this.refresh()}}:function(e,t){n(t)&&$?re(this,e):(this.nativeSelection.addRange(d(e)),this.refresh())},oe.setRanges=function(e){if(J&&V&&e.length>1)b(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else{if(!(O(W,"empty")&&O(j,"select")&&J&&U))return t.fail("No means of selecting a Range or TextRange was found"),!1;oe.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode)e=P(this.anchorNode);else if(this.docSelection.type==B){var t=this.docSelection.createRange();t.length&&(e=P(t.item(0)))}if(e){H(e).createTextRange().select(),this.docSelection.empty()}}}catch(n){}c(this)},oe.addRange=function(t){this.docSelection.type==B?g(this,t):(e.WrappedTextRange.rangeToTextRange(t).select(),this._ranges[0]=t,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,s(this,t,!1))},oe.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?b(this,e):t&&this.addRange(e[0])}}oe.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new L("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()};var ie;if(U)ie=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=H(t.win.document).createTextRange()).collapse(!0),t.docSelection.type==B?p(t):f(n)?m(t,n):c(t)};else if(O(W,"getRangeAt")&&typeof W.rangeCount==R)ie=function(t){if(J&&V&&t.docSelection.type==B)p(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var n=0,o=t.rangeCount;n<o;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));s(t,t._ranges[t.rangeCount-1],se(t.nativeSelection)),t.isCollapsed=S(t)}else c(t)};else{if(!K||typeof W.isCollapsed!=T||typeof j.collapsed!=T||!M.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;ie=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=ee(n,0),e._ranges=[t],e.rangeCount=1,l(e),e.isCollapsed=S(e)):c(e)}}oe.refresh=function(e){var t=e?this._ranges.slice(0):null,n=this.anchorNode,o=this.anchorOffset;if(ie(this),e){var r=t.length;if(r!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=o)return!0;for(;r--;)if(!z(t[r],this._ranges[r]))return!0;return!1}};var ae=function(e,t){var n=e.getAllRanges();e.removeAllRanges();for(var o=0,r=n.length;o<r;++o)z(t,n[o])||e.addRange(n[o]);e.rangeCount||c(e)};oe.removeRange=J&&V?function(e){if(this.docSelection.type==B){for(var t=this.docSelection.createRange(),n=h(e),o=P(t.item(0)),r=H(o).createControlRange(),i=!1,a=0,s=t.length;a<s;++a)t.item(a)!==n||i?r.add(t.item(a)):i=!0;r.select(),p(this)}else ae(this,e)}:function(e){ae(this,e)};var se;!U&&K&&M.implementsDomRange?(se=a,oe.isBackward=function(){return se(this)}):se=oe.isBackward=function(){return!1},oe.isBackwards=oe.isBackward,oe.toString=function(){for(var e=[],t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")},oe.collapse=function(t,n){C(this,t);var o=e.createRange(t);o.collapseToPoint(t,n),this.setSingleRange(o),this.isCollapsed=!0},oe.collapseToStart=function(){if(!this.rangeCount)throw new L("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},oe.collapseToEnd=function(){if(!this.rangeCount)throw new L("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},oe.selectAllChildren=function(t){C(this,t);var n=e.createRange(t);n.selectNodeContents(t),this.setSingleRange(n)},oe.deleteFromDocument=function(){if(J&&V&&this.docSelection.type==B){for(var e,t=this.docSelection.createRange();t.length;)e=t.item(0),t.remove(e),e.parentNode.removeChild(e);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var o=0,r=n.length;o<r;++o)n[o].deleteContents();this.addRange(n[r-1])}}},oe.eachRange=function(e,t){for(var n=0,o=this._ranges.length;n<o;++n)if(e(this.getRangeAt(n)))return t},oe.getAllRanges=function(){var e=[];return this.eachRange(function(t){e.push(t)}),e},oe.setSingleRange=function(e,t){this.removeAllRanges(),this.addRange(e,t)},oe.callMethodOnEachRange=function(e,t){var n=[];return this.eachRange(function(o){n.push(o[e].apply(o,t))}),n},oe.setStart=x(!0),oe.setEnd=x(!1),e.rangePrototype.select=function(e){ne(this.getDocument()).setSingleRange(this,e)},oe.changeEachRange=function(e){var t=[],n=this.isBackward();this.eachRange(function(n){e(n),t.push(n)}),this.removeAllRanges(),n&&1==t.length?this.addRange(t[0],"backward"):this.setRanges(t)},oe.containsNode=function(e,t){return this.eachRange(function(n){return n.containsNode(e,t)},!0)||!1},oe.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},oe.moveToBookmark=function(t){for(var n,o,r=[],i=0;n=t.rangeBookmarks[i++];)(o=e.createRange(this.win)).moveToBookmark(n),r.push(o);t.backward?this.setSingleRange(r[0],"backward"):this.setRanges(r)},oe.toHtml=function(){var e=[];return this.eachRange(function(t){e.push(I.toHtml(t))}),e.join("")},M.implementsTextRange&&(oe.getNativeTextRange=function(){var n;if(n=this.docSelection){var o=n.createRange();if(f(o))return o;throw t.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return e.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw t.createError("getNativeTextRange: selection contains no range")}),oe.getName=function(){return"WrappedSelection"},oe.inspect=function(){return N(this)},oe.detach=function(){w(this.win,"delete"),v(this)},y.detachAll=function(){w(null,"deleteAll")},y.inspect=N,y.isDirectionBackward=n,e.Selection=y,e.selectionPrototype=oe,e.addShimListener(function(e){"undefined"==typeof e.getSelection&&(e.getSelection=function(){return ne(e)}),e=null})}),_;l("No document found")}else l("No window found")},this),
/**
 * Selection save and restore module for Rangy.
 * Saves and restores user selections using marker invisible elements in the DOM.
 *
 * Part of Rangy, a cross-browser JavaScript range and selection library
 * http://code.google.com/p/rangy/
 *
 * Depends on Rangy core.
 *
 * Copyright 2014, Tim Down
 * Licensed under the MIT license.
 * Version: 1.3alpha.20140804
 * Build date: 4 August 2014
 */
function(e,t){"function"==typeof define&&define.amd?define(["rangy"],e):e(t.rangy)}(function(e){e.createModule("SaveRestore",["WrappedRange"],function(e,t){function n(e,t){return(t||document).getElementById(e)}function o(e,t){var n,o="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),r=m.getDocument(e.startContainer),i=e.cloneRange();return i.collapse(t),(n=r.createElement("span")).id=o,n.style.lineHeight="0",n.style.display="none",n.className="rangySelectionBoundary",n.appendChild(r.createTextNode(p)),i.insertNode(n),n}function r(e,o,r,i){var a=n(r,e);a?(o[i?"setStartBefore":"setEndBefore"](a),a.parentNode.removeChild(a)):t.warn("Marker element has been removed. Cannot restore selection.")}function i(e,t){return t.compareBoundaryPoints(e.START_TO_START,e)}function a(t,n){var r,i=e.DomRange.getRangeDocument(t),a=t.toString();return t.collapsed?{document:i,markerId:(r=o(t,!1)).id,collapsed:!0}:(r=o(t,!1),{document:i,startMarkerId:o(t,!0).id,endMarkerId:r.id,collapsed:!1,backward:n,toString:function(){return"original text: '"+a+"', new text: '"+t.toString()+"'"}})}function s(o,i){var a=o.document;void 0===i&&(i=!0);var s=e.createRange(a);if(o.collapsed){var l=n(o.markerId,a);if(l){l.style.display="inline";var c=l.previousSibling;c&&3==c.nodeType?(l.parentNode.removeChild(l),s.collapseToPoint(c,c.length)):(s.collapseBefore(l),l.parentNode.removeChild(l))}else t.warn("Marker element has been removed. Cannot restore selection.")}else r(a,s,o.startMarkerId,!0),r(a,s,o.endMarkerId,!1);return i&&s.normalizeBoundaries(),s}function l(t,o){var r,s,l=[];(t=t.slice(0)).sort(i);for(var c=0,d=t.length;c<d;++c)l[c]=a(t[c],o);for(c=d-1;c>=0;--c)r=t[c],s=e.DomRange.getRangeDocument(r),r.collapsed?r.collapseAfter(n(l[c].markerId,s)):(r.setEndBefore(n(l[c].endMarkerId,s)),r.setStartAfter(n(l[c].startMarkerId,s)));return l}function c(n){if(!e.isSelectionValid(n))return t.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."),null;var o=e.getSelection(n),r=o.getAllRanges(),i=1==r.length&&o.isBackward(),a=l(r,i);return i?o.setSingleRange(r[0],"backward"):o.setRanges(r),{win:n,rangeInfos:a,restored:!1}}function d(e){for(var t=[],n=e.length-1;n>=0;n--)t[n]=s(e[n],!0);return t}function u(t,n){if(!t.restored){var o=t.rangeInfos,r=e.getSelection(t.win),i=d(o);1==o.length&&n&&e.features.selectionHasExtend&&o[0].backward?(r.removeAllRanges(),r.addRange(i[0],!0)):r.setRanges(i),t.restored=!0}}function h(e,t){var o=n(t,e);o&&o.parentNode.removeChild(o)}function f(e){for(var t,n=e.rangeInfos,o=0,r=n.length;o<r;++o)(t=n[o]).collapsed?h(e.doc,t.markerId):(h(e.doc,t.startMarkerId),h(e.doc,t.endMarkerId))}var m=e.dom,p="\ufeff";e.util.extend(e,{saveRange:a,restoreRange:s,saveRanges:l,restoreRanges:d,saveSelection:c,restoreSelection:u,removeMarkerElement:h,removeMarkers:f})})},this);
/*
	Base.js, version 1.1a
	Copyright 2006-2010, Dean Edwards
	License: http://www.opensource.org/licenses/mit-license.php
*/
var Base=function(){};Base.extend=function(e,t){var n=Base.prototype.extend;Base._prototyping=!0;var o=new this;n.call(o,e),o.base=function(){},delete Base._prototyping;var r=o.constructor,i=o.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor==i)this._constructing=!0,r.apply(this,arguments),delete this._constructing;else if(null!=arguments[0])return(arguments[0].extend||n).call(arguments[0],o)};return i.ancestor=this,i.extend=this.extend,i.forEach=this.forEach,i.implement=this.implement,i.prototype=o,i.toString=this.toString,i.valueOf=function(e){return"object"==e?i:r.valueOf()},n.call(i,t),"function"==typeof i.init&&i.init(),i},Base.prototype={extend:function(e,t){if(arguments.length>1){var n=this[e];if(n&&"function"==typeof t&&(!n.valueOf||n.valueOf()!=t.valueOf())&&/\bbase\b/.test(t)){var o=t.valueOf();(t=function(){var e=this.base||Base.prototype.base;this.base=n;var t=o.apply(this,arguments);return this.base=e,t}).valueOf=function(e){return"object"==e?t:o},t.toString=Base.toString}this[e]=t}else if(e){var r=Base.prototype.extend;Base._prototyping||"function"==typeof this||(r=this.extend||r);for(var i={toSource:null},a=["constructor","toString","valueOf"],s=Base._prototyping?0:1;l=a[s++];)e[l]!=i[l]&&r.call(this,l,e[l]);for(var l in e)i[l]||r.call(this,l,e[l])}return this}},Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(e,t,n){for(var o in e)this.prototype[o]===undefined&&t.call(n,e[o],o,e)},implement:function(){for(var e=0;e<arguments.length;e++)"function"==typeof arguments[e]?arguments[e](this.prototype):this.prototype.extend(arguments[e]);return this},toString:function(){return String(this.valueOf())}}),wysihtml5.browser=function(){function e(e){return+(/ipad|iphone|ipod/.test(e)&&e.match(/ os (\d+).+? like mac os x/)||[undefined,0])[1]}function t(e){return+(e.match(/android (\d+)/)||[undefined,0])[1]}function n(e,t){var n,o=-1;return"Microsoft Internet Explorer"==navigator.appName?n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"):"Netscape"==navigator.appName&&(n=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})")),n&&null!=n.exec(navigator.userAgent)&&(o=parseFloat(RegExp.$1)),-1!==o&&(!e||(t?"<"===t?e<o:">"===t?e>o:"<="===t?e<=o:">="===t?e>=o:void 0:e===o))}var o=navigator.userAgent,r=document.createElement("div"),i=-1!==o.indexOf("Gecko")&&-1===o.indexOf("KHTML"),a=-1!==o.indexOf("AppleWebKit/"),s=-1!==o.indexOf("Chrome/"),l=-1!==o.indexOf("Opera/");return{USER_AGENT:o,supported:function(){var n=this.USER_AGENT.toLowerCase(),o="contentEditable"in r,i=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,a=document.querySelector&&document.querySelectorAll,s=this.isIos()&&e(n)<5||this.isAndroid()&&t(n)<4||-1!==n.indexOf("opera mobi")||-1!==n.indexOf("hpwos/");return o&&i&&a&&!s},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){return/ipad|iphone|ipod/i.test(this.USER_AGENT)},isAndroid:function(){return-1!==this.USER_AGENT.indexOf("Android")},supportsSandboxedIframes:function(){return n()},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return!("querySelector"in document)},displaysCaretInEmptyContentEditableCorrectly:function(){return n()},hasCurrentStyleProperty:function(){return"currentStyle"in r},hasHistoryIssue:function(){return i&&"Mac"===navigator.platform.substr(0,3)},insertsLineBreaksOnReturn:function(){return i},supportsPlaceholderAttributeOn:function(e){return"placeholder"in e},supportsEvent:function(e){return"on"+e in r||(r.setAttribute("on"+e,"return;"),"function"==typeof r["on"+e])},supportsEventsInIframeCorrectly:function(){return!l},supportsHTML5Tags:function(e){var t=e.createElement("div"),n="<article>foo</article>";return t.innerHTML=n,t.innerHTML.toLowerCase()===n},supportsCommand:function(){var e={formatBlock:n(10,"<="),insertUnorderedList:n(),insertOrderedList:n()},t={insertHTML:i};return function(n,o){if(!e[o]){try{return n.queryCommandSupported(o)}catch(r){}try{return n.queryCommandEnabled(o)}catch(i){return!!t[o]}}return!1}}(),doesAutoLinkingInContentEditable:function(){return n()},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return i||l||a},supportsGetAttributeCorrectly:function(){return"1"!=document.createElement("td").getAttribute("rowspan")},canSelectImagesInContentEditable:function(){return i||n()||l},autoScrollsToCaret:function(){return!a},autoClosesUnclosedTags:function(){var e,t,n=r.cloneNode(!1);return n.innerHTML="<p><div></div>",t=n.innerHTML.toLowerCase(),e="<p></p><div></div>"===t||"<p><div></div></p>"===t,this.autoClosesUnclosedTags=function(){return e},e},supportsNativeGetElementsByClassName:function(){return-1!==String(document.getElementsByClassName).indexOf("[native code]")},supportsSelectionModify:function(){return"getSelection"in window&&"modify"in window.getSelection()},needsSpaceAfterLineBreak:function(){return l},supportsSpeechApiOn:function(e){return(o.match(/Chrome\/(\d+)/)||[undefined,0])[1]>=11&&("onwebkitspeechchange"in e||"speech"in e)},crashesWhenDefineProperty:function(e){return n(9)&&("XMLHttpRequest"===e||"XDomainRequest"===e)},doesAsyncFocus:function(){return n()},hasProblemsSettingCaretAfterImg:function(){return n()},hasUndoInContextMenu:function(){return i||s||l},hasInsertNodeIssue:function(){return l},hasIframeFocusIssue:function(){return n()},createsNestedInvalidMarkupAfterPaste:function(){return a},supportsMutationEvents:function(){return"MutationEvent"in window}}}(),wysihtml5.lang.array=function(e){return{contains:function(t){if(Array.isArray(t)){for(var n=t.length;n--;)if(-1!==wysihtml5.lang.array(e).indexOf(t[n]))return!0;return!1}return-1!==wysihtml5.lang.array(e).indexOf(t)},indexOf:function(t){if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1},without:function(t){t=wysihtml5.lang.array(t);for(var n=[],o=0,r=e.length;o<r;o++)t.contains(e[o])||n.push(e[o]);return n},get:function(){for(var t=0,n=e.length,o=[];t<n;t++)o.push(e[t]);return o},map:function(t,n){if(Array.prototype.map)return e.map(t,n);for(var o=e.length>>>0,r=new Array(o),i=0;i<o;i++)r[i]=t.call(n,e[i],i,e);return r},unique:function(){for(var t=[],n=e.length,o=0;o<n;)wysihtml5.lang.array(t).contains(e[o])||t.push(e[o]),o++;return t}}},wysihtml5.lang.Dispatcher=Base.extend({on:function(e,t){return this.events=this.events||{},this.events[e]=this.events[e]||[],this.events[e].push(t),this},off:function(e,t){this.events=this.events||{};var n,o,r=0;if(e){for(n=this.events[e]||[],o=[];r<n.length;r++)n[r]!==t&&t&&o.push(n[r]);this.events[e]=o}else this.events={};return this},fire:function(e,t){this.events=this.events||{};for(var n=this.events[e]||[],o=0;o<n.length;o++)n[o].call(this,t);return this},observe:function(){return this.on.apply(this,arguments)},stopObserving:function(){return this.off.apply(this,arguments)}}),wysihtml5.lang.object=function(e){return{merge:function(t){for(var n in t)e[n]=t[n];return this},get:function(){return e},clone:function(){var t,n={};for(t in e)n[t]=e[t];return n},isArray:function(){return"[object Array]"===Object.prototype.toString.call(e)}}},function(){var e=/^\s+/,t=/\s+$/,n=/[&<>"]/g,o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};wysihtml5.lang.string=function(r){return r=String(r),{trim:function(){return r.replace(e,"").replace(t,"")},interpolate:function(e){for(var t in e)r=this.replace("#{"+t+"}").by(e[t]);return r},replace:function(e){return{by:function(t){return r.split(e).join(t)}}},escapeHTML:function(){return r.replace(n,function(e){return o[e]})}}}}(),function(e){function t(e,t){return i(e,t)?e:(e===e.ownerDocument.documentElement&&(e=e.ownerDocument.body),a(e,t))}function n(e){return e.replace(l,function(e,t){var n=(t.match(c)||[])[1]||"",o=u[n];(t=t.replace(c,"")).split(o).length>t.split(n).length&&(t+=n,n="");var r=t,i=t;return t.length>d&&(i=i.substr(0,d)+"..."),"www."===r.substr(0,4)&&(r="http://"+r),'<a href="'+r+'">'+i+"</a>"+n})}function o(e){var t=e._wysihtml5_tempElement;return t||(t=e._wysihtml5_tempElement=e.createElement("div")),t}function r(t){var r=t.parentNode,i=e.lang.string(t.data).escapeHTML(),a=o(r.ownerDocument);for(a.innerHTML="<span></span>"+n(i),a.removeChild(a.firstChild);a.firstChild;)r.insertBefore(a.firstChild,t);r.removeChild(t)}function i(t,n){for(var o;t.parentNode;){if(o=(t=t.parentNode).nodeName,t.className&&e.lang.array(t.className.split(" ")).contains(n))return!0;if(s.contains(o))return!0;if("body"===o)return!1}return!1}function a(t,n){if(!(s.contains(t.nodeName)||t.className&&e.lang.array(t.className.split(" ")).contains(n))){if(t.nodeType!==e.TEXT_NODE||!t.data.match(l)){for(var o=e.lang.array(t.childNodes).get(),i=o.length,c=0;c<i;c++)a(o[c],n);return t}r(t)}}var s=e.lang.array(["CODE","PRE","A","SCRIPT","HEAD","TITLE","STYLE"]),l=/((https?:\/\/|www\.)[^\s<]{3,})/gi,c=/([^\w\/\-](,?))$/i,d=100,u={")":"(","]":"[","}":"{"};e.dom.autoLink=t,e.dom.autoLink.URL_REG_EXP=l}(wysihtml5),function(){var e=wysihtml5.dom;e.addClass=function(t,n){var o=t.classList;if(o)return o.add(n);e.hasClass(t,n)||(t.className+=" "+n)},e.removeClass=function(e,t){var n=e.classList;if(n)return n.remove(t);e.className=e.className.replace(new RegExp("(^|\\s+)"+t+"(\\s+|$)")," ")},e.hasClass=function(e,t){var n=e.classList;if(n)return n.contains(t);var o=e.className;return o.length>0&&(o==t||new RegExp("(^|\\s)"+t+"(\\s|$)").test(o))}}(),wysihtml5.dom.contains=function(){var e=document.documentElement;return e.contains?function(e,t){return t.nodeType!==wysihtml5.ELEMENT_NODE&&(t=t.parentNode),e!==t&&e.contains(t)}:e.compareDocumentPosition?function(e,t){return!!(16&e.compareDocumentPosition(t))}:void 0}(),wysihtml5.dom.convertToList=function(){function e(e,t){var n=e.createElement("li");return t.appendChild(n),n}function t(e,t){return e.createElement(t)}function n(n,o,r){if("UL"===n.nodeName||"OL"===n.nodeName||"MENU"===n.nodeName)return n;var i,a,s,l,c,d,u,h,f,m=n.ownerDocument,p=t(m,o),g=n.querySelectorAll("br"),y=g.length;for(f=0;f<y;f++)for(l=g[f];(c=l.parentNode)&&c!==n&&c.lastChild===l;){if("block"===wysihtml5.dom.getStyle("display").from(c)){c.removeChild(l);break}wysihtml5.dom.insert(l).after(l.parentNode)}for(a=(i=wysihtml5.lang.array(n.childNodes).get()).length,f=0;f<a;f++)h=h||e(m,p),s=i[f],d="block"===wysihtml5.dom.getStyle("display").from(s),u="BR"===s.nodeName,!d||r&&wysihtml5.dom.hasClass(s,r)?u?h=h.firstChild?null:h:h.appendChild(s):((h=h.firstChild?e(m,p):h).appendChild(s),h=null);return 0===i.length&&e(m,p),n.parentNode.replaceChild(p,n),p}return n}(),wysihtml5.dom.copyAttributes=function(e){return{from:function(t){return{to:function(n){for(var o,r=0,i=e.length;r<i;r++)o=e[r],"undefined"!=typeof t[o]&&""!==t[o]&&(n[o]=t[o]);return{andTo:arguments.callee}}}}}},function(e){var t=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"],n=function(t){return!!o(t)&&parseInt(e.getStyle("width").from(t),10)<t.offsetWidth},o=function(n){for(var o=0,r=t.length;o<r;o++)if("border-box"===e.getStyle(t[o]).from(n))return t[o]};e.copyStyles=function(o){return{from:function(r){n(r)&&(o=wysihtml5.lang.array(o).without(t));for(var i,a="",s=o.length,l=0;l<s;l++)i=o[l],a+=i+":"+e.getStyle(i).from(r)+";";return{to:function(t){return e.setStyles(a).on(t),{andTo:arguments.callee}}}}}}}(wysihtml5.dom),function(e){e.dom.delegate=function(t,n,o,r){return e.dom.observe(t,o,function(o){for(var i=o.target,a=e.lang.array(t.querySelectorAll(n));i&&i!==t;){if(a.contains(i)){r.call(i,o);break}i=i.parentNode}})}}(wysihtml5),function(e){e.dom.domNode=function(t){var n=[e.ELEMENT_NODE,e.TEXT_NODE],o=function(t){return t.nodeType===e.TEXT_NODE&&/^\s*$/g.test(t.data)};return{prev:function(r){var i=t.previousSibling,a=r&&r.nodeTypes?r.nodeTypes:n;return i?!e.lang.array(a).contains(i.nodeType)||r&&r.ignoreBlankTexts&&o(i)?e.dom.domNode(i).prev(r):i:null},next:function(r){var i=t.nextSibling,a=r&&r.nodeTypes?r.nodeTypes:n;return i?!e.lang.array(a).contains(i.nodeType)||r&&r.ignoreBlankTexts&&o(i)?e.dom.domNode(i).next(r):i:null}}}}(wysihtml5),wysihtml5.dom.getAsDom=function(){var e=function(e,t){var n=t.createElement("div");n.style.display="none",t.body.appendChild(n);try{n.innerHTML=e}catch(o){}return t.body.removeChild(n),n},t=function(e){if(!e._wysihtml5_supportsHTML5Tags){for(var t=0,o=n.length;t<o;t++)e.createElement(n[t]);e._wysihtml5_supportsHTML5Tags=!0}},n=["abbr","article","aside","audio","bdi","canvas","command","datalist","details","figcaption","figure","footer","header","hgroup","keygen","mark","meter","nav","output","progress","rp","rt","ruby","svg","section","source","summary","time","track","video","wbr"];return function(n,o){o=o||document;var r;return"object"==typeof n&&n.nodeType?(r=o.createElement("div")).appendChild(n):wysihtml5.browser.supportsHTML5Tags(o)?(r=o.createElement("div")).innerHTML=n:(t(o),r=e(n,o)),r}}(),wysihtml5.dom.getParentElement=function(){function e(e,t){return!t||!t.length||("string"==typeof t?e===t:wysihtml5.lang.array(t).contains(e))}function t(e){return e.nodeType===wysihtml5.ELEMENT_NODE}function n(e,t,n){var o=(e.className||"").match(n)||[];return t?o[o.length-1]===t:!!o.length}function o(e,t,n){var o=(e.getAttribute("style")||"").match(n)||[];return t?o[o.length-1]===t:!!o.length}return function(r,i,a,s){var l=i.cssStyle||i.styleRegExp,c=i.className||i.classRegExp;for(a=a||50;a--&&r&&"BODY"!==r.nodeName&&(!s||r!==s);){if(t(r)&&e(r.nodeName,i.nodeName)&&(!l||o(r,i.cssStyle,i.styleRegExp))&&(!c||n(r,i.className,i.classRegExp)))return r;r=r.parentNode}return null}}(),wysihtml5.dom.getStyle=function(){function e(e){return e.replace(n,function(e){return e.charAt(1).toUpperCase()})}var t={float:"styleFloat"in document.createElement("div").style?"styleFloat":"cssFloat"},n=/\-[a-z]/g;return function(n){return{from:function(o){if(o.nodeType===wysihtml5.ELEMENT_NODE){var r=o.ownerDocument,i=t[n]||e(n),a=o.style,s=o.currentStyle,l=a[i];if(l)return l;if(s)try{return s[i]}catch(f){}var c,d,u=r.defaultView||r.parentWindow,h=("height"===n||"width"===n)&&"TEXTAREA"===o.nodeName;return u.getComputedStyle?(h&&(c=a.overflow,a.overflow="hidden"),d=u.getComputedStyle(o,null).getPropertyValue(n),h&&(a.overflow=c||""),d):void 0}}}}}(),wysihtml5.dom.getTextNodes=function(e,t){var n=[];for(e=e.firstChild;e;e=e.nextSibling)3==e.nodeType?t&&/^\s*$/.test(e.innerText||e.textContent)||n.push(e):n=n.concat(wysihtml5.dom.getTextNodes(e,t));return n},wysihtml5.dom.hasElementWithTagName=function(){function e(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=n++)}var t={},n=1;return function(n,o){var r=e(n)+":"+o,i=t[r];return i||(i=t[r]=n.getElementsByTagName(o)),i.length>0}}(),function(e){function t(e){return e._wysihtml5_identifier||(e._wysihtml5_identifier=o++)}var n={},o=1;e.dom.hasElementWithClassName=function(o,r){if(!e.browser.supportsNativeGetElementsByClassName())return!!o.querySelector("."+r);var i=t(o)+":"+r,a=n[i];return a||(a=n[i]=o.getElementsByClassName(r)),a.length>0}}(wysihtml5),wysihtml5.dom.insert=function(e){return{after:function(t){t.parentNode.insertBefore(e,t.nextSibling)},before:function(t){t.parentNode.insertBefore(e,t)},into:function(t){t.appendChild(e)}}},wysihtml5.dom.insertCSS=function(e){return e=e.join("\n"),{into:function(t){var n=t.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(t.createTextNode(e));var o=t.querySelector("head link");if(o)o.parentNode.insertBefore(n,o);else{var r=t.querySelector("head");r&&r.appendChild(n)}}}},function(e){e.dom.lineBreaks=function(t){function n(e){return"BR"===e.nodeName}function o(t){return!!n(t)||"block"===e.dom.getStyle("display").from(t)}return{add:function(){var n=t.ownerDocument,r=e.dom.domNode(t).next({ignoreBlankTexts:!0}),i=e.dom.domNode(t).prev({ignoreBlankTexts:!0});r&&!o(r)&&e.dom.insert(n.createElement("br")).after(t),i&&!o(i)&&e.dom.insert(n.createElement("br")).before(t)},remove:function(){var o=e.dom.domNode(t).next({ignoreBlankTexts:!0}),r=e.dom.domNode(t).prev({ignoreBlankTexts:!0});o&&n(o)&&o.parentNode.removeChild(o),r&&n(r)&&r.parentNode.removeChild(r)}}}}(wysihtml5),wysihtml5.dom.observe=function(e,t,n){for(var o,r,i=0,a=(t="string"==typeof t?[t]:t).length;i<a;i++)r=t[i],e.addEventListener?e.addEventListener(r,n,!1):(o=function(t){"target"in t||(t.target=t.srcElement),t.preventDefault=t.preventDefault||function(){this.returnValue=!1},t.stopPropagation=t.stopPropagation||function(){this.cancelBubble=!0},n.call(e,t)},e.attachEvent("on"+r,o));return{stop:function(){for(var r,i=0,a=t.length;i<a;i++)r=t[i],e.removeEventListener?e.removeEventListener(r,n,!1):e.detachEvent("on"+r,o)}}},wysihtml5.dom.parse=function(){function e(e,n){wysihtml5.lang.object(p).merge(m).merge(n.rules).get();var o,r,i,a=n.context||e.ownerDocument||document,s=a.createDocumentFragment(),l="string"==typeof e,c=!1;for(!0===n.clearInternals&&(c=!0),n.uneditableClass&&(g=n.uneditableClass),o=l?wysihtml5.dom.getAsDom(e,a):e;o.firstChild;)(r=t(i=o.firstChild,n.cleanUp,c))&&s.appendChild(r),i!==r&&o.removeChild(i);return o.innerHTML="",o.appendChild(s),l?wysihtml5.quirks.getCorrectInnerHTML(o):o}function t(e,n,o){var r,i,a,s=e.nodeType,l=e.childNodes,c=l.length,d=u[s],f=0;if(g&&1===s&&wysihtml5.dom.hasClass(e,g))return e;if(!(i=d&&d(e,o))){if(!1===i){for(r=e.ownerDocument.createDocumentFragment(),f=c;f--;)l[f]&&(a=t(l[f],n,o))&&(l[f]===a&&f--,r.insertBefore(a,r.firstChild));return wysihtml5.lang.array(["div","pre","p","table","td","th","ul","ol","li","dd","dl","footer","header","section","h1","h2","h3","h4","h5","h6"]).contains(e.nodeName.toLowerCase())&&e.parentNode.lastChild!==e&&(e.nextSibling&&3===e.nextSibling.nodeType&&/^\s/.test(e.nextSibling.nodeValue)||r.appendChild(e.ownerDocument.createTextNode(" "))),r.normalize&&r.normalize(),r}return null}for(f=0;f<c;f++)l[f]&&(a=t(l[f],n,o))&&(l[f]===a&&f--,i.appendChild(a));if(n&&i.nodeName.toLowerCase()===h&&(!i.childNodes.length||/^\s*$/gi.test(i.innerHTML)&&(o||"_wysihtml5-temp-placeholder"!==e.className&&"rangySelectionBoundary"!==e.className)||!i.attributes.length)){for(r=i.ownerDocument.createDocumentFragment();i.firstChild;)r.appendChild(i.firstChild);return r.normalize&&r.normalize(),r}return i.normalize&&i.normalize(),i}function n(e,t){var n,r,s=p.tags,l=e.nodeName.toLowerCase(),c=e.scopeName;if(e._wysihtml5)return null;if(e._wysihtml5=1,"wysihtml5-temp"===e.className)return null;if(c&&"HTML"!=c&&(l=c+":"+l),"outerHTML"in e&&(wysihtml5.browser.autoClosesUnclosedTags()||"P"!==e.nodeName||"</p>"===e.outerHTML.slice(-4).toLowerCase()||(l="div")),l in s){if(!(n=s[l])||n.remove)return null;if(n.unwrap)return!1;n="string"==typeof n?{rename_tag:n}:n}else{if(!e.firstChild)return null;n={rename_tag:h}}return a(e,r=e.ownerDocument.createElement(n.rename_tag||l),n,t),i(e,r,n),n.one_of_type&&!o(e,p,n.one_of_type,t)?(!n.remove_action||"unwrap"!=n.remove_action)&&null:(e=null,r.normalize&&r.normalize(),r)}function o(e,t,n,o){var i;if("SPAN"===e.nodeName&&!o&&("_wysihtml5-temp-placeholder"===e.className||"rangySelectionBoundary"===e.className))return!0;for(i in n)if(n.hasOwnProperty(i)&&t.type_definitions&&t.type_definitions[i]&&r(e,t.type_definitions[i]))return!0;return!1}function r(e,t){var n,o,r,i,a,l=e.getAttribute("class"),c=e.getAttribute("style");if(t.methods)for(var d in t.methods)if(t.methods.hasOwnProperty(d)&&x[d]&&x[d](e))return!0;if(l&&t.classes){n=(l=l.replace(/^\s+/g,"").replace(/\s+$/g,"").split(f)).length;for(var u=0;u<n;u++)if(t.classes[l[u]])return!0}if(c&&t.styles){c=c.split(";");for(o in t.styles)if(t.styles.hasOwnProperty(o))for(var h=c.length;h--;)if((a=c[h].split(":"))[0].replace(/\s/g,"").toLowerCase()===o&&(!0===t.styles[o]||1===t.styles[o]||wysihtml5.lang.array(t.styles[o]).contains(a[1].replace(/\s/g,"").toLowerCase())))return!0}if(t.attrs)for(r in t.attrs)if(t.attrs.hasOwnProperty(r)&&"string"==typeof(i=s(e,r))&&i.search(t.attrs[r])>-1)return!0;return!1}function i(e,t,n){var o;if(n&&n.keep_styles)for(o in n.keep_styles)n.keep_styles.hasOwnProperty(o)&&("float"==o?(e.style.styleFloat&&(t.style.styleFloat=e.style.styleFloat),e.style.cssFloat&&(t.style.cssFloat=e.style.cssFloat)):e.style[o]&&(t.style[o]=e.style[o]))}function a(e,t,n,o){var r,i,a,l,c,d,u,h={},m=n.set_class,g=n.add_class,y=n.add_style,v=n.set_attributes,x=n.check_attributes,N=p.classes,E=0,S=[],T=[],R=[],_=[];if(v&&(h=wysihtml5.lang.object(v).clone()),x)for(l in x)(d=w[x[l]])&&((u=s(e,l))||"alt"===l&&"IMG"==e.nodeName)&&"string"==typeof(c=d(u))&&(h[l]=c);if(m&&S.push(m),g)for(l in g)(d=C[g[l]])&&"string"==typeof(a=d(s(e,l)))&&S.push(a);if(y)for(l in y)(d=b[y[l]])&&(newStyle=d(s(e,l)),"string"==typeof newStyle&&T.push(newStyle));if("string"==typeof N&&"any"===N&&e.getAttribute("class"))h["class"]=e.getAttribute("class");else{for(o||(N["_wysihtml5-temp-placeholder"]=1,N._rangySelectionBoundary=1,N["wysiwyg-tmp-selected-cell"]=1),(_=e.getAttribute("class"))&&(S=S.concat(_.split(f))),r=S.length;E<r;E++)N[i=S[E]]&&R.push(i);R.length&&(h["class"]=wysihtml5.lang.array(R).unique().join(" "))}h["class"]&&o&&(h["class"]=h["class"].replace("wysiwyg-tmp-selected-cell",""),/^\s*$/g.test(h["class"])&&delete h["class"]),T.length&&(h.style=wysihtml5.lang.array(T).unique().join(" "));for(l in h)try{t.setAttribute(l,h[l])}catch(A){}h.src&&("undefined"!=typeof h.width&&t.setAttribute("width",h.width),"undefined"!=typeof h.height&&t.setAttribute("height",h.height))}function s(e,t){t=t.toLowerCase();if("IMG"==e.nodeName&&"src"==t&&!0===l(e))return e.src;if(y&&"outerHTML"in e){return-1!=e.outerHTML.toLowerCase().indexOf(" "+t+"=")?e.getAttribute(t):null}return e.getAttribute(t)}function l(e){try{return e.complete&&!e.mozMatchesSelector(":-moz-broken")}catch(t){if(e.complete&&"complete"===e.readyState)return!0}}function c(e){var t=e.nextSibling;if(!t||t.nodeType!==wysihtml5.TEXT_NODE){var n=e.data.replace(v,"");return e.ownerDocument.createTextNode(n)}t.data=e.data.replace(v,"")+t.data.replace(v,"")}function d(e){if(p.comments)return e.ownerDocument.createComment(e.nodeValue)}var u={1:n,3:c,8:d},h="span",f=/\s+/,m={tags:{},classes:{}},p={},g=!1,y=!wysihtml5.browser.supportsGetAttributeCorrectly(),v=/\uFEFF/g,w={url:function(){var e=/^https?:\/\//i;return function(t){return t&&t.match(e)?t.replace(e,function(e){return e.toLowerCase()}):null}}(),src:function(){var e=/^(\/|https?:\/\/)/i;return function(t){return t&&t.match(e)?t.replace(e,function(e){return e.toLowerCase()}):null}}(),href:function(){var e=/^(#|\/|https?:\/\/|mailto:)/i;return function(t){return t&&t.match(e)?t.replace(e,function(e){return e.toLowerCase()}):null}}(),alt:function(){var e=/[^ a-z0-9_\-]/gi;return function(t){return t?t.replace(e,""):""}}(),numbers:function(){var e=/\D/g;return function(t){return(t=(t||"").replace(e,""))||null}}(),any:function(e){return e}},b={align_text:function(){var e={left:"text-align: left;",right:"text-align: right;",center:"text-align: center;"};return function(t){return e[String(t).toLowerCase()]}}()},C={align_img:function(){var e={left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(t){return e[String(t).toLowerCase()]}}(),align_text:function(){var e={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(t){return e[String(t).toLowerCase()]}}(),clear_br:function(){var e={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(t){return e[String(t).toLowerCase()]}}(),size_font:function(){var e={1:"wysiwyg-font-size-xx-small",2:"wysiwyg-font-size-small",3:"wysiwyg-font-size-medium",4:"wysiwyg-font-size-large",5:"wysiwyg-font-size-x-large",6:"wysiwyg-font-size-xx-large",7:"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(t){return e[String(t).charAt(0)]}}()},x={has_visible_contet:function(){var e,t=["img","video","picture","br","script","noscript","style","table","iframe","object","embed","audio","svg","input","button","select","textarea","canvas"];return function(n){if((e=(n.innerText||n.textContent).replace(/\s/g,""))&&e.length>0)return!0;for(var o=t.length;o--;)if(n.querySelector(t[o]))return!0;return!!(n.offsetWidth&&n.offsetWidth>0&&n.offsetHeight&&n.offsetHeight>0)}}()};return e}(),wysihtml5.dom.removeEmptyTextNodes=function(e){for(var t,n=wysihtml5.lang.array(e.childNodes).get(),o=n.length,r=0;r<o;r++)(t=n[r]).nodeType===wysihtml5.TEXT_NODE&&""===t.data&&t.parentNode.removeChild(t)},wysihtml5.dom.renameElement=function(e,t){for(var n,o=e.ownerDocument.createElement(t);n=e.firstChild;)o.appendChild(n);return wysihtml5.dom.copyAttributes(["align","className"]).from(e).to(o),e.parentNode.replaceChild(o,e),o},wysihtml5.dom.replaceWithChildNodes=function(e){if(e.parentNode)if(e.firstChild){for(var t=e.ownerDocument.createDocumentFragment();e.firstChild;)t.appendChild(e.firstChild);e.parentNode.replaceChild(t,e),e=t=null}else e.parentNode.removeChild(e)},function(e){function t(t){return"block"===e.getStyle("display").from(t)}function n(e){return"BR"===e.nodeName}function o(e){var t=e.ownerDocument.createElement("br");e.appendChild(t)}function r(e,r){if(e.nodeName.match(/^(MENU|UL|OL)$/)){var i,a,s,l,c,d=e.ownerDocument,u=d.createDocumentFragment(),h=wysihtml5.dom.domNode(e).prev({ignoreBlankTexts:!0});if(r)for(!h||t(h)||n(h)||o(u);c=e.firstElementChild||e.firstChild;){for(a=c.lastChild;i=c.firstChild;)s=i===a&&!t(i)&&!n(i),u.appendChild(i),s&&o(u);c.parentNode.removeChild(c)}else for(;c=e.firstElementChild||e.firstChild;){if(c.querySelector&&c.querySelector("div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6"))for(;i=c.firstChild;)u.appendChild(i);else{for(l=d.createElement("p");i=c.firstChild;)l.appendChild(i);u.appendChild(l)}c.parentNode.removeChild(c)}e.parentNode.replaceChild(u,e)}}e.resolveList=r}(wysihtml5.dom),function(e){var t=document,n=["parent","top","opener","frameElement","frames","localStorage","globalStorage","sessionStorage","indexedDB"],o=["open","close","openDialog","showModalDialog","alert","confirm","prompt","openDatabase","postMessage","XMLHttpRequest","XDomainRequest"],r=["referrer","write","open","close"];e.dom.Sandbox=Base.extend({constructor:function(t,n){this.callback=t||e.EMPTY_FUNCTION,this.config=e.lang.object({}).merge(n).get(),this.editableArea=this._createIframe()},insertInto:function(e){"string"==typeof e&&(e=t.getElementById(e)),e.appendChild(this.editableArea)},getIframe:function(){return this.editableArea},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var e=this.getIframe();e.parentNode.removeChild(e)},_readyError:function(){throw new Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet")},_createIframe:function(){var n=this,o=t.createElement("iframe");return o.className="wysihtml5-sandbox",e.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(o),e.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()&&(o.src="javascript:'<html></html>'"),o.onload=function(){o.onreadystatechange=o.onload=null,n._onLoadIframe(o)},o.onreadystatechange=function(){/loaded|complete/.test(o.readyState)&&(o.onreadystatechange=o.onload=null,n._onLoadIframe(o))},o},_onLoadIframe:function(i){if(e.dom.contains(t.documentElement,i)){var a=this,s=i.contentWindow,l=i.contentWindow.document,c=t.characterSet||t.charset||"utf-8",d=this._getHtml({charset:c,stylesheets:this.config.stylesheets});if(l.open("text/html","replace"),l.write(d),l.close(),this.getWindow=function(){return i.contentWindow},this.getDocument=function(){return i.contentWindow.document},s.onerror=function(e,t,n){throw new Error("wysihtml5.Sandbox: "+e,t,n)},!e.browser.supportsSandboxedIframes()){var u,h;for(u=0,h=n.length;u<h;u++)this._unset(s,n[u]);for(u=0,h=o.length;u<h;u++)this._unset(s,o[u],e.EMPTY_FUNCTION);for(u=0,h=r.length;u<h;u++)this._unset(l,r[u]);this._unset(l,"cookie","",!0)}this.loaded=!0,setTimeout(function(){a.callback(a)},0)}},_getHtml:function(t){var n,o=t.stylesheets,r="",i=0;if(o="string"==typeof o?[o]:o)for(n=o.length;i<n;i++)r+='<link rel="stylesheet" href="'+o[i]+'">';return t.stylesheets=r,e.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(t)},_unset:function(t,n,o,r){try{t[n]=o}catch(a){}try{t.__defineGetter__(n,function(){return o})}catch(a){}if(r)try{t.__defineSetter__(n,function(){})}catch(a){}if(!e.browser.crashesWhenDefineProperty(n))try{var i={get:function(){return o}};r&&(i.set=function(){}),Object.defineProperty(t,n,i)}catch(a){}}})}(wysihtml5),function(e){var t=document;e.dom.ContentEditableArea=Base.extend({getContentEditable:function(){return this.element},getWindow:function(){return this.element.ownerDocument.defaultView},getDocument:function(){return this.element.ownerDocument},constructor:function(t,n,o){this.callback=t||e.EMPTY_FUNCTION,this.config=e.lang.object({}).merge(n).get(),this.element=o?this._bindElement(o):this._createElement()},_createElement:function(){var e=t.createElement("div");return e.className="wysihtml5-sandbox",this._loadElement(e),e},_bindElement:function(e){return e.className=e.className&&""!=e.className?e.className+" wysihtml5-sandbox":"wysihtml5-sandbox",this._loadElement(e,!0),e},_loadElement:function(e,t){var n=this;if(!t){var o=this._getHtml();e.innerHTML=o}this.getWindow=function(){return e.ownerDocument.defaultView},this.getDocument=function(){return e.ownerDocument},this.loaded=!0,setTimeout(function(){n.callback(n)},0)},_getHtml:function(){return""}})}(wysihtml5),function(){var e={className:"class"};wysihtml5.dom.setAttributes=function(t){return{on:function(n){for(var o in t)n.setAttribute(e[o]||o,t[o])}}}}(),wysihtml5.dom.setStyles=function(e){return{on:function(t){var n=t.style;if("string"!=typeof e)for(var o in e)"float"===o?(n.cssFloat=e[o],n.styleFloat=e[o]):n[o]=e[o];else n.cssText+=";"+e}}},function(e){e.simulatePlaceholder=function(t,n,o){var r="placeholder",i=function(){var t=n.element.offsetWidth>0&&n.element.offsetHeight>0;n.hasPlaceholderSet()&&(n.clear(),n.element.focus(),t&&setTimeout(function(){var e=n.selection.getSelection();e.focusNode&&e.anchorNode||n.selection.selectNode(n.element.firstChild||n.element)},0)),n.placeholderSet=!1,e.removeClass(n.element,r)},a=function(){n.isEmpty()&&(n.placeholderSet=!0,n.setValue(o),e.addClass(n.element,r))};t.on("set_placeholder",a).on("unset_placeholder",i).on("focus:composer",i).on("paste:composer",i).on("blur:composer",a),a()}}(wysihtml5.dom),function(e){var t=document.documentElement;"textContent"in t?(e.setTextContent=function(e,t){e.textContent=t},e.getTextContent=function(e){return e.textContent}):"innerText"in t?(e.setTextContent=function(e,t){e.innerText=t},e.getTextContent=function(e){return e.innerText}):(e.setTextContent=function(e,t){e.nodeValue=t},e.getTextContent=function(e){return e.nodeValue})}(wysihtml5.dom),wysihtml5.dom.getAttribute=function(e,t){var n=!wysihtml5.browser.supportsGetAttributeCorrectly();t=t.toLowerCase();if("IMG"==e.nodeName&&"src"==t&&!0===_isLoadedImage(e))return e.src;if(n&&"outerHTML"in e){return-1!=e.outerHTML.toLowerCase().indexOf(" "+t+"=")?e.getAttribute(t):null}return e.getAttribute(t)},function(e){function t(e,t){for(var n,o=[],r=0,i=e.length;r<i;r++)if(n=e[r].querySelectorAll(t))for(var a=n.length;a--;o.unshift(n[a]));return o}function n(e){e.parentNode.removeChild(e)}function o(e,t){e.parentNode.insertBefore(t,e.nextSibling)}function r(e,t){for(var n=e.nextSibling;1!=n.nodeType;)if(n=n.nextSibling,!t||t==n.tagName.toLowerCase())return n;return null}var i=e.dom,a=function(e){this.el=e,this.isColspan=!1,this.isRowspan=!1,this.firstCol=!0,this.lastCol=!0,this.firstRow=!0,this.lastRow=!0,this.isReal=!0,this.spanCollection=[],this.modified=!1},s=function(e,t){e?(this.cell=e,this.table=i.getParentElement(e,{nodeName:["TABLE"]})):t&&(this.table=t,this.cell=this.table.querySelectorAll("th, td")[0])};s.prototype={addSpannedCellToMap:function(e,t,n,o,r,i){for(var s=[],l=n+(i?parseInt(i,10)-1:0),c=o+(r?parseInt(r,10)-1:0),d=n;d<=l;d++){"undefined"==typeof t[d]&&(t[d]=[]);for(var u=o;u<=c;u++)t[d][u]=new a(e),t[d][u].isColspan=r&&parseInt(r,10)>1,t[d][u].isRowspan=i&&parseInt(i,10)>1,t[d][u].firstCol=u==o,t[d][u].lastCol=u==c,t[d][u].firstRow=d==n,t[d][u].lastRow=d==l,t[d][u].isReal=u==o&&d==n,t[d][u].spanCollection=s,s.push(t[d][u])}},setCellAsModified:function(e){if(e.modified=!0,e.spanCollection.length>0)for(var t=0,n=e.spanCollection.length;t<n;t++)e.spanCollection[t].modified=!0},setTableMap:function(){var e,t,n,o,r,s,l,c,d=[],u=this.getTableRows()
;for(e=0;e<u.length;e++)for(t=u[e],n=this.getRowCells(t),s=0,"undefined"==typeof d[e]&&(d[e]=[]),o=0;o<n.length;o++){for(r=n[o];"undefined"!=typeof d[e][s];)s++;l=i.getAttribute(r,"colspan"),c=i.getAttribute(r,"rowspan"),l||c?(this.addSpannedCellToMap(r,d,e,s,l,c),s+=l?parseInt(l,10):1):(d[e][s]=new a(r),s++)}return this.map=d,d},getRowCells:function(n){var o=this.table.querySelectorAll("table"),r=o?t(o,"th, td"):[],i=n.querySelectorAll("th, td");return r.length>0?e.lang.array(i).without(r):i},getTableRows:function(){var n=this.table.querySelectorAll("table"),o=n?t(n,"tr"):[],r=this.table.querySelectorAll("tr");return o.length>0?e.lang.array(r).without(o):r},getMapIndex:function(e){for(var t=this.map.length,n=this.map&&this.map[0]?this.map[0].length:0,o=0;o<t;o++)for(var r=0;r<n;r++)if(this.map[o][r].el===e)return{row:o,col:r};return!1},getElementAtIndex:function(e){return this.setTableMap(),this.map[e.row]&&this.map[e.row][e.col]&&this.map[e.row][e.col].el?this.map[e.row][e.col].el:null},getMapElsTo:function(e){var t=[];if(this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(e),this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col){var n=this.idx_start;this.idx_start=this.idx_end,this.idx_end=n}if(this.idx_start.col>this.idx_end.col){var o=this.idx_start.col;this.idx_start.col=this.idx_end.col,this.idx_end.col=o}if(null!=this.idx_start&&null!=this.idx_end)for(var r=this.idx_start.row,i=this.idx_end.row;r<=i;r++)for(var a=this.idx_start.col,s=this.idx_end.col;a<=s;a++)t.push(this.map[r][a].el);return t},orderSelectionEnds:function(e){if(this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(e),this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col){var t=this.idx_start;this.idx_start=this.idx_end,this.idx_end=t}if(this.idx_start.col>this.idx_end.col){var n=this.idx_start.col;this.idx_start.col=this.idx_end.col,this.idx_end.col=n}return{start:this.map[this.idx_start.row][this.idx_start.col].el,end:this.map[this.idx_end.row][this.idx_end.col].el}},createCells:function(e,t,n){for(var o,r=this.table.ownerDocument,i=r.createDocumentFragment(),a=0;a<t;a++){if(o=r.createElement(e),n)for(var s in n)n.hasOwnProperty(s)&&o.setAttribute(s,n[s]);o.appendChild(document.createTextNode("\xa0")),i.appendChild(o)}return i},correctColIndexForUnreals:function(e,t){for(var n=this.map[t],o=-1,r=0;r<e;r++)n[r].isReal&&o++;return o},getLastNewCellOnRow:function(e,t){for(var n,o,r=this.getRowCells(e),i=0,a=r.length;i<a;i++)if(n=r[i],!1===(o=this.getMapIndex(n))||void 0!==t&&o.row!=t)return n;return null},removeEmptyTable:function(){var e=this.table.querySelectorAll("td, th");return(!e||0==e.length)&&(n(this.table),!0)},splitRowToCells:function(e){if(e.isColspan){var t=parseInt(i.getAttribute(e.el,"colspan")||1,10),n=e.el.tagName.toLowerCase();if(t>1){var r=this.createCells(n,t-1);o(e.el,r)}e.el.removeAttribute("colspan")}},getRealRowEl:function(e,t){var n=null,o=null;t=t||this.idx;for(var r=0,a=this.map[t.row].length;r<a;r++)if((o=this.map[t.row][r]).isReal&&(n=i.getParentElement(o.el,{nodeName:["TR"]})))return n;return null===n&&e&&(n=i.getParentElement(this.map[t.row][t.col].el,{nodeName:["TR"]})||null),n},injectRowAt:function(e,t,n,r,a){var s=this.getRealRowEl(!1,{row:e,col:t}),l=this.createCells(r,n);if(s){var c=this.correctColIndexForUnreals(t,e);c>=0?o(this.getRowCells(s)[c],l):s.insertBefore(l,s.firstChild)}else{var d=this.table.ownerDocument.createElement("tr");d.appendChild(l),o(i.getParentElement(a.el,{nodeName:["TR"]}),d)}},canMerge:function(e){if(this.to=e,this.setTableMap(),this.idx_start=this.getMapIndex(this.cell),this.idx_end=this.getMapIndex(this.to),this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col){var t=this.idx_start;this.idx_start=this.idx_end,this.idx_end=t}if(this.idx_start.col>this.idx_end.col){var n=this.idx_start.col;this.idx_start.col=this.idx_end.col,this.idx_end.col=n}for(var o=this.idx_start.row,r=this.idx_end.row;o<=r;o++)for(var i=this.idx_start.col,a=this.idx_end.col;i<=a;i++)if(this.map[o][i].isColspan||this.map[o][i].isRowspan)return!1;return!0},decreaseCellSpan:function(e,t){var n=parseInt(i.getAttribute(e.el,t),10)-1;n>=1?e.el.setAttribute(t,n):(e.el.removeAttribute(t),"colspan"==t&&(e.isColspan=!1),"rowspan"==t&&(e.isRowspan=!1),e.firstCol=!0,e.lastCol=!0,e.firstRow=!0,e.lastRow=!0,e.isReal=!0)},removeSurplusLines:function(){var e,t,o,r,a,s,l;if(this.setTableMap(),this.map){for(o=0,r=this.map.length;o<r;o++){for(l=!0,a=0,s=(e=this.map[o]).length;a<s;a++)if(t=e[a],!(i.getAttribute(t.el,"rowspan")&&parseInt(i.getAttribute(t.el,"rowspan"),10)>1&&!0!==t.firstRow)){l=!1;break}if(l)for(a=0;a<s;a++)this.decreaseCellSpan(e[a],"rowspan")}var c=this.getTableRows();for(o=0,r=c.length;o<r;o++)0==(e=c[o]).childNodes.length&&/^\s*$/.test(e.textContent||e.innerText)&&n(e)}},fillMissingCells:function(){var e=0,t=0,n=null;if(this.setTableMap(),this.map){e=this.map.length;for(var r=0;r<e;r++)this.map[r].length>t&&(t=this.map[r].length);for(var i=0;i<e;i++)for(var s=0;s<t;s++)this.map[i]&&!this.map[i][s]&&s>0&&(this.map[i][s]=new a(this.createCells("td",1)),(n=this.map[i][s-1])&&n.el&&n.el.parent&&o(this.map[i][s-1].el,this.map[i][s].el))}},rectify:function(){return!this.removeEmptyTable()&&(this.removeSurplusLines(),this.fillMissingCells(),!0)},unmerge:function(){if(this.rectify()&&(this.setTableMap(),this.idx=this.getMapIndex(this.cell),this.idx)){var e=this.map[this.idx.row][this.idx.col],t=i.getAttribute(e.el,"colspan")?parseInt(i.getAttribute(e.el,"colspan"),10):1,n=e.el.tagName.toLowerCase();if(e.isRowspan){var o=parseInt(i.getAttribute(e.el,"rowspan"),10);if(o>1)for(var r=1,a=o-1;r<=a;r++)this.injectRowAt(this.idx.row+r,this.idx.col,t,n,e);e.el.removeAttribute("rowspan")}this.splitRowToCells(e)}},merge:function(e){if(this.rectify())if(this.canMerge(e)){for(var t=this.idx_end.row-this.idx_start.row+1,o=this.idx_end.col-this.idx_start.col+1,r=this.idx_start.row,i=this.idx_end.row;r<=i;r++)for(var a=this.idx_start.col,s=this.idx_end.col;a<=s;a++)r==this.idx_start.row&&a==this.idx_start.col?(t>1&&this.map[r][a].el.setAttribute("rowspan",t),o>1&&this.map[r][a].el.setAttribute("colspan",o)):(/^\s*<br\/?>\s*$/.test(this.map[r][a].el.innerHTML.toLowerCase())||(this.map[this.idx_start.row][this.idx_start.col].el.innerHTML+=" "+this.map[r][a].el.innerHTML),n(this.map[r][a].el));this.rectify()}else window.console&&console.log("Do not know how to merge allready merged cells.")},collapseCellToNextRow:function(e){var t=this.getMapIndex(e.el),n=t.row+1,r={row:n,col:t.col};if(n<this.map.length){var a=this.getRealRowEl(!1,r);if(null!==a){var s=this.correctColIndexForUnreals(r.col,r.row);if(s>=0)o(this.getRowCells(a)[s],e.el);else{var l=this.getLastNewCellOnRow(a,n);null!==l?o(l,e.el):a.insertBefore(e.el,a.firstChild)}parseInt(i.getAttribute(e.el,"rowspan"),10)>2?e.el.setAttribute("rowspan",parseInt(i.getAttribute(e.el,"rowspan"),10)-1):e.el.removeAttribute("rowspan")}}},removeRowCell:function(e){e.isReal?e.isRowspan?this.collapseCellToNextRow(e):n(e.el):parseInt(i.getAttribute(e.el,"rowspan"),10)>2?e.el.setAttribute("rowspan",parseInt(i.getAttribute(e.el,"rowspan"),10)-1):e.el.removeAttribute("rowspan")},getRowElementsByCell:function(){var e=[];if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(var t=this.map[this.idx.row],n=0,o=t.length;n<o;n++)t[n].isReal&&e.push(t[n].el);return e},getColumnElementsByCell:function(){var e=[];if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(var t=0,n=this.map.length;t<n;t++)this.map[t][this.idx.col]&&this.map[t][this.idx.col].isReal&&e.push(this.map[t][this.idx.col].el);return e},removeRow:function(){var e=i.getParentElement(this.cell,{nodeName:["TR"]});if(e){if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(var t=this.map[this.idx.row],o=0,r=t.length;o<r;o++)t[o].modified||(this.setCellAsModified(t[o]),this.removeRowCell(t[o]));n(e)}},removeColCell:function(e){e.isColspan?parseInt(i.getAttribute(e.el,"colspan"),10)>2?e.el.setAttribute("colspan",parseInt(i.getAttribute(e.el,"colspan"),10)-1):e.el.removeAttribute("colspan"):e.isReal&&n(e.el)},removeColumn:function(){if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),!1!==this.idx)for(var e=0,t=this.map.length;e<t;e++)this.map[e][this.idx.col].modified||(this.setCellAsModified(this.map[e][this.idx.col]),this.removeColCell(this.map[e][this.idx.col]))},remove:function(e){if(this.rectify()){switch(e){case"row":this.removeRow();break;case"column":this.removeColumn()}this.rectify()}},addRow:function(e){var t=this.table.ownerDocument;if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),"below"==e&&i.getAttribute(this.cell,"rowspan")&&(this.idx.row=this.idx.row+parseInt(i.getAttribute(this.cell,"rowspan"),10)-1),!1!==this.idx){for(var n=this.map[this.idx.row],r=t.createElement("tr"),a=0,s=n.length;a<s;a++)n[a].modified||(this.setCellAsModified(n[a]),this.addRowCell(n[a],r,e));switch(e){case"below":o(this.getRealRowEl(!0),r);break;case"above":var l=i.getParentElement(this.map[this.idx.row][this.idx.col].el,{nodeName:["TR"]});l&&l.parentNode.insertBefore(r,l)}}},addRowCell:function(e,t,n){var o=e.isColspan?{colspan:i.getAttribute(e.el,"colspan")}:null;e.isReal?"above"!=n&&e.isRowspan?e.el.setAttribute("rowspan",parseInt(i.getAttribute(e.el,"rowspan"),10)+1):t.appendChild(this.createCells("td",1,o)):"above"!=n&&e.isRowspan&&e.lastRow?t.appendChild(this.createCells("td",1,o)):c.isRowspan&&e.el.attr("rowspan",parseInt(i.getAttribute(e.el,"rowspan"),10)+1)},add:function(e){this.rectify()&&("below"!=e&&"above"!=e||this.addRow(e),"before"!=e&&"after"!=e||this.addColumn(e))},addColCell:function(e,t,n){var r,a=e.el.tagName.toLowerCase();switch(n){case"before":r=!e.isColspan||e.firstCol;break;case"after":r=!e.isColspan||e.lastCol||e.isColspan&&c.el==this.cell}if(r){switch(n){case"before":e.el.parentNode.insertBefore(this.createCells(a,1),e.el);break;case"after":o(e.el,this.createCells(a,1))}e.isRowspan&&this.handleCellAddWithRowspan(e,t+1,n)}else e.el.setAttribute("colspan",parseInt(i.getAttribute(e.el,"colspan"),10)+1)},addColumn:function(e){var t,n;if(this.setTableMap(),this.idx=this.getMapIndex(this.cell),"after"==e&&i.getAttribute(this.cell,"colspan")&&(this.idx.col=this.idx.col+parseInt(i.getAttribute(this.cell,"colspan"),10)-1),!1!==this.idx)for(var o=0,r=this.map.length;o<r;o++)(t=this.map[o])[this.idx.col]&&((n=t[this.idx.col]).modified||(this.setCellAsModified(n),this.addColCell(n,o,e)))},handleCellAddWithRowspan:function(e,t,n){for(var a,s,l,c=parseInt(i.getAttribute(this.cell,"rowspan"),10)-1,d=i.getParentElement(e.el,{nodeName:["TR"]}),u=e.el.tagName.toLowerCase(),h=this.table.ownerDocument,f=0;f<c;f++)if(a=this.correctColIndexForUnreals(this.idx.col,t+f),d=r(d,"tr"))if(a>0)switch(n){case"before":s=this.getRowCells(d),a>0&&this.map[t+f][this.idx.col].el!=s[a]&&a==s.length-1?o(s[a],this.createCells(u,1)):s[a].parentNode.insertBefore(this.createCells(u,1),s[a]);break;case"after":o(this.getRowCells(d)[a],this.createCells(u,1))}else d.insertBefore(this.createCells(u,1),d.firstChild);else(l=h.createElement("tr")).appendChild(this.createCells(u,1)),this.table.appendChild(l)}},i.table={getCellsBetween:function(e,t){return new s(e).getMapElsTo(t)},addCells:function(e,t){new s(e).add(t)},removeCells:function(e,t){new s(e).remove(t)},mergeCellsBetween:function(e,t){new s(e).merge(t)},unmergeCell:function(e){new s(e).unmerge()},orderSelectionEnds:function(e,t){return new s(e).orderSelectionEnds(t)},indexOf:function(e){var t=new s(e);return t.setTableMap(),t.getMapIndex(e)},findCell:function(e,t){return new s(null,e).getElementAtIndex(t)},findRowByCell:function(e){return new s(e).getRowElementsByCell()},findColumnByCell:function(e){return new s(e).getColumnElementsByCell()},canMerge:function(e,t){return new s(e).canMerge(t)}}}(wysihtml5),wysihtml5.dom.query=function(e,t){var n,o=[];e.nodeType&&(e=[e]);for(var r=0,i=e.length;r<i;r++)if(n=e[r].querySelectorAll(t))for(var a=n.length;a--;o.unshift(n[a]));return o},wysihtml5.dom.compareDocumentPosition=document.documentElement.compareDocumentPosition?function(e,t){return e.compareDocumentPosition(t)}:function(e,t){var n,o;if(n=9===e.nodeType?e:e.ownerDocument,o=9===t.nodeType?t:t.ownerDocument,e===t)return 0;if(e===t.ownerDocument)return 20;if(e.ownerDocument===t)return 10;if(n!==o)return 1;if(2===e.nodeType&&e.childNodes&&-1!==wysihtml5.lang.array(e.childNodes).indexOf(t))return 20;if(2===t.nodeType&&t.childNodes&&-1!==wysihtml5.lang.array(t.childNodes).indexOf(e))return 10;for(var r=e,i=[],a=null;r;){if(r==t)return 10;i.push(r),r=r.parentNode}for(r=t,a=null;r;){if(r==e)return 20;var s=wysihtml5.lang.array(i).indexOf(r);if(-1!==s){var l=i[s];return wysihtml5.lang.array(l.childNodes).indexOf(i[s-1])>wysihtml5.lang.array(l.childNodes).indexOf(a)?2:4}a=r,r=r.parentNode}return 1},wysihtml5.dom.unwrap=function(e){if(e.parentNode){for(;e.lastChild;)wysihtml5.dom.insert(e.lastChild).after(e);e.parentNode.removeChild(e)}},wysihtml5.quirks.cleanPastedHTML=function(){function e(e,n,o){n=n||t,o=o||e.ownerDocument||document;var r,i,a,s,l,c,d="string"==typeof e,u=0;r=d?wysihtml5.dom.getAsDom(e,o):e;for(l in n)for(a=r.querySelectorAll(l),i=n[l],s=a.length;u<s;u++)i(a[u]);var h=wysihtml5.dom.getTextNodes(r);for(c=h.length;c--;)h[c].nodeValue=h[c].nodeValue.replace(/([\S\u00A0])\u00A0/gi,"$1 ");return a=e=n=null,d?r.innerHTML:r}var t={"a u":wysihtml5.dom.replaceWithChildNodes};return e}(),wysihtml5.quirks.ensureProperClearing=function(){var e=function(){var e=this;setTimeout(function(){var t=e.innerHTML.toLowerCase();"<p>&nbsp;</p>"!=t&&"<p>&nbsp;</p><p>&nbsp;</p>"!=t||(e.innerHTML="")},0)};return function(t){wysihtml5.dom.observe(t.element,["cut","keydown"],e)}}(),function(e){var t="%7E";e.quirks.getCorrectInnerHTML=function(n){var o=n.innerHTML;if(-1===o.indexOf(t))return o;var r,i,a,s,l=n.querySelectorAll("[href*='~'], [src*='~']");for(s=0,a=l.length;s<a;s++)r=l[s].href||l[s].src,i=e.lang.string(r).replace("~").by(t),o=e.lang.string(o).replace(i).by(r);return o}}(wysihtml5),function(e){var t="wysihtml5-quirks-redraw";e.quirks.redraw=function(n){e.dom.addClass(n,t),e.dom.removeClass(n,t);try{var o=n.ownerDocument;o.execCommand("italic",!1,null),o.execCommand("italic",!1,null)}catch(r){}}}(wysihtml5),wysihtml5.quirks.tableCellsSelection=function(e,t){function n(){return d.observe(e,"mousedown",function(e){var t=wysihtml5.dom.getParentElement(e.target,{nodeName:["TD","TH"]});t&&o(t)}),u}function o(n){u.start=n,u.end=n,u.cells=[n],u.table=d.getParentElement(u.start,{nodeName:["TABLE"]}),u.table&&(r(),d.addClass(n,h),f=d.observe(e,"mousemove",a),m=d.observe(e,"mouseup",s),t.fire("tableselectstart").fire("tableselectstart:composer"))}function r(){if(e){var t=e.querySelectorAll("."+h);if(t.length>0)for(var n=0;n<t.length;n++)d.removeClass(t[n],h)}}function i(e){for(var t=0;t<e.length;t++)d.addClass(e[t],h)}function a(e){var n,o=null,a=d.getParentElement(e.target,{nodeName:["TD","TH"]});a&&u.table&&u.start&&(o=d.getParentElement(a,{nodeName:["TABLE"]}))&&o===u.table&&(r(),n=u.end,u.end=a,u.cells=d.table.getCellsBetween(u.start,a),u.cells.length>1&&t.composer.selection.deselect(),i(u.cells),u.end!==n&&t.fire("tableselectchange").fire("tableselectchange:composer"))}function s(){f.stop(),m.stop(),t.fire("tableselect").fire("tableselect:composer"),setTimeout(function(){l()},0)}function l(){var n=d.observe(e.ownerDocument,"click",function(e){n.stop(),d.getParentElement(e.target,{nodeName:["TABLE"]})!=u.table&&(r(),u.table=null,u.start=null,u.end=null,t.fire("tableunselect").fire("tableunselect:composer"))})}function c(e,n){u.start=e,u.end=n,u.table=d.getParentElement(u.start,{nodeName:["TABLE"]}),selectedCells=d.table.getCellsBetween(u.start,u.end),i(selectedCells),l(),t.fire("tableselect").fire("tableselect:composer")}var d=wysihtml5.dom,u={table:null,start:null,end:null,cells:null,select:c},h="wysiwyg-tmp-selected-cell",f=null,m=null;return n()},function(e){var t=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]+)\s*\)/i,n=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/i,o=/^#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])/i,r=/^#([0-9a-f])([0-9a-f])([0-9a-f])/i,i=function(e){return new RegExp("(^|\\s|;)"+e+"\\s*:\\s*[^;$]+","gi")};e.quirks.styleParser={parseColor:function(a,s){var l,c,d=i(s),u=a.match(d),h=10;if(u){for(var f=u.length;f--;)u[f]=e.lang.string(u[f].split(":")[1]).trim();if(l=u[u.length-1],t.test(l))c=l.match(t);else if(n.test(l))c=l.match(n);else if(o.test(l))c=l.match(o),h=16;else if(r.test(l))return(c=l.match(r)).shift(),c.push(1),e.lang.array(c).map(function(e,t){return t<3?16*parseInt(e,16)+parseInt(e,16):parseFloat(e)});if(c)return c.shift(),c[3]||c.push(1),e.lang.array(c).map(function(e,t){return t<3?parseInt(e,h):parseFloat(e)})}return!1},unparseColor:function(e,t){if(t){if("hex"==t)return e[0].toString(16).toUpperCase()+e[1].toString(16).toUpperCase()+e[2].toString(16).toUpperCase();if("hash"==t)return"#"+e[0].toString(16).toUpperCase()+e[1].toString(16).toUpperCase()+e[2].toString(16).toUpperCase();if("rgb"==t)return"rgb("+e[0]+","+e[1]+","+e[2]+")";if("rgba"==t)return"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")";if("csv"==t)return e[0]+","+e[1]+","+e[2]+","+e[3]}return e[3]&&1!==e[3]?"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")":"rgb("+e[0]+","+e[1]+","+e[2]+")"},parseFontSize:function(t){var n=t.match(i("font-size"));return!!n&&e.lang.string(n[n.length-1].split(":")[1]).trim()}}}(wysihtml5),function(e){function t(e){var t=0;if(e.parentNode)do{t+=e.offsetTop||0,e=e.offsetParent}while(e);return t}function n(e,t){for(var n=0;t!==e;)if(n++,!(t=t.parentNode))throw new Error("not a descendant of ancestor!");return n}function o(e){if(!e.canSurroundContents())for(var t=e.commonAncestorContainer,o=n(t,e.startContainer),r=n(t,e.endContainer);!e.canSurroundContents();)o>r?(e.setStartBefore(e.startContainer),o=n(t,e.startContainer)):(e.setEndAfter(e.endContainer),r=n(t,e.endContainer))}var r=e.dom;e.Selection=Base.extend({constructor:function(e,t,n){window.rangy.init(),this.editor=e,this.composer=e.composer,this.doc=this.composer.doc,this.contain=t,this.unselectableClass=n||!1},getBookmark:function(){var e=this.getRange();return e&&o(e),e&&e.cloneRange()},setBookmark:function(e){e&&this.setSelection(e)},setBefore:function(e){var t=rangy.createRange(this.doc);return t.setStartBefore(e),t.setEndBefore(e),this.setSelection(t)},setAfter:function(e){var t=rangy.createRange(this.doc);return t.setStartAfter(e),t.setEndAfter(e),this.setSelection(t)},selectNode:function(t,n){var o=rangy.createRange(this.doc),i=t.nodeType===e.ELEMENT_NODE,a="canHaveHTML"in t?t.canHaveHTML:"IMG"!==t.nodeName,s=i?t.innerHTML:t.data,l=""===s||s===e.INVISIBLE_SPACE,c=r.getStyle("display").from(t),d="block"===c||"list-item"===c;if(l&&i&&a&&!n)try{t.innerHTML=e.INVISIBLE_SPACE}catch(u){}a?o.selectNodeContents(t):o.selectNode(t),a&&l&&i?o.collapse(d):a&&l&&(o.setStartAfter(t),o.setEndAfter(t)),this.setSelection(o)},getSelectedNode:function(e){var t,n;return e&&this.doc.selection&&"Control"===this.doc.selection.type&&(n=this.doc.selection.createRange())&&n.length?n.item(0):(t=this.getSelection(this.doc)).focusNode===t.anchorNode?t.focusNode:(n=this.getRange(this.doc))?n.commonAncestorContainer:this.doc.body},fixSelBorders:function(){var e=this.getRange();o(e),this.setSelection(e)},getSelectedOwnNodes:function(){for(var e=this.getOwnRanges(),t=[],n=0,o=e.length;n<o;n++)t.push(e[n].commonAncestorContainer||this.doc.body);return t},findNodesInSelection:function(t){for(var n,o=this.getOwnRanges(),r=[],i=0,a=o.length;i<a;i++)n=o[i].getNodes([1],function(n){return e.lang.array(t).contains(n.nodeName)}),r=r.concat(n);return r},containsUneditable:function(){for(var e=this.getOwnUneditables(),t=this.getSelection(),n=0,o=e.length;n<o;n++)if(t.containsNode(e[n]))return!0;return!1},deleteContents:function(){for(var e=this.getOwnRanges(),t=e.length;t--;)e[t].deleteContents();this.setSelection(e[0])},getPreviousNode:function(t,n){if(!t){t=this.getSelection().anchorNode}if(t===this.contain)return!1;var o,r=t.previousSibling;return r!==this.contain&&(r&&3!==r.nodeType&&1!==r.nodeType?r=this.getPreviousNode(r,n):r&&3===r.nodeType&&/^\s*$/.test(r.textContent)?r=this.getPreviousNode(r,n):n&&r&&1===r.nodeType&&!e.lang.array(["BR","HR","IMG"]).contains(r.nodeName)&&/^[\s]*$/.test(r.innerHTML)?r=this.getPreviousNode(r,n):r||t===this.contain||(o=t.parentNode)!==this.contain&&(r=this.getPreviousNode(o,n)),r!==this.contain&&r)},getSelectionParentsByTag:function(){for(var t,n=this.getSelectedOwnNodes(),o=[],r=0,i=n.length;r<i;r++)(t=n[r].nodeName&&"LI"===n[r].nodeName?n[r]:e.dom.getParentElement(n[r],{nodeName:["LI"]},!1,this.contain))&&o.push(t);return o.length?o:null},getRangeToNodeEnd:function(){if(this.isCollapsed()){var e=this.getRange(),t=e.startContainer,n=e.startOffset,o=rangy.createRange(this.doc);return o.selectNodeContents(t),o.setStart(t,n),o}},caretIsLastInSelection:function(){rangy.createRange(this.doc),this.getSelection();var e=this.getRangeToNodeEnd().cloneContents().textContent;return/^\s*$/.test(e)},caretIsFirstInSelection:function(){var t=rangy.createRange(this.doc),n=this.getSelection(),o=this.getRange(),r=o.startContainer;return r.nodeType===e.TEXT_NODE?this.isCollapsed()&&r.nodeType===e.TEXT_NODE&&/^\s*$/.test(r.data.substr(0,o.startOffset)):(t.selectNodeContents(this.getRange().commonAncestorContainer),t.collapse(!0),this.isCollapsed()&&(t.startContainer===n.anchorNode||t.endContainer===n.anchorNode)&&t.startOffset===n.anchorOffset)},caretIsInTheBeginnig:function(t){var n=this.getSelection(),o=n.anchorNode,r=n.anchorOffset;return t?0===r&&(o.nodeName&&o.nodeName===t.toUpperCase()||e.dom.getParentElement(o.parentNode,{nodeName:t},1)):0===r&&!this.getPreviousNode(o,!0)},caretIsBeforeUneditable:function(){var e=this.getSelection(),t=e.anchorNode;if(0===e.anchorOffset){var n=this.getPreviousNode(t,!0);if(n)for(var o=this.getOwnUneditables(),r=0,i=o.length;r<i;r++)if(n===o[r])return o[r]}return!1},executeAndRestoreRangy:function(e){var t=this.doc.defaultView||this.doc.parentWindow,n=rangy.saveSelection(t);if(n)try{e()}catch(o){setTimeout(function(){throw o},0)}else e();rangy.restoreSelection(n)},executeAndRestore:function(t,n){var o,i,a,s,l,c,d,u,h=this.doc.body,f=n&&h.scrollTop,m=n&&h.scrollLeft,p="_wysihtml5-temp-placeholder",g='<span class="'+p+'">'+e.INVISIBLE_SPACE+"</span>",y=this.getRange(!0);if(y){y.collapsed||(c=(d=y.cloneRange()).createContextualFragment(g),d.collapse(!1),d.insertNode(c),d.detach()),l=y.createContextualFragment(g),y.insertNode(l),c&&(o=this.contain.querySelectorAll("."+p),y.setStartBefore(o[0]),y.setEndAfter(o[o.length-1])),this.setSelection(y);try{t(y.startContainer,y.endContainer)}catch(w){setTimeout(function(){throw w},0)}if((o=this.contain.querySelectorAll("."+p))&&o.length){u=rangy.createRange(this.doc),a=o[0].nextSibling,o.length>1&&(s=o[o.length-1].previousSibling),s&&a?(u.setStartBefore(a),u.setEndAfter(s)):(i=this.doc.createTextNode(e.INVISIBLE_SPACE),r.insert(i).after(o[0]),u.setStartBefore(i),u.setEndAfter(i)),this.setSelection(u);for(var v=o.length;v--;)o[v].parentNode.removeChild(o[v])}else this.contain.focus();n&&(h.scrollTop=f,h.scrollLeft=m);try{o.parentNode.removeChild(o)}catch(b){}}else t(h,h)},set:function(e,t){var n=rangy.createRange(this.doc);n.setStart(e,t||0),this.setSelection(n)},insertHTML:function(e){var t=rangy.createRange(this.doc).createContextualFragment(e),n=t.lastChild;this.insertNode(t),n&&this.setAfter(n)},insertNode:function(e){var t=this.getRange();t&&t.insertNode(e)},surround:function(e){var t,n=this.getOwnRanges(),o=[];if(0==n.length)return o;for(var r=n.length;r--;){t=this.doc.createElement(e.nodeName),o.push(t),e.className&&(t.className=e.className),e.cssStyle&&t.setAttribute("style",e.cssStyle);try{n[r].surroundContents(t),this.selectNode(t)}catch(i){t.appendChild(n[r].extractContents()),n[r].insertNode(t)}}return o},deblockAndSurround:function(t){var n,o,r,i=this.doc.createElement("div"),a=rangy.createRange(this.doc);if(i.className=t.className,this.composer.commands.exec("formatBlock",t.nodeName,t.className),(n=this.contain.querySelectorAll("."+t.className))[0])for(n[0].parentNode.insertBefore(i,n[0]),a.setStartBefore(n[0]),a.setEndAfter(n[n.length-1]),o=a.extractContents();o.firstChild;)if(1==(r=o.firstChild).nodeType&&e.dom.hasClass(r,t.className)){for(;r.firstChild;)i.appendChild(r.firstChild);"BR"!==r.nodeName&&i.appendChild(this.doc.createElement("br")),o.removeChild(r)}else i.appendChild(r);else i=null;return i},scrollIntoView:function(){var n,o=this.doc,r=5,i=o.documentElement.scrollHeight>o.documentElement.offsetHeight,a=o._wysihtml5ScrollIntoViewElement=o._wysihtml5ScrollIntoViewElement||function(){var t=o.createElement("span");return t.innerHTML=e.INVISIBLE_SPACE,t}();i&&(this.insertNode(a),n=t(a),a.parentNode.removeChild(a),n>=o.body.scrollTop+o.documentElement.offsetHeight-r&&(o.body.scrollTop=n))},selectLine:function(){e.browser.supportsSelectionModify()?this._selectLine_W3C():this.doc.selection&&this._selectLine_MSIE()},_selectLine_W3C:function(){var e=this.doc.defaultView.getSelection();e.modify("move","left","lineboundary"),e.modify("extend","right","lineboundary")},_selectLine_MSIE:function(){var e,t,n,o,r,i=this.doc.selection.createRange(),a=i.boundingTop,s=this.doc.body.scrollWidth;if(i.moveToPoint){for(0===a&&(n=this.doc.createElement("span"),this.insertNode(n),a=n.offsetTop,n.parentNode.removeChild(n)),a+=1,o=-10;o<s;o+=2)try{i.moveToPoint(o,a);break}catch(l){}for(e=a,t=this.doc.selection.createRange(),r=s;r>=0;r--)try{t.moveToPoint(r,e);break}catch(c){}i.setEndPoint("EndToEnd",t),i.select()}},getText:function(){var e=this.getSelection();return e?e.toString():""},getNodes:function(e,t){var n=this.getRange();return n?n.getNodes([e],t):[]},fixRangeOverflow:function(e){if(this.contain&&this.contain.firstChild&&e){var t=e.compareNode(this.contain);if(2!==t)1===t&&e.setStartBefore(this.contain.firstChild),0===t&&e.setEndAfter(this.contain.lastChild),3===t&&(e.setStartBefore(this.contain.firstChild),e.setEndAfter(this.contain.lastChild));else if(this._detectInlineRangeProblems(e)){var n=e.endContainer.previousElementSibling;n&&e.setEnd(n,this._endOffsetForNode(n))}}},_endOffsetForNode:function(e){var t=document.createRange();return t.selectNodeContents(e),t.endOffset},_detectInlineRangeProblems:function(e){var t=r.compareDocumentPosition(e.startContainer,e.endContainer);return 0==e.endOffset&&4&t},getRange:function(e){var t=this.getSelection(),n=t&&t.rangeCount&&t.getRangeAt(0);return!0!==e&&this.fixRangeOverflow(n),n},getOwnUneditables:function(){var t=r.query(this.contain,"."+this.unselectableClass),n=r.query(t,"."+this.unselectableClass);return e.lang.array(t).without(n)},getOwnRanges:function(){var e,t=[],n=this.getRange();if(n&&t.push(n),this.unselectableClass&&this.contain&&n){var o,r=this.getOwnUneditables();if(r.length>0)for(var i=0,a=r.length;i<a;i++){e=[];for(var s=0,l=t.length;s<l;s++){if(t[s])switch(t[s].compareNode(r[i])){case 2:break;case 3:(o=t[s].cloneRange()).setEndBefore(r[i]),e.push(o),(o=t[s].cloneRange()).setStartAfter(r[i]),e.push(o);break;default:e.push(t[s])}t=e}}}return t},getSelection:function(){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow)},setSelection:function(e){var t=this.doc.defaultView||this.doc.parentWindow;return rangy.getSelection(t).setSingleRange(e)},createRange:function(){return rangy.createRange(this.doc)},isCollapsed:function(){return this.getSelection().isCollapsed},isEndToEndInNode:function(t){var n=this.getRange(),o=n.commonAncestorContainer,r=n.startContainer,i=n.endContainer;if(o.nodeType===e.TEXT_NODE&&(o=o.parentNode),r.nodeType===e.TEXT_NODE&&!/^\s*$/.test(r.data.substr(n.startOffset)))return!1;if(i.nodeType===e.TEXT_NODE&&!/^\s*$/.test(i.data.substr(n.endOffset)))return!1;for(;r&&r!==o;){if(r.nodeType!==e.TEXT_NODE&&!e.dom.contains(o,r))return!1;if(e.dom.domNode(r).prev({ignoreBlankTexts:!0}))return!1;r=r.parentNode}for(;i&&i!==o;){if(i.nodeType!==e.TEXT_NODE&&!e.dom.contains(o,i))return!1;if(e.dom.domNode(i).next({ignoreBlankTexts:!0}))return!1;i=i.parentNode}return!!e.lang.array(t).contains(o.nodeName)&&o},deselect:function(){var e=this.getSelection();e&&e.removeAllRanges()}})}(wysihtml5),function(e,t){function n(e,t,n){if(!e.className)return!1;var o=e.className.match(n)||[];return o[o.length-1]===t}function o(e,t){if(!e.getAttribute||!e.getAttribute("style"))return!1;e.getAttribute("style").match(t);return!!e.getAttribute("style").match(t)}function r(e,t,n){e.getAttribute("style")?(s(e,n),e.getAttribute("style")&&!/^\s*$/.test(e.getAttribute("style"))?e.setAttribute("style",t+";"+e.getAttribute("style")):e.setAttribute("style",t)):e.setAttribute("style",t)}function i(e,t,n){e.className?(a(e,n),e.className+=" "+t):e.className=t}function a(e,t){e.className&&(e.className=e.className.replace(t,""))}function s(e,t){var n,o=[];if(e.getAttribute("style")){for(var r=(n=e.getAttribute("style").split(";")).length;r--;)n[r].match(t)||/^\s*$/.test(n[r])||o.push(n[r]);o.length?e.setAttribute("style",o.join(";")):e.removeAttribute("style")}}function l(e,t){var n=[],o=t.split(";"),r=e.getAttribute("style");if(r){r=r.replace(/\s/gi,"").toLowerCase(),n.push(new RegExp("(^|\\s|;)"+t.replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"));for(var i=o.length;i-- >0;)/^\s*$/.test(o[i])||n.push(new RegExp("(^|\\s|;)"+o[i].replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"));for(var a=0,s=n.length;a<s;a++)if(r.match(n[a]))return n[a]}return!1}function c(n,o,r,i){return r?l(n,r):i?e.dom.hasClass(n,i):t.dom.arrayContains(o,n.tagName.toLowerCase())}function d(e,t,n,o){for(var r=e.length;r--;)if(!c(e[r],t,n,o))return!1;return!!e.length}function u(e,t,n){var o=l(e,t);return o?(s(e,o),"remove"):(r(e,t,n),"change")}function h(e,t){return e.className.replace(b," ")==t.className.replace(b," ")}function f(e){for(var t=e.parentNode;e.firstChild;)t.insertBefore(e.firstChild,e);t.removeChild(e)}function m(e,t){if(e.attributes.length!=t.attributes.length)return!1;for(var n,o,r,i=0,a=e.attributes.length;i<a;++i)if("class"!=(r=(n=e.attributes[i]).name)){if(o=t.attributes.getNamedItem(r),n.specified!=o.specified)return!1;if(n.specified&&n.nodeValue!==o.nodeValue)return!1}return!0}function p(e,n){return t.dom.isCharacterDataNode(e)?0==n?!!e.previousSibling:n!=e.length||!!e.nextSibling:n>0&&n<e.childNodes.length}function g(e,n,o,r){var i;if(t.dom.isCharacterDataNode(n)&&(0==o?(o=t.dom.getNodeIndex(n),n=n.parentNode):o==n.length?(o=t.dom.getNodeIndex(n)+1,n=n.parentNode):i=t.dom.splitDataNode(n,o)),!(i||r&&n===r)){(i=n.cloneNode(!1)).id&&i.removeAttribute("id");for(var a;a=n.childNodes[o];)i.appendChild(a);t.dom.insertAfter(i,n)}return n==e?i:g(e,i.parentNode,t.dom.getNodeIndex(i),r)}function y(t){this.isElementMerge=t.nodeType==e.ELEMENT_NODE,this.firstTextNode=this.isElementMerge?t.lastChild:t,this.textNodes=[this.firstTextNode]}function v(e,t,n,o,r,i,a){this.tagNames=e||[w],this.cssClass=t||!1!==t&&"",this.similarClassRegExp=n,this.cssStyle=r||"",this.similarStyleRegExp=i,this.normalize=o,this.applyToAnyTagName=!1,this.container=a}var w="span",b=/\s+/g;y.prototype={doMerge:function(){for(var e,t,n,o=[],r=0,i=this.textNodes.length;r<i;++r)t=(e=this.textNodes[r]).parentNode,o[r]=e.data,r&&(t.removeChild(e),t.hasChildNodes()||t.parentNode.removeChild(t));return this.firstTextNode.data=n=o.join(""),n},getLength:function(){for(var e=this.textNodes.length,t=0;e--;)t+=this.textNodes[e].length;return t},toString:function(){for(var e=[],t=0,n=this.textNodes.length;t<n;++t)e[t]="'"+this.textNodes[t].data+"'";return"[Merge("+e.join(",")+")]"}},v.prototype={getAncestorWithClass:function(o){for(var r;o;){if(r=this.cssClass?n(o,this.cssClass,this.similarClassRegExp):""===this.cssStyle,o.nodeType==e.ELEMENT_NODE&&"false"!=o.getAttribute("contenteditable")&&t.dom.arrayContains(this.tagNames,o.tagName.toLowerCase())&&r)return o;o=o.parentNode}return!1},getAncestorWithStyle:function(n){for(var r;n;){if(r=!!this.cssStyle&&o(n,this.similarStyleRegExp),n.nodeType==e.ELEMENT_NODE&&"false"!=n.getAttribute("contenteditable")&&t.dom.arrayContains(this.tagNames,n.tagName.toLowerCase())&&r)return n;n=n.parentNode}return!1},getMatchingAncestor:function(e){var t=this.getAncestorWithClass(e),n=!1
;return t?this.cssStyle&&(n="class"):(t=this.getAncestorWithStyle(e))&&(n="style"),{element:t,type:n}},postApply:function(e,t){for(var n,o,r,i=e[0],a=e[e.length-1],s=[],l=i,c=a,d=0,u=a.length,h=0,f=e.length;h<f;++h)r=null,(o=e[h])&&o.parentNode&&(r=this.getAdjacentMergeableTextNode(o.parentNode,!1)),r?(n||(n=new y(r),s.push(n)),n.textNodes.push(o),o===i&&(d=(l=n.firstTextNode).length),o===a&&(c=n.firstTextNode,u=n.getLength())):n=null;if(a&&a.parentNode){var m=this.getAdjacentMergeableTextNode(a.parentNode,!0);m&&(n||(n=new y(a),s.push(n)),n.textNodes.push(m))}if(s.length){for(h=0,f=s.length;h<f;++h)s[h].doMerge();t.setStart(l,d),t.setEnd(c,u)}},getAdjacentMergeableTextNode:function(t,n){var o,r=t.nodeType==e.TEXT_NODE,i=r?t.parentNode:t,a=n?"nextSibling":"previousSibling";if(r){if((o=t[a])&&o.nodeType==e.TEXT_NODE)return o}else if((o=i[a])&&this.areElementsMergeable(t,o))return o[n?"firstChild":"lastChild"];return null},areElementsMergeable:function(e,n){return t.dom.arrayContains(this.tagNames,(e.tagName||"").toLowerCase())&&t.dom.arrayContains(this.tagNames,(n.tagName||"").toLowerCase())&&h(e,n)&&m(e,n)},createContainer:function(e){var t=e.createElement(this.tagNames[0]);return this.cssClass&&(t.className=this.cssClass),this.cssStyle&&t.setAttribute("style",this.cssStyle),t},applyToTextNode:function(e){var n=e.parentNode;if(1==n.childNodes.length&&t.dom.arrayContains(this.tagNames,n.tagName.toLowerCase()))this.cssClass&&i(n,this.cssClass,this.similarClassRegExp),this.cssStyle&&r(n,this.cssStyle,this.similarStyleRegExp);else{var o=this.createContainer(t.dom.getDocument(e));e.parentNode.insertBefore(o,e),o.appendChild(e)}},isRemovable:function(n){return t.dom.arrayContains(this.tagNames,n.tagName.toLowerCase())&&""===e.lang.string(n.className).trim()&&(!n.getAttribute("style")||""===e.lang.string(n.getAttribute("style")).trim())},undoToTextNode:function(e,t,n,o){var r=!n,i=n||o,s=!1;if(!t.containsNode(i)){var l=t.cloneRange();l.selectNode(i),l.isPointInRange(t.endContainer,t.endOffset)&&p(t.endContainer,t.endOffset)&&(g(i,t.endContainer,t.endOffset,this.container),t.setEndAfter(i)),l.isPointInRange(t.startContainer,t.startOffset)&&p(t.startContainer,t.startOffset)&&(i=g(i,t.startContainer,t.startOffset,this.container))}!r&&this.similarClassRegExp&&a(i,this.similarClassRegExp),r&&this.similarStyleRegExp&&(s="change"===u(i,this.cssStyle,this.similarStyleRegExp)),this.isRemovable(i)&&!s&&f(i)},applyToRange:function(t){for(var n,o=t.length;o--;){if(!(n=t[o].getNodes([e.TEXT_NODE])).length)try{var r=this.createContainer(t[o].endContainer.ownerDocument);return t[o].surroundContents(r),void this.selectNode(t[o],r)}catch(l){}if(t[o].splitBoundaries(),(n=t[o].getNodes([e.TEXT_NODE])).length){for(var i,a=0,s=n.length;a<s;++a)i=n[a],this.getMatchingAncestor(i).element||this.applyToTextNode(i);t[o].setStart(n[0],0),i=n[n.length-1],t[o].setEnd(i,i.length),this.normalize&&this.postApply(n,t[o])}}},undoToRange:function(t){for(var n,o,r,i=t.length;i--;){if((n=t[i].getNodes([e.TEXT_NODE])).length)t[i].splitBoundaries(),n=t[i].getNodes([e.TEXT_NODE]);else{var a=t[i].endContainer.ownerDocument.createTextNode(e.INVISIBLE_SPACE);t[i].insertNode(a),t[i].selectNode(a),n=[a]}for(var s=0,l=n.length;s<l;++s)t[i].isValid()&&(o=n[s],"style"===(r=this.getMatchingAncestor(o)).type?this.undoToTextNode(o,t[i],!1,r.element):r.element&&this.undoToTextNode(o,t[i],r.element));1==l?this.selectNode(t[i],n[0]):(t[i].setStart(n[0],0),o=n[n.length-1],t[i].setEnd(o,o.length),this.normalize&&this.postApply(n,t[i]))}},selectNode:function(t,n){var o=n.nodeType===e.ELEMENT_NODE,r=!("canHaveHTML"in n)||n.canHaveHTML,i=o?n.innerHTML:n.data,a=""===i||i===e.INVISIBLE_SPACE;if(a&&o&&r)try{n.innerHTML=e.INVISIBLE_SPACE}catch(s){}t.selectNodeContents(n),a&&o?t.collapse(!1):a&&(t.setStartAfter(n),t.setEndAfter(n))},getTextSelectedByRange:function(e,t){var n=t.cloneRange();n.selectNodeContents(e);var o=n.intersection(t),r=o?o.toString():"";return n.detach(),r},isAppliedToRange:function(t){for(var n,o,r=[],i="full",a=t.length;a--;){if(!(o=t[a].getNodes([e.TEXT_NODE])).length)return!!(n=this.getMatchingAncestor(t[a].startContainer).element)&&{elements:[n],coverage:i};for(var s,l=0,c=o.length;l<c;++l)s=this.getTextSelectedByRange(o[l],t[a]),(n=this.getMatchingAncestor(o[l]).element)&&""!=s?(r.push(n),1===e.dom.getTextNodes(n,!0).length?i="full":"full"===i&&(i="inline")):n||(i="partial")}return!!r.length&&{elements:r,coverage:i}},toggleRange:function(e){var t,n=this.isAppliedToRange(e);n?"full"===n.coverage?this.undoToRange(e):"inline"===n.coverage?(t=d(n.elements,this.tagNames,this.cssStyle,this.cssClass),this.undoToRange(e),t||this.applyToRange(e)):(d(n.elements,this.tagNames,this.cssStyle,this.cssClass)||this.undoToRange(e),this.applyToRange(e)):this.applyToRange(e)}},e.selection.HTMLApplier=v}(wysihtml5,rangy),wysihtml5.Commands=Base.extend({constructor:function(e){this.editor=e,this.composer=e.composer,this.doc=this.composer.doc},support:function(e){return wysihtml5.browser.supportsCommand(this.doc,e)},exec:function(e,t){var n=wysihtml5.commands[e],o=wysihtml5.lang.array(arguments).get(),r=n&&n.exec,i=null;if(this.editor.fire("beforecommand:composer"),r)o.unshift(this.composer),i=r.apply(n,o);else try{i=this.doc.execCommand(e,!1,t)}catch(a){}return this.editor.fire("aftercommand:composer"),i},state:function(e){var t=wysihtml5.commands[e],n=wysihtml5.lang.array(arguments).get(),o=t&&t.state;if(o)return n.unshift(this.composer),o.apply(t,n);try{return this.doc.queryCommandState(e)}catch(r){return!1}},stateValue:function(e){var t=wysihtml5.commands[e],n=wysihtml5.lang.array(arguments).get(),o=t&&t.stateValue;return!!o&&(n.unshift(this.composer),o.apply(t,n))}}),wysihtml5.commands.bold={exec:function(e,t){wysihtml5.commands.formatInline.execWithToggle(e,t,"b")},state:function(e,t){return wysihtml5.commands.formatInline.state(e,t,"b")}},function(e){function t(t,n){var a,s,l,c,d,u,h,f,m,p=t.doc,g="_wysihtml5-temp-"+ +new Date,y=/non-matching-class/g,v=0;for(e.commands.formatInline.exec(t,o,r,g,y,o,o,!0,!0),a=(s=p.querySelectorAll(r+"."+g)).length;v<a;v++){(l=s[v]).removeAttribute("class");for(m in n)"text"!==m&&l.setAttribute(m,n[m])}u=l,1===a&&(h=i.getTextContent(l),c=!!l.querySelector("*"),d=""===h||h===e.INVISIBLE_SPACE,!c&&d&&(i.setTextContent(l,n.text||l.href),f=p.createTextNode(" "),t.selection.setAfter(l),i.insert(f).after(l),u=f)),t.selection.setAfter(u)}function n(e,t,n){for(var o,r=t.length;r--;){for(var i=(o=t[r].attributes).length;i--;)t[r].removeAttribute(o.item(i).name);for(var a in n)n.hasOwnProperty(a)&&t[r].setAttribute(a,n[a])}}var o,r="A",i=e.dom;e.commands.createLink={exec:function(e,o,r){var i=this.state(e,o);i?e.selection.executeAndRestore(function(){n(e,i,r)}):t(e,r="object"==typeof r?r:{href:r})},state:function(t,n){return e.commands.formatInline.state(t,n,"A")}}}(wysihtml5),function(e){function t(e,t){for(var o,r,i=t.length,a=0;a<i;a++)o=t[a],r=n.getParentElement(o,{nodeName:"code"}),n.getTextContent(o).match(n.autoLink.URL_REG_EXP)&&!r?r=n.renameElement(o,"code"):n.replaceWithChildNodes(o)}var n=e.dom;e.commands.removeLink={exec:function(e,n){var o=this.state(e,n);o&&e.selection.executeAndRestore(function(){t(e,o)})},state:function(t,n){return e.commands.formatInline.state(t,n,"A")}}}(wysihtml5),function(e){var t=/wysiwyg-font-size-[0-9a-z\-]+/g;e.commands.fontSize={exec:function(n,o,r){e.commands.formatInline.execWithToggle(n,o,"span","wysiwyg-font-size-"+r,t)},state:function(n,o,r){return e.commands.formatInline.state(n,o,"span","wysiwyg-font-size-"+r,t)}}}(wysihtml5),function(e){var t=/(\s|^)font-size\s*:\s*[^;\s]+;?/gi;e.commands.fontSizeStyle={exec:function(n,o,r){r="object"==typeof r?r.size:r,/^\s*$/.test(r)||e.commands.formatInline.execWithToggle(n,o,"span",!1,!1,"font-size:"+r,t)},state:function(n,o){return e.commands.formatInline.state(n,o,"span",!1,!1,"font-size",t)},stateValue:function(t,n){var o,r=this.state(t,n);return r&&e.lang.object(r).isArray()&&(r=r[0]),!(!r||!(o=r.getAttribute("style")))&&e.quirks.styleParser.parseFontSize(o)}}}(wysihtml5),function(e){var t=/wysiwyg-color-[0-9a-z]+/g;e.commands.foreColor={exec:function(n,o,r){e.commands.formatInline.execWithToggle(n,o,"span","wysiwyg-color-"+r,t)},state:function(n,o,r){return e.commands.formatInline.state(n,o,"span","wysiwyg-color-"+r,t)}}}(wysihtml5),function(e){var t=/(\s|^)color\s*:\s*[^;\s]+;?/gi;e.commands.foreColorStyle={exec:function(n,o,r){var i,a=e.quirks.styleParser.parseColor("object"==typeof r?"color:"+r.color:"color:"+r,"color");a&&(i="color: rgb("+a[0]+","+a[1]+","+a[2]+");",1!==a[3]&&(i+="color: rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+");"),e.commands.formatInline.execWithToggle(n,o,"span",!1,!1,i,t))},state:function(n,o){return e.commands.formatInline.state(n,o,"span",!1,!1,"color",t)},stateValue:function(t,n,o){var r,i=this.state(t,n);return i&&e.lang.object(i).isArray()&&(i=i[0]),!!(i&&(r=i.getAttribute("style"))&&r)&&(val=e.quirks.styleParser.parseColor(r,"color"),e.quirks.styleParser.unparseColor(val,o))}}}(wysihtml5),function(e){var t=/(\s|^)background-color\s*:\s*[^;\s]+;?/gi;e.commands.bgColorStyle={exec:function(n,o,r){var i,a=e.quirks.styleParser.parseColor("object"==typeof r?"background-color:"+r.color:"background-color:"+r,"background-color");a&&(i="background-color: rgb("+a[0]+","+a[1]+","+a[2]+");",1!==a[3]&&(i+="background-color: rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+");"),e.commands.formatInline.execWithToggle(n,o,"span",!1,!1,i,t))},state:function(n,o){return e.commands.formatInline.state(n,o,"span",!1,!1,"background-color",t)},stateValue:function(t,n,o){var r,i=this.state(t,n),a=!1;return i&&e.lang.object(i).isArray()&&(i=i[0]),!(!i||!(r=i.getAttribute("style")))&&(a=e.quirks.styleParser.parseColor(r,"background-color"),e.quirks.styleParser.unparseColor(a,o))}}}(wysihtml5),function(e){function t(t,n,r){t.className?(o(t,r),t.className=e.lang.string(t.className+" "+n).trim()):t.className=n}function n(t,n,o){r(t,o),t.getAttribute("style")?t.setAttribute("style",e.lang.string(t.getAttribute("style")+" "+n).trim()):t.setAttribute("style",n)}function o(t,n){var o=n.test(t.className);return t.className=t.className.replace(n,""),""==e.lang.string(t.className).trim()&&t.removeAttribute("class"),o}function r(t,n){var o=n.test(t.getAttribute("style"));return t.setAttribute("style",(t.getAttribute("style")||"").replace(n,"")),""==e.lang.string(t.getAttribute("style")||"").trim()&&t.removeAttribute("style"),o}function i(e){var t=e.lastChild;t&&a(t)&&t.parentNode.removeChild(t)}function a(e){return"BR"===e.nodeName}function s(t,n){t.selection.isCollapsed()&&t.selection.selectLine();for(var o=t.selection.surround(n),r=0,a=o.length;r<a;r++)e.dom.lineBreaks(o[r]).remove(),i(o[r])}function l(t){return!!e.lang.string(t.className).trim()}function c(t){return!!e.lang.string(t.getAttribute("style")||"").trim()}var d=e.dom,u=["H1","H2","H3","H4","H5","H6","P","PRE","DIV"];e.commands.formatBlock={exec:function(i,a,h,f,m,p,g){i.doc;var y,v,w,b,C,x=this.state(i,a,h,f,m,p,g),N=i.config.useLineBreaks,E=N?"DIV":"P";h="string"==typeof h?h.toUpperCase():h,x.length?i.selection.executeAndRestoreRangy(function(){for(var t=x.length;t--;){if(m&&(v=o(x[t],m)),g&&(b=r(x[t],g)),(b||v)&&null===h&&x[t].nodeName!=E)return;var n=l(x[t]),i=c(x[t]);n||i||!N&&"P"!==h?d.renameElement(x[t],"P"===h?"DIV":E):(e.dom.lineBreaks(x[t]).add(),d.replaceWithChildNodes(x[t]))}}):(null===h||e.lang.array(u).contains(h))&&(y=i.selection.findNodesInSelection(u).concat(i.selection.getSelectedOwnNodes()),i.selection.executeAndRestoreRangy(function(){for(var e=y.length;e--;)(C=d.getParentElement(y[e],{nodeName:u}))==i.element&&(C=null),C&&(h&&(C=d.renameElement(C,h)),f&&t(C,f,m),p&&n(C,p,g),w=!0)}),w)||s(i,{nodeName:h||E,className:f||null,cssStyle:p||null})},state:function(t,n,o,r,i,a,s){var l,c=t.selection.getSelectedOwnNodes(),u=[];o="string"==typeof o?o.toUpperCase():o;for(var h=0,f=c.length;h<f;h++)(l=d.getParentElement(c[h],{nodeName:o,className:r,classRegExp:i,cssStyle:a,styleRegExp:s}))&&-1==e.lang.array(u).indexOf(l)&&u.push(l);return 0!=u.length&&u}}}(wysihtml5),wysihtml5.commands.formatCode={exec:function(e,t,n){var o,r,i,a=this.state(e);a?e.selection.executeAndRestore(function(){o=a.querySelector("code"),wysihtml5.dom.replaceWithChildNodes(a),o&&wysihtml5.dom.replaceWithChildNodes(o)}):(i=(r=e.selection.getRange()).extractContents(),a=e.doc.createElement("pre"),o=e.doc.createElement("code"),n&&(o.className=n),a.appendChild(o),o.appendChild(i),r.insertNode(a),e.selection.selectNode(a))},state:function(e){var t=e.selection.getSelectedNode();return t&&t.nodeName&&"PRE"==t.nodeName&&t.firstChild&&t.firstChild.nodeName&&"CODE"==t.firstChild.nodeName?t:wysihtml5.dom.getParentElement(t,{nodeName:"CODE"})&&wysihtml5.dom.getParentElement(t,{nodeName:"PRE"})}},function(e){function t(e){var t=o[e];return t?[e.toLowerCase(),t.toLowerCase()]:[e.toLowerCase()]}function n(n,o,i,a,s,l){var c=n;return o&&(c+=":"+o),a&&(c+=":"+a),r[c]||(r[c]=new e.selection.HTMLApplier(t(n),o,i,!0,a,s,l)),r[c]}var o={strong:"b",em:"i",b:"strong",i:"em"},r={};e.commands.formatInline={exec:function(e,t,o,r,i,a,s,l,c){var d=e.selection.createRange(),u=e.selection.getOwnRanges();if(!u||0==u.length)return!1;e.selection.getSelection().removeAllRanges(),n(o,r,i,a,s,e.element).toggleRange(u),l?c||e.cleanUp():(d.setStart(u[0].startContainer,u[0].startOffset),d.setEnd(u[u.length-1].endContainer,u[u.length-1].endOffset),e.selection.setSelection(d),e.selection.executeAndRestore(function(){c||e.cleanUp()},!0,!0))},execWithToggle:function(t,n,o,r,i,a,s){var l=this;if(this.state(t,n,o,r,i,a,s)&&t.selection.isCollapsed()&&!t.selection.caretIsLastInSelection()&&!t.selection.caretIsFirstInSelection()){var c=l.state(t,n,o,r,i)[0];t.selection.executeAndRestoreRangy(function(){c.parentNode;t.selection.selectNode(c,!0),e.commands.formatInline.exec(t,n,o,r,i,a,s,!0,!0)})}else this.state(t,n,o,r,i,a,s)&&!t.selection.isCollapsed()?t.selection.executeAndRestoreRangy(function(){e.commands.formatInline.exec(t,n,o,r,i,a,s,!0,!0)}):e.commands.formatInline.exec(t,n,o,r,i,a,s)},state:function(t,r,i,a,s,l,c){var d,u,h=t.doc,f=o[i]||i;return!(!e.dom.hasElementWithTagName(h,i)&&!e.dom.hasElementWithTagName(h,f))&&(!(a&&!e.dom.hasElementWithClassName(h,a))&&(!(!(d=t.selection.getOwnRanges())||0===d.length)&&(!(!(u=n(i,a,s,l,c,t.element).isAppliedToRange(d))||!u.elements)&&u.elements)))}}}(wysihtml5),function(e){e.commands.insertBlockQuote={exec:function(t,n){var o=this.state(t,n),r=t.selection.isEndToEndInNode(["H1","H2","H3","H4","H5","H6","P"]);t.selection.executeAndRestore(function(){if(o)t.config.useLineBreaks&&e.dom.lineBreaks(o).add(),e.dom.unwrap(o);else if(t.selection.isCollapsed()&&t.selection.selectLine(),r){var n=r.ownerDocument.createElement("blockquote");e.dom.insert(n).after(r),n.appendChild(r)}else t.selection.surround({nodeName:"blockquote"})})},state:function(t){var n=t.selection.getSelectedNode(),o=e.dom.getParentElement(n,{nodeName:"BLOCKQUOTE"},!1,t.element);return o||!1}}}(wysihtml5),wysihtml5.commands.insertHTML={exec:function(e,t,n){e.commands.support(t)?e.doc.execCommand(t,!1,n):e.selection.insertHTML(n)},state:function(){return!1}},function(e){var t="IMG";e.commands.insertImage={exec:function(n,o,r){r="object"==typeof r?r:{src:r};var i,a,s=n.doc,l=this.state(n);if(l)return n.selection.setBefore(l),(a=l.parentNode).removeChild(l),e.dom.removeEmptyTextNodes(a),"A"!==a.nodeName||a.firstChild||(n.selection.setAfter(a),a.parentNode.removeChild(a)),void e.quirks.redraw(n.element);l=s.createElement(t);for(var c in r)l.setAttribute("className"===c?"class":c,r[c]);n.selection.insertNode(l),e.browser.hasProblemsSettingCaretAfterImg()?(i=s.createTextNode(e.INVISIBLE_SPACE),n.selection.insertNode(i),n.selection.setAfter(i)):n.selection.setAfter(l)},state:function(n){var o,r,i,a=n.doc;return!!e.dom.hasElementWithTagName(a,t)&&(!!(o=n.selection.getSelectedNode())&&(o.nodeName===t?o:o.nodeType===e.ELEMENT_NODE&&(r=n.selection.getText(),!(r=e.lang.string(r).trim())&&(1===(i=n.selection.getNodes(e.ELEMENT_NODE,function(e){return"IMG"===e.nodeName})).length&&i[0]))))}}}(wysihtml5),function(e){var t="<br>"+(e.browser.needsSpaceAfterLineBreak()?" ":"");e.commands.insertLineBreak={exec:function(n,o){n.commands.support(o)?(n.doc.execCommand(o,!1,null),e.browser.autoScrollsToCaret()||n.selection.scrollIntoView()):n.commands.exec("insertHTML",t)},state:function(){return!1}}}(wysihtml5),wysihtml5.commands.insertOrderedList={exec:function(e,t){wysihtml5.commands.insertList.exec(e,t,"OL")},state:function(e,t){return wysihtml5.commands.insertList.state(e,t,"OL")}},wysihtml5.commands.insertUnorderedList={exec:function(e,t){wysihtml5.commands.insertList.exec(e,t,"UL")},state:function(e,t){return wysihtml5.commands.insertList.state(e,t,"UL")}},wysihtml5.commands.insertList=function(e){var t=function(e,t){if(e&&e.nodeName){"string"==typeof t&&(t=[t]);for(var n=t.length;n--;)if(e.nodeName===t[n])return!0}return!1},n=function(n,o,r){var i={el:null,other:!1};if(n){var a=e.dom.getParentElement(n,{nodeName:"LI"}),s="UL"===o?"OL":"UL";t(n,o)?i.el=n:t(n,s)?i={el:n,other:!0}:a&&(t(a.parentNode,o)?i.el=a.parentNode:t(a.parentNode,s)&&(i={el:a.parentNode,other:!0}))}return i.el&&!r.element.contains(i.el)&&(i.el=null),i},o=function(t,n,o){var r,a="UL"===n?"OL":"UL";o.selection.executeAndRestore(function(){var s=i(a,o);if(s.length)for(var l=s.length;l--;)e.dom.renameElement(s[l],n.toLowerCase());else{for(var c=(r=i(["OL","UL"],o)).length;c--;)e.dom.resolveList(r[c],o.config.useLineBreaks);e.dom.resolveList(t,o.config.useLineBreaks)}})},r=function(t,n,o){var r="UL"===n?"OL":"UL";o.selection.executeAndRestore(function(){for(var a=[t].concat(i(r,o)),s=a.length;s--;)e.dom.renameElement(a[s],n.toLowerCase())})},i=function(e,n){for(var o=n.selection.getOwnRanges(),r=[],i=o.length;i--;)r=r.concat(o[i].getNodes([1],function(n){return t(n,e)}));return r},a=function(t,n){n.selection.executeAndRestoreRangy(function(){var o,r,i="_wysihtml5-temp-"+(new Date).getTime(),a=n.selection.deblockAndSurround({nodeName:"div",className:i}),s=/\uFEFF/g;a.innerHTML=a.innerHTML.replace(s,""),a&&(o=e.lang.array(["","<br>",e.INVISIBLE_SPACE]).contains(a.innerHTML),r=e.dom.convertToList(a,t.toLowerCase(),n.parent.config.uneditableContainerClassname),o&&n.selection.selectNode(r.querySelector("li"),!0))})};return{exec:function(e,t,i){var s=e.doc,l="OL"===i?"insertOrderedList":"insertUnorderedList",c=e.selection.getSelectedNode(),d=n(c,i,e);d.el?d.other?r(d.el,i,e):o(d.el,i,e):e.commands.support(l)?s.execCommand(l,!1,null):a(i,e)},state:function(e,t,o){var r=e.selection.getSelectedNode(),i=n(r,o,e);return!(!i.el||i.other)&&i.el}}}(wysihtml5),wysihtml5.commands.italic={exec:function(e,t){wysihtml5.commands.formatInline.execWithToggle(e,t,"i")},state:function(e,t){return wysihtml5.commands.formatInline.state(e,t,"i")}},function(e){var t="wysiwyg-text-align-center",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyCenter={exec:function(o){return e.commands.formatBlock.exec(o,"formatBlock",null,t,n)},state:function(o){return e.commands.formatBlock.state(o,"formatBlock",null,t,n)}}}(wysihtml5),function(e){var t="wysiwyg-text-align-left",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyLeft={exec:function(o){return e.commands.formatBlock.exec(o,"formatBlock",null,t,n)},state:function(o){return e.commands.formatBlock.state(o,"formatBlock",null,t,n)}}}(wysihtml5),function(e){var t="wysiwyg-text-align-right",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyRight={exec:function(o){return e.commands.formatBlock.exec(o,"formatBlock",null,t,n)},state:function(o){return e.commands.formatBlock.state(o,"formatBlock",null,t,n)}}}(wysihtml5),function(e){var t="wysiwyg-text-align-justify",n=/wysiwyg-text-align-[0-9a-z]+/g;e.commands.justifyFull={exec:function(o){return e.commands.formatBlock.exec(o,"formatBlock",null,t,n)},state:function(o){return e.commands.formatBlock.state(o,"formatBlock",null,t,n)}}}(wysihtml5),function(e){var t="text-align: right;",n=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;e.commands.alignRightStyle={exec:function(o){return e.commands.formatBlock.exec(o,"formatBlock",null,null,null,t,n)},state:function(o){return e.commands.formatBlock.state(o,"formatBlock",null,null,null,t,n)}}}(wysihtml5),function(e){var t="text-align: left;",n=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;e.commands.alignLeftStyle={exec:function(o){return e.commands.formatBlock.exec(o,"formatBlock",null,null,null,t,n)},state:function(o){return e.commands.formatBlock.state(o,"formatBlock",null,null,null,t,n)}}}(wysihtml5),function(e){var t="text-align: center;",n=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;e.commands.alignCenterStyle={exec:function(o){return e.commands.formatBlock.exec(o,"formatBlock",null,null,null,t,n)},state:function(o){return e.commands.formatBlock.state(o,"formatBlock",null,null,null,t,n)}}}(wysihtml5),wysihtml5.commands.redo={exec:function(e){return e.undoManager.redo()},state:function(){return!1}},wysihtml5.commands.underline={exec:function(e,t){wysihtml5.commands.formatInline.execWithToggle(e,t,"u")},state:function(e,t){return wysihtml5.commands.formatInline.state(e,t,"u")}},wysihtml5.commands.undo={exec:function(e){return e.undoManager.undo()},state:function(){return!1}},wysihtml5.commands.createTable={exec:function(e,t,n){var o,r,i;if(n&&n.cols&&n.rows&&parseInt(n.cols,10)>0&&parseInt(n.rows,10)>0){for(i=n.tableStyle?'<table style="'+n.tableStyle+'">':"<table>",i+="<tbody>",r=0;r<n.rows;r++){for(i+="<tr>",o=0;o<n.cols;o++)i+="<td>&nbsp;</td>";i+="</tr>"}i+="</tbody></table>",e.commands.exec("insertHTML",i)}},state:function(){return!1}},wysihtml5.commands.mergeTableCells={exec:function(e,t){e.tableSelection&&e.tableSelection.start&&e.tableSelection.end&&(this.state(e,t)?wysihtml5.dom.table.unmergeCell(e.tableSelection.start):wysihtml5.dom.table.mergeCellsBetween(e.tableSelection.start,e.tableSelection.end))},state:function(e){if(e.tableSelection){var t=e.tableSelection.start,n=e.tableSelection.end;if(t&&n&&t==n&&(wysihtml5.dom.getAttribute(t,"colspan")&&parseInt(wysihtml5.dom.getAttribute(t,"colspan"),10)>1||wysihtml5.dom.getAttribute(t,"rowspan")&&parseInt(wysihtml5.dom.getAttribute(t,"rowspan"),10)>1))return[t]}return!1}},wysihtml5.commands.addTableCells={exec:function(e,t,n){if(e.tableSelection&&e.tableSelection.start&&e.tableSelection.end){var o=wysihtml5.dom.table.orderSelectionEnds(e.tableSelection.start,e.tableSelection.end);"before"==n||"above"==n?wysihtml5.dom.table.addCells(o.start,n):"after"!=n&&"below"!=n||wysihtml5.dom.table.addCells(o.end,n),setTimeout(function(){e.tableSelection.select(o.start,o.end)},0)}},state:function(){return!1}},wysihtml5.commands.deleteTableCells={exec:function(e,t,n){if(e.tableSelection&&e.tableSelection.start&&e.tableSelection.end){var o,r=wysihtml5.dom.table.orderSelectionEnds(e.tableSelection.start,e.tableSelection.end),i=wysihtml5.dom.table.indexOf(r.start),a=e.tableSelection.table;wysihtml5.dom.table.removeCells(r.start,n),setTimeout(function(){(o=wysihtml5.dom.table.findCell(a,i))||("row"==n&&(o=wysihtml5.dom.table.findCell(a,{row:i.row-1,col:i.col})),"column"==n&&(o=wysihtml5.dom.table.findCell(a,{row:i.row,col:i.col-1}))),o&&e.tableSelection.select(o,o)},0)}},state:function(){return!1}},wysihtml5.commands.indentList={exec:function(e){var t=e.selection.getSelectionParentsByTag("LI");return!!t&&this.tryToPushLiLevel(t,e.selection)},state:function(){return!1},tryToPushLiLevel:function(e,t){var n,o,r,i,a,s=!1;return t.executeAndRestoreRangy(function(){for(var t=e.length;t--;)i=e[t],n="OL"===i.parentNode.nodeName?"OL":"UL",o=i.ownerDocument.createElement(n),r=wysihtml5.dom.domNode(i).prev({nodeTypes:[wysihtml5.ELEMENT_NODE]}),a=r?r.querySelector("ul, ol"):null,r&&(a?a.appendChild(i):(o.appendChild(i),r.appendChild(o)),s=!0)}),s}},wysihtml5.commands.outdentList={exec:function(e){var t=e.selection.getSelectionParentsByTag("LI");return!!t&&this.tryToPullLiLevel(t,e)},state:function(){return!1},tryToPullLiLevel:function(e,t){var n,o,r,i,a,s=!1,l=this;return t.selection.executeAndRestoreRangy(function(){for(var c=e.length;c--;)if((i=e[c]).parentNode&&("OL"===(n=i.parentNode).tagName||"UL"===n.tagName)){if(s=!0,o=wysihtml5.dom.getParentElement(n.parentNode,{nodeName:["OL","UL"]},!1,t.element),r=wysihtml5.dom.getParentElement(n.parentNode,{nodeName:["LI"]},!1,t.element),o&&r)i.nextSibling&&(a=l.getAfterList(n,i),i.appendChild(a)),o.insertBefore(i,r.nextSibling);else{i.nextSibling&&(a=l.getAfterList(n,i),i.appendChild(a));for(var d=i.childNodes.length;d--;)n.parentNode.insertBefore(i.childNodes[d],n.nextSibling);n.parentNode.insertBefore(document.createElement("br"),n.nextSibling),i.parentNode.removeChild(i)}0===n.childNodes.length&&n.parentNode.removeChild(n)}}),s},getAfterList:function(e,t){for(var n=e.nodeName,o=document.createElement(n);t.nextSibling;)o.appendChild(t.nextSibling);return o}},function(e){var t=90,n=89,o=8,r=46,i=25,a="data-wysihtml5-selection-node",s="data-wysihtml5-selection-offset",l=(e.INVISIBLE_SPACE,e.INVISIBLE_SPACE,e.dom);e.UndoManager=e.lang.Dispatcher.extend({constructor:function(e){this.editor=e,this.composer=e.composer,this.element=this.composer.element,this.position=0,this.historyStr=[],this.historyDom=[],this.transact(),this._observe()},_observe:function(){var e,i=this;this.composer.sandbox.getDocument();l.observe(this.element,"keydown",function(e){if(!e.altKey&&(e.ctrlKey||e.metaKey)){var o=e.keyCode,r=o===t&&!e.shiftKey,a=o===t&&e.shiftKey||o===n;r?(i.undo(),e.preventDefault()):a&&(i.redo(),e.preventDefault())}}),l.observe(this.element,"keydown",function(t){var n=t.keyCode;n!==e&&(e=n,n!==o&&n!==r||i.transact())}),this.editor.on("newword:composer",function(){i.transact()}).on("beforecommand:composer",function(){i.transact()})},transact:function(){var t,n,o,r,l,c=this.historyStr[this.position-1],d=this.composer.getValue(!1,!1),u=this.element.offsetWidth>0&&this.element.offsetHeight>0;if(d!==c){(this.historyStr.length=this.historyDom.length=this.position)>i&&(this.historyStr.shift(),this.historyDom.shift(),this.position--),this.position++,u&&(n=(t=this.composer.selection.getRange())&&t.startContainer?t.startContainer:this.element,o=t&&t.startOffset?t.startOffset:0,n.nodeType===e.ELEMENT_NODE?r=n:(r=n.parentNode,l=this.getChildNodeIndex(r,n)),r.setAttribute(s,o),void 0!==l&&r.setAttribute(a,l));var h=this.element.cloneNode(!!d);this.historyDom.push(h),this.historyStr.push(d),r&&(r.removeAttribute(s),r.removeAttribute(a))}},undo:function(){this.transact(),this.undoPossible()&&(this.set(this.historyDom[--this.position-1]),this.editor.fire("undo:composer"))},redo:function(){this.redoPossible()&&(this.set(this.historyDom[++this.position-1]),this.editor.fire("redo:composer"))},undoPossible:function(){return this.position>1},redoPossible:function(){return this.position<this.historyStr.length},set:function(e){this.element.innerHTML="";for(var t=0,n=e.childNodes,o=e.childNodes.length;t<o;t++)this.element.appendChild(n[t].cloneNode(!0));var r,i,l;e.hasAttribute(s)?(r=e.getAttribute(s),l=e.getAttribute(a),i=this.element):(r=(i=this.element.querySelector("["+s+"]")||this.element).getAttribute(s),l=i.getAttribute(a),i.removeAttribute(s),i.removeAttribute(a)),null!==l&&(i=this.getChildNodeByIndex(i,+l)),this.composer.selection.set(i,r)},getChildNodeIndex:function(e,t){for(var n=0,o=e.childNodes,r=o.length;n<r;n++)if(o[n]===t)return n},getChildNodeByIndex:function(e,t){return e.childNodes[t]}})}(wysihtml5),wysihtml5.views.View=Base.extend({constructor:function(e,t,n){this.parent=e,this.element=t,this.config=n,this.config.noTextarea||this._observeViewChange()},_observeViewChange:function(){var e=this;this.parent.on("beforeload",function(){e.parent.on("change_view",function(t){t===e.name?(e.parent.currentView=e,e.show(),setTimeout(function(){e.focus()},0)):e.hide()})})},focus:function(){if(this.element.ownerDocument.querySelector(":focus")!==this.element)try{this.element.focus()}catch(e){}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}}),function(e){var t=e.dom,n=e.browser;e.views.Composer=e.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(e,t,n){this.base(e,t,n),this.config.noTextarea?this.editableArea=t:this.textarea=this.parent.textarea,this.config.contentEditableMode?this._initContentEditableArea():this._initSandbox()},clear:function(){this.element.innerHTML=n.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(t,n){var o=this.isEmpty()?"":e.quirks.getCorrectInnerHTML(this.element);return!1!==t&&(o=this.parent.parse(o,!1!==n)),o},setValue:function(e,t){t&&(e=this.parent.parse(e));try{this.element.innerHTML=e}catch(n){this.element.innerText=e}},cleanUp:function(){this.parent.parse(this.element)},show:function(){this.editableArea.style.display=this._displayStyle||"",this.config.noTextarea||this.textarea.element.disabled||(this.disable(),this.enable())},hide:function(){this._displayStyle=t.getStyle("display").from(this.editableArea),"none"===this._displayStyle&&(this._displayStyle=null),this.editableArea.style.display="none"},disable:function(){this.parent.fire("disable:composer"),this.element.removeAttribute("contentEditable")},enable:function(){this.parent.fire("enable:composer"),this.element.setAttribute("contentEditable","true")},focus:function(t){e.browser.doesAsyncFocus()&&this.hasPlaceholderSet()&&this.clear(),this.base();var n=this.element.lastChild;t&&n&&this.selection&&("BR"===n.nodeName?this.selection.setBefore(this.element.lastChild):this.selection.setAfter(this.element.lastChild))},getTextContent:function(){return t.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==(this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"))&&this.placeholderSet},isEmpty:function(){var e=this.element.innerHTML.toLowerCase();return/^(\s|<br>|<\/br>|<p>|<\/p>)*$/i.test(e)||""===e||"<br>"===e||"<p></p>"===e||"<p><br></p>"===e||this.hasPlaceholderSet()},_initContentEditableArea:function(){var e=this;this.config.noTextarea?this.sandbox=new t.ContentEditableArea(function(){e._create()},{},this.editableArea):(this.sandbox=new t.ContentEditableArea(function(){e._create()}),this.editableArea=this.sandbox.getContentEditable(),t.insert(this.editableArea).after(this.textarea.element),this._createWysiwygFormField())},_initSandbox:function(){var e=this;this.sandbox=new t.Sandbox(function(){e._create()},{stylesheets:this.config.stylesheets}),this.editableArea=this.sandbox.getIframe();var n=this.textarea.element;t.insert(this.editableArea).after(n),this._createWysiwygFormField()},_createWysiwygFormField:function(){if(this.textarea.element.form){var e=document.createElement("input");e.type="hidden",e.name="_wysihtml5_mode",e.value=1,t.insert(e).after(this.textarea.element)}},_create:function(){var o=this;this.doc=this.sandbox.getDocument(),this.element=this.config.contentEditableMode?this.sandbox.getContentEditable():this.doc.body,this.config.noTextarea?this.cleanUp():(this.textarea=this.parent.textarea,this.element.innerHTML=this.textarea.getValue(!0,!1)),this.selection=new e.Selection(this.parent,this.element,this.config.uneditableContainerClassname),this.commands=new e.Commands(this.parent),this.config.noTextarea||t.copyAttributes(["className","spellcheck","title","lang","dir","accessKey"]).from(this.textarea.element).to(this.element),t.addClass(this.element,this.config.composerClassName),this.config.style&&!this.config.contentEditableMode&&this.style(),this.observe();var r=this.config.name;r&&(t.addClass(this.element,r),this.config.contentEditableMode||t.addClass(this.editableArea,r)),this.enable(),!this.config.noTextarea&&this.textarea.element.disabled&&this.disable();var i="string"==typeof this.config.placeholder?this.config.placeholder:this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder");i&&t.simulatePlaceholder(this.parent,this,i),this.commands.exec("styleWithCSS",!1),this._initAutoLinking(),this._initObjectResizing(),this._initUndoManager(),this._initLineBreaking(),this.config.noTextarea||!this.textarea.element.hasAttribute("autofocus")&&document.querySelector(":focus")!=this.textarea.element||n.isIos()||setTimeout(function(){o.focus(!0)},100),n.clearsContentEditableCorrectly()||e.quirks.ensureProperClearing(this),this.initSync&&this.config.sync&&this.initSync(),this.config.noTextarea||this.textarea.hide(),this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){
var o=this,r=n.canDisableAutoLinking(),i=n.doesAutoLinkingInContentEditable();if(r&&this.commands.exec("autoUrlDetect",!1),this.config.autoLink){(!i||i&&r)&&(this.parent.on("newword:composer",function(){t.getTextContent(o.element).match(t.autoLink.URL_REG_EXP)&&o.selection.executeAndRestore(function(n,r){for(var i=o.element.querySelectorAll("."+o.config.uneditableContainerClassname),a=!1,s=i.length;s--;)e.dom.contains(i[s],r)&&(a=!0);a||t.autoLink(r.parentNode,[o.config.uneditableContainerClassname])})}),t.observe(this.element,"blur",function(){t.autoLink(o.element,[o.config.uneditableContainerClassname])}));var a=this.sandbox.getDocument().getElementsByTagName("a"),s=t.autoLink.URL_REG_EXP,l=function(n){var o=e.lang.string(t.getTextContent(n)).trim();return"www."===o.substr(0,4)&&(o="http://"+o),o};t.observe(this.element,"keydown",function(e){if(a.length){var n,r=o.selection.getSelectedNode(e.target.ownerDocument),i=t.getParentElement(r,{nodeName:"A"},4);i&&(n=l(i),setTimeout(function(){var e=l(i);e!==n&&e.match(s)&&i.setAttribute("href",e)},0))}})}},_initObjectResizing:function(){if(this.commands.exec("enableObjectResizing",!0),n.supportsEvent("resizeend")){var o=["width","height"],r=o.length,i=this.element;t.observe(i,"resizeend",function(t){var n,a=t.target||t.srcElement,s=a.style,l=0;if("IMG"===a.nodeName){for(;l<r;l++)s[n=o[l]]&&(a.setAttribute(n,parseInt(s[n],10)),s[n]="");e.quirks.redraw(i)}})}},_initUndoManager:function(){this.undoManager=new e.UndoManager(this.parent)},_initLineBreaking:function(){function o(e){var n=t.getParentElement(e,{nodeName:["P","DIV"]},2);n&&t.contains(r.element,n)&&r.selection.executeAndRestore(function(){r.config.useLineBreaks?t.replaceWithChildNodes(n):"P"!==n.nodeName&&t.renameElement(n,"p")})}var r=this,i=["LI","P","H1","H2","H3","H4","H5","H6"],a=["UL","OL","MENU"];this.config.useLineBreaks||t.observe(this.element,["focus","keydown"],function(){if(r.isEmpty()){var e=r.doc.createElement("P");r.element.innerHTML="",r.element.appendChild(e),n.displaysCaretInEmptyContentEditableCorrectly()?r.selection.selectNode(e,!0):(e.innerHTML="<br>",r.selection.setBefore(e.firstChild))}}),t.observe(this.element,"keydown",function(n){var s=n.keyCode;if(!n.shiftKey&&(s===e.ENTER_KEY||s===e.BACKSPACE_KEY)){var l=t.getParentElement(r.selection.getSelectedNode(),{nodeName:i},4);l?setTimeout(function(){var n=r.selection.getSelectedNode();if("LI"===l.nodeName){if(!n)return;t.getParentElement(n,{nodeName:a},2)||o(n)}s===e.ENTER_KEY&&l.nodeName.match(/^H[1-6]$/)&&o(n)},0):r.config.useLineBreaks&&s===e.ENTER_KEY&&!e.browser.insertsLineBreaksOnReturn()&&(n.preventDefault(),r.commands.exec("insertLineBreak"))}})}})}(wysihtml5),function(e){var t=e.dom,n=document,o=window,r=n.createElement("div"),i=["background-color","color","cursor","font-family","font-size","font-style","font-variant","font-weight","line-height","letter-spacing","text-align","text-decoration","text-indent","text-rendering","word-break","word-wrap","word-spacing"],a=["background-color","border-collapse","border-bottom-color","border-bottom-style","border-bottom-width","border-left-color","border-left-style","border-left-width","border-right-color","border-right-style","border-right-width","border-top-color","border-top-style","border-top-width","clear","display","float","margin-bottom","margin-left","margin-right","margin-top","outline-color","outline-offset","outline-width","outline-style","padding-left","padding-right","padding-top","padding-bottom","position","top","left","right","bottom","z-index","vertical-align","text-align","-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing","-webkit-box-shadow","-moz-box-shadow","-ms-box-shadow","box-shadow","-webkit-border-top-right-radius","-moz-border-radius-topright","border-top-right-radius","-webkit-border-bottom-right-radius","-moz-border-radius-bottomright","border-bottom-right-radius","-webkit-border-bottom-left-radius","-moz-border-radius-bottomleft","border-bottom-left-radius","-webkit-border-top-left-radius","-moz-border-radius-topleft","border-top-left-radius","width","height"],s=["html                 { height: 100%; }","body                 { height: 100%; padding: 1px 0 0 0; margin: -1px 0 0 0; }","body > p:first-child { margin-top: 0; }","._wysihtml5-temp     { display: none; }",".wysiwyg-color-black {color: black;}",".wysiwyg-color-silver {color: silver;}",".wysiwyg-color-gray {color: gray;}",".wysiwyg-color-white {color: white;}",".wysiwyg-color-maroon {color: maroon;}",".wysiwyg-color-red {color: red;}",".wysiwyg-color-purple {color: purple;}",".wysiwyg-color-fuchsia {color: fuchsia;}",".wysiwyg-color-green {color: green;}",".wysiwyg-color-lime {color: lime;}",".wysiwyg-color-olive {color: olive;}",".wysiwyg-color-yellow {color: yellow;}",".wysiwyg-color-navy {color: navy;}",".wysiwyg-color-blue {color: blue;}",".wysiwyg-color-teal {color: teal;}",".wysiwyg-color-aqua {color: aqua;}",".wysiwyg-color-orange {color: orange;}",e.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"],l=function(e){if(e.setActive)try{e.setActive()}catch(l){}else{var r=e.style,i=n.documentElement.scrollTop||n.body.scrollTop,a=n.documentElement.scrollLeft||n.body.scrollLeft,s={position:r.position,top:r.top,left:r.left,WebkitUserSelect:r.WebkitUserSelect};t.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(e),e.focus(),t.setStyles(s).on(e),o.scrollTo&&o.scrollTo(a,i)}};e.views.Composer.prototype.style=function(){var o,c=this,d=n.querySelector(":focus"),u=this.textarea.element,h=u.hasAttribute("placeholder"),f=h&&u.getAttribute("placeholder"),m=u.style.display,p=u.disabled;this.focusStylesHost=r.cloneNode(!1),this.blurStylesHost=r.cloneNode(!1),this.disabledStylesHost=r.cloneNode(!1),h&&u.removeAttribute("placeholder"),u===d&&u.blur(),u.disabled=!1,u.style.display=o="none",(u.getAttribute("rows")&&"auto"===t.getStyle("height").from(u)||u.getAttribute("cols")&&"auto"===t.getStyle("width").from(u))&&(u.style.display=o=m),t.copyStyles(a).from(u).to(this.editableArea).andTo(this.blurStylesHost),t.copyStyles(i).from(u).to(this.element).andTo(this.blurStylesHost),t.insertCSS(s).into(this.element.ownerDocument),u.disabled=!0,t.copyStyles(a).from(u).to(this.disabledStylesHost),t.copyStyles(i).from(u).to(this.disabledStylesHost),u.disabled=p,u.style.display=m,l(u),u.style.display=o,t.copyStyles(a).from(u).to(this.focusStylesHost),t.copyStyles(i).from(u).to(this.focusStylesHost),u.style.display=m,t.copyStyles(["display"]).from(u).to(this.editableArea);var g=e.lang.array(a).without(["display"]);return d?d.focus():u.blur(),h&&u.setAttribute("placeholder",f),this.parent.on("focus:composer",function(){t.copyStyles(g).from(c.focusStylesHost).to(c.editableArea),t.copyStyles(i).from(c.focusStylesHost).to(c.element)}),this.parent.on("blur:composer",function(){t.copyStyles(g).from(c.blurStylesHost).to(c.editableArea),t.copyStyles(i).from(c.blurStylesHost).to(c.element)}),this.parent.observe("disable:composer",function(){t.copyStyles(g).from(c.disabledStylesHost).to(c.editableArea),t.copyStyles(i).from(c.disabledStylesHost).to(c.element)}),this.parent.observe("enable:composer",function(){t.copyStyles(g).from(c.blurStylesHost).to(c.editableArea),t.copyStyles(i).from(c.blurStylesHost).to(c.element)}),this}}(wysihtml5),function(e){var t=e.dom,n=e.browser,o={66:"bold",73:"italic",85:"underline"},r=function(e,t,n){var o=e.getPreviousNode(t,!0),r=e.getSelectedNode();if(1!==r.nodeType&&r.parentNode!==n&&(r=r.parentNode),o)if(1==r.nodeType){var i=r.firstChild;if(1==o.nodeType)for(;r.firstChild;)o.appendChild(r.firstChild);else for(;r.firstChild;)t.parentNode.insertBefore(r.firstChild,t);r.parentNode&&r.parentNode.removeChild(r),e.setBefore(i)}else 1==o.nodeType?o.appendChild(r):t.parentNode.insertBefore(r,t),e.setBefore(r)},i=function(e,t,n,o){if(t.isCollapsed())if(t.caretIsInTheBeginnig("LI"))e.preventDefault(),o.commands.exec("outdentList");else if(t.caretIsInTheBeginnig())e.preventDefault();else{if(t.caretIsFirstInSelection()&&t.getPreviousNode()&&t.getPreviousNode().nodeName&&/^H\d$/gi.test(t.getPreviousNode().nodeName)){var i=t.getPreviousNode();if(e.preventDefault(),/^\s*$/.test(i.textContent||i.innerText))i.parentNode.removeChild(i);else{var a=i.ownerDocument.createRange();a.selectNodeContents(i),a.collapse(!1),t.setSelection(a)}}var s=t.caretIsBeforeUneditable();s&&(e.preventDefault(),r(t,s,n))}else t.containsUneditable()&&(e.preventDefault(),t.deleteContents())},a=function(e){if(e.selection.isCollapsed()){if(e.selection.caretIsInTheBeginnig("LI")&&e.commands.exec("indentList"))return}else e.selection.deleteContents();e.commands.exec("insertHTML","&emsp;")};e.views.Composer.prototype.observe=function(){var r=this,s=this.getValue(!1,!1),l=this.sandbox.getIframe?this.sandbox.getIframe():this.sandbox.getContentEditable(),c=this.element,d=n.supportsEventsInIframeCorrectly()||this.sandbox.getContentEditable?c:this.sandbox.getWindow(),u=["drop","paste"],h=["drop","paste","mouseup","focus","keyup"];if(t.observe(l,"DOMNodeRemoved",function(){clearInterval(f),r.parent.fire("destroy:composer")}),!n.supportsMutationEvents())var f=setInterval(function(){t.contains(document.documentElement,l)||(clearInterval(f),r.parent.fire("destroy:composer"))},250);t.observe(d,h,function(){setTimeout(function(){r.parent.fire("interaction").fire("interaction:composer")},0)}),this.config.handleTables&&(!this.tableClickHandle&&this.doc.execCommand&&e.browser.supportsCommand(this.doc,"enableObjectResizing")&&e.browser.supportsCommand(this.doc,"enableInlineTableEditing")&&(this.sandbox.getIframe?this.tableClickHandle=t.observe(l,["focus","mouseup","mouseover"],function(){r.doc.execCommand("enableObjectResizing",!1,"false"),r.doc.execCommand("enableInlineTableEditing",!1,"false"),r.tableClickHandle.stop()}):setTimeout(function(){r.doc.execCommand("enableObjectResizing",!1,"false"),r.doc.execCommand("enableInlineTableEditing",!1,"false")},0)),this.tableSelection=e.quirks.tableCellsSelection(c,r.parent)),t.observe(d,"focus",function(e){r.parent.fire("focus",e).fire("focus:composer",e),setTimeout(function(){s=r.getValue(!1,!1)},0)}),t.observe(d,"blur",function(e){if(s!==r.getValue(!1,!1)){var t=e;"function"==typeof Object.create&&(t=Object.create(e,{type:{value:"change"}})),r.parent.fire("change",t).fire("change:composer",t)}r.parent.fire("blur",e).fire("blur:composer",e)}),t.observe(c,"dragenter",function(){r.parent.fire("unset_placeholder")}),t.observe(c,u,function(e){setTimeout(function(){r.parent.fire(e.type,e).fire(e.type+":composer",e)},0)}),t.observe(c,"keyup",function(t){var n=t.keyCode;n!==e.SPACE_KEY&&n!==e.ENTER_KEY||r.parent.fire("newword:composer")}),this.parent.on("paste:composer",function(){setTimeout(function(){r.parent.fire("newword:composer")},0)}),n.canSelectImagesInContentEditable()||t.observe(c,"mousedown",function(t){var n=t.target,o=c.querySelectorAll("img"),i=c.querySelectorAll("."+r.config.uneditableContainerClassname+" img"),a=e.lang.array(o).without(i);"IMG"===n.nodeName&&e.lang.array(a).contains(n)&&r.selection.selectNode(n)}),n.canSelectImagesInContentEditable()||t.observe(c,"drop",function(){setTimeout(function(){r.selection.getSelection().removeAllRanges()},0)}),n.hasHistoryIssue()&&n.supportsSelectionModify()&&t.observe(c,"keydown",function(e){if(e.metaKey||e.ctrlKey){var t=e.keyCode,n=c.ownerDocument.defaultView.getSelection();37!==t&&39!==t||(37===t&&(n.modify("extend","left","lineboundary"),e.shiftKey||n.collapseToStart()),39===t&&(n.modify("extend","right","lineboundary"),e.shiftKey||n.collapseToEnd()),e.preventDefault())}}),t.observe(c,"keydown",function(e){var t=e.keyCode,n=o[t];(e.ctrlKey||e.metaKey)&&!e.altKey&&n&&(r.commands.exec(n),e.preventDefault()),8===t?i(e,r.selection,c,r):r.config.handleTabKey&&9===t&&(e.preventDefault(),a(r,c))}),t.observe(c,"keydown",function(t){var n,o=r.selection.getSelectedNode(!0),i=t.keyCode;!o||"IMG"!==o.nodeName||i!==e.BACKSPACE_KEY&&i!==e.DELETE_KEY||((n=o.parentNode).removeChild(o),"A"!==n.nodeName||n.firstChild||n.parentNode.removeChild(n),setTimeout(function(){e.quirks.redraw(c)},0),t.preventDefault())}),!this.config.contentEditableMode&&n.hasIframeFocusIssue()&&(t.observe(l,"focus",function(){setTimeout(function(){r.doc.querySelector(":focus")!==r.element&&r.focus()},0)}),t.observe(this.element,"blur",function(){setTimeout(function(){r.selection.getSelection().removeAllRanges()},0)}));var m={IMG:"Image: ",A:"Link: "};t.observe(c,"mouseover",function(e){var t,n=e.target,o=n.nodeName;if("A"===o||"IMG"===o){n.hasAttribute("title")||(t=m[o]+(n.getAttribute("href")||n.getAttribute("src")),n.setAttribute("title",t))}})}}(wysihtml5),function(e){var t=400;e.views.Synchronizer=Base.extend({constructor:function(e,t,n){this.editor=e,this.textarea=t,this.composer=n,this._observe()},fromComposerToTextarea:function(t){this.textarea.setValue(e.lang.string(this.composer.getValue(!1,!1)).trim(),t)},fromTextareaToComposer:function(e){var t=this.textarea.getValue(!1,!1);t?this.composer.setValue(t,e):(this.composer.clear(),this.editor.fire("set_placeholder"))},sync:function(e){"textarea"===this.editor.currentView.name?this.fromTextareaToComposer(e):this.fromComposerToTextarea(e)},_observe:function(){var n,o=this,r=this.textarea.element.form,i=function(){n=setInterval(function(){o.fromComposerToTextarea()},t)},a=function(){clearInterval(n),n=null};i(),r&&(e.dom.observe(r,"submit",function(){o.sync(!0)}),e.dom.observe(r,"reset",function(){setTimeout(function(){o.fromTextareaToComposer()},0)})),this.editor.on("change_view",function(e){"composer"!==e||n?"textarea"===e&&(o.fromComposerToTextarea(!0),a()):(o.fromTextareaToComposer(!0),i())}),this.editor.on("destroy:composer",a)}})}(wysihtml5),wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(e,t,n){this.base(e,t,n),this._observe()},clear:function(){this.element.value=""},getValue:function(e){var t=this.isEmpty()?"":this.element.value;return!1!==e&&(t=this.parent.parse(t)),t},setValue:function(e,t){t&&(e=this.parent.parse(e)),this.element.value=e},cleanUp:function(){var e=this.parent.parse(this.element.value);this.element.value=e},hasPlaceholderSet:function(){var e=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),t=this.element.getAttribute("placeholder")||null,n=this.element.value;return e&&!n||n===t},isEmpty:function(){return!wysihtml5.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var e=this.element,t=this.parent,n={focusin:"focus",focusout:"blur"},o=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];t.on("beforeload",function(){wysihtml5.dom.observe(e,o,function(e){var o=n[e.type]||e.type;t.fire(o).fire(o+":textarea")}),wysihtml5.dom.observe(e,["paste","drop"],function(){setTimeout(function(){t.fire("paste").fire("paste:textarea")},0)})})}}),function(e){var t,n={name:t,style:!0,toolbar:t,showToolbarAfterInit:!0,autoLink:!0,handleTables:!0,handleTabKey:!0,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},parser:e.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",useLineBreaks:!0,stylesheets:[],placeholderText:t,supportTouchDevices:!0,cleanUp:!0,contentEditableMode:!1,uneditableContainerClassname:"wysihtml5-uneditable-container"};e.Editor=e.lang.Dispatcher.extend({constructor:function(t,o){if(this.editableElement="string"==typeof t?document.getElementById(t):t,this.config=e.lang.object({}).merge(n).merge(o).get(),this._isCompatible=e.browser.supported(),"textarea"!=this.editableElement.nodeName.toLowerCase()&&(this.config.contentEditableMode=!0,this.config.noTextarea=!0),this.config.noTextarea||(this.textarea=new e.views.Textarea(this,this.editableElement,this.config),this.currentView=this.textarea),!this._isCompatible||!this.config.supportTouchDevices&&e.browser.isTouchDevice()){var r=this;setTimeout(function(){r.fire("beforeload").fire("load")},0)}else e.dom.addClass(document.body,this.config.bodyClassName),this.composer=new e.views.Composer(this,this.editableElement,this.config),this.currentView=this.composer,"function"==typeof this.config.parser&&this._initParser(),this.on("beforeload",this.handleBeforeLoad)},handleBeforeLoad:function(){this.config.noTextarea||(this.synchronizer=new e.views.Synchronizer(this,this.textarea,this.composer)),this.config.toolbar&&(this.toolbar=new e.toolbar.Toolbar(this,this.config.toolbar,this.config.showToolbarAfterInit))},isCompatible:function(){return this._isCompatible},clear:function(){return this.currentView.clear(),this},getValue:function(e,t){return this.currentView.getValue(e,t)},setValue:function(e,t){return this.fire("unset_placeholder"),e?(this.currentView.setValue(e,t),this):this.clear()},cleanUp:function(){this.currentView.cleanUp()},focus:function(e){return this.currentView.focus(e),this},disable:function(){return this.currentView.disable(),this},enable:function(){return this.currentView.enable(),this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(t,n){var o=this.config.contentEditableMode?document:this.composer?this.composer.sandbox.getDocument():null,r=this.config.parser(t,{rules:this.config.parserRules,cleanUp:this.config.cleanUp,context:o,uneditableClass:this.config.uneditableContainerClassname,clearInternals:n});return"object"==typeof t&&e.quirks.redraw(t),r},_initParser:function(){this.on("paste:composer",function(){var t=!0,n=this;n.composer.selection.executeAndRestore(function(){e.quirks.cleanPastedHTML(n.composer.element),n.parse(n.composer.element)},t)})}})}(wysihtml5),function(e){var t=e.dom,n="wysihtml5-command-dialog-opened",o="input, select, textarea",r="[data-wysihtml5-dialog-field]",i="data-wysihtml5-dialog-field";e.toolbar.Dialog=e.lang.Dispatcher.extend({constructor:function(e,t){this.link=e,this.container=t},_observe:function(){if(!this._observed){var r=this,i=function(e){var t=r._serialize();t==r.elementToChange?r.fire("edit",t):r.fire("save",t),r.hide(),e.preventDefault(),e.stopPropagation()};t.observe(r.link,"click",function(){t.hasClass(r.link,n)&&setTimeout(function(){r.hide()},0)}),t.observe(this.container,"keydown",function(t){var n=t.keyCode;n===e.ENTER_KEY&&i(t),n===e.ESCAPE_KEY&&(r.fire("cancel"),r.hide())}),t.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",i),t.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(e){r.fire("cancel"),r.hide(),e.preventDefault(),e.stopPropagation()});for(var a=this.container.querySelectorAll(o),s=0,l=a.length,c=function(){clearInterval(r.interval)};s<l;s++)t.observe(a[s],"change",c);this._observed=!0}},_serialize:function(){for(var e=this.elementToChange||{},t=this.container.querySelectorAll(r),n=t.length,o=0;o<n;o++)e[t[o].getAttribute(i)]=t[o].value;return e},_interpolate:function(e){for(var t,n,o,a=document.querySelector(":focus"),s=this.container.querySelectorAll(r),l=s.length,c=0;c<l;c++)(t=s[c])!==a&&(e&&"hidden"===t.type||(n=t.getAttribute(i),o=this.elementToChange&&"boolean"!=typeof this.elementToChange?this.elementToChange.getAttribute(n)||"":t.defaultValue,t.value=o))},show:function(e){if(!t.hasClass(this.link,n)){var r=this,i=this.container.querySelector(o);if(this.elementToChange=e,this._observe(),this._interpolate(),e&&(this.interval=setInterval(function(){r._interpolate(!0)},500)),t.addClass(this.link,n),this.container.style.display="",this.fire("show"),i&&!e)try{i.focus()}catch(a){}}},hide:function(){clearInterval(this.interval),this.elementToChange=null,t.removeClass(this.link,n),this.container.style.display="none",this.fire("hide")}})}(wysihtml5),function(e){var t=e.dom,n={position:"relative"},o={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1},r={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"},i={"x-webkit-speech":"",speech:""};e.toolbar.Speech=function(a,s){var l=document.createElement("input");if(e.browser.supportsSpeechApiOn(l)){var c=a.editor.textarea.element.getAttribute("lang");c&&(i.lang=c);var d=document.createElement("div");e.lang.object(o).merge({width:s.offsetWidth+"px",height:s.offsetHeight+"px"}),t.insert(l).into(d),t.insert(d).into(s),t.setStyles(r).on(l),t.setAttributes(i).on(l),t.setStyles(o).on(d),t.setStyles(n).on(s);var u="onwebkitspeechchange"in l?"webkitspeechchange":"speechchange";t.observe(l,u,function(){a.execCommand("insertText",l.value),l.value=""}),t.observe(l,"click",function(e){t.hasClass(s,"wysihtml5-command-disabled")&&e.preventDefault(),e.stopPropagation()})}else s.style.display="none"}}(wysihtml5),function(e){var t="wysihtml5-command-disabled",n="wysihtml5-commands-disabled",o="wysihtml5-command-active",r="wysihtml5-action-active",i=e.dom;e.toolbar.Toolbar=Base.extend({constructor:function(t,n,o){this.editor=t,this.container="string"==typeof n?document.getElementById(n):n,this.composer=t.composer,this._getLinks("command"),this._getLinks("action"),this._observe(),o&&this.show();for(var r=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]"),i=r.length,a=0;a<i;a++)new e.toolbar.Speech(this,r[a])},_getLinks:function(t){for(var n,o,r,i,a,s=this[t+"Links"]=e.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+t+"]")).get(),l=s.length,c=0,d=this[t+"Mapping"]={};c<l;c++)r=(n=s[c]).getAttribute("data-wysihtml5-"+t),i=n.getAttribute("data-wysihtml5-"+t+"-value"),o=this.container.querySelector("[data-wysihtml5-"+t+"-group='"+r+"']"),a=this._getDialog(n,r),d[r+":"+i]={link:n,group:o,name:r,value:i,dialog:a,state:!1}},_getDialog:function(t,n){var o,r,i=this,a=this.container.querySelector("[data-wysihtml5-dialog='"+n+"']");return a&&((o=e.toolbar["Dialog_"+n]?new e.toolbar["Dialog_"+n](t,a):new e.toolbar.Dialog(t,a)).on("show",function(){r=i.composer.selection.getBookmark(),i.editor.fire("show:dialog",{command:n,dialogContainer:a,commandLink:t})}),o.on("save",function(e){r&&i.composer.selection.setBookmark(r),i._execCommand(n,e),i.editor.fire("save:dialog",{command:n,dialogContainer:a,commandLink:t})}),o.on("cancel",function(){i.editor.focus(!1),i.editor.fire("cancel:dialog",{command:n,dialogContainer:a,commandLink:t})})),o},execCommand:function(e,t){if(!this.commandsDisabled){var n=this.commandMapping[e+":"+t];n&&n.dialog&&!n.state?n.dialog.show():this._execCommand(e,t)}},_execCommand:function(e,t){this.editor.focus(!1),this.composer.commands.exec(e,t),this._updateLinkStates()},execAction:function(e){var t=this.editor;"change_view"===e&&t.textarea&&(t.currentView===t.textarea?t.fire("change_view","composer"):t.fire("change_view","textarea")),"showSource"==e&&t.fire("showSource")},_observe:function(){for(var e=this,t=this.editor,o=this.container,r=this.commandLinks.concat(this.actionLinks),a=r.length,s=0;s<a;s++)"A"===r[s].nodeName?i.setAttributes({href:"javascript:;",unselectable:"on"}).on(r[s]):i.setAttributes({unselectable:"on"}).on(r[s]);i.delegate(o,"[data-wysihtml5-command], [data-wysihtml5-action]","mousedown",function(e){e.preventDefault()}),i.delegate(o,"[data-wysihtml5-command]","click",function(t){var n=this,o=n.getAttribute("data-wysihtml5-command"),r=n.getAttribute("data-wysihtml5-command-value");e.execCommand(o,r),t.preventDefault()}),i.delegate(o,"[data-wysihtml5-action]","click",function(t){var n=this.getAttribute("data-wysihtml5-action");e.execAction(n),t.preventDefault()}),t.on("interaction:composer",function(){e._updateLinkStates()}),t.on("focus:composer",function(){e.bookmark=null}),this.editor.config.handleTables&&(t.on("tableselect:composer",function(){e.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display=""}),t.on("tableunselect:composer",function(){e.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display="none"})),t.on("change_view",function(r){t.textarea&&setTimeout(function(){e.commandsDisabled="composer"!==r,e._updateLinkStates(),e.commandsDisabled?i.addClass(o,n):i.removeClass(o,n)},0)})},_updateLinkStates:function(){var n,a,s,l,c=this.commandMapping,d=this.actionMapping;for(n in c)l=c[n],this.commandsDisabled?(a=!1,i.removeClass(l.link,o),l.group&&i.removeClass(l.group,o),l.dialog&&l.dialog.hide()):(a=this.composer.commands.state(l.name,l.value),i.removeClass(l.link,t),l.group&&i.removeClass(l.group,t)),l.state!==a&&(l.state=a,a?(i.addClass(l.link,o),l.group&&i.addClass(l.group,o),l.dialog&&("object"==typeof a||e.lang.object(a).isArray()?(!l.dialog.multiselect&&e.lang.object(a).isArray()&&(a=1!==a.length||a[0],l.state=a),l.dialog.show(a)):l.dialog.hide())):(i.removeClass(l.link,o),l.group&&i.removeClass(l.group,o),l.dialog&&l.dialog.hide()));for(n in d)"change_view"===(s=d[n]).name&&(s.state=this.editor.currentView===this.editor.textarea,s.state?i.addClass(s.link,r):i.removeClass(s.link,r))},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}})}(wysihtml5),function(e){e.toolbar.Dialog_createTable=e.toolbar.Dialog.extend({show:function(e){this.base(e)}})}(wysihtml5),function(e){e.dom;var t="[data-wysihtml5-dialog-field]",n="data-wysihtml5-dialog-field";e.toolbar.Dialog_foreColorStyle=e.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){for(var e={},o=this.container.querySelectorAll(t),r=o.length,i=0;i<r;i++)e[o[i].getAttribute(n)]=o[i].value;return e},_interpolate:function(o){for(var r,i=document.querySelector(":focus"),a=this.container.querySelectorAll(t),s=a.length,l=0,c=this.elementToChange?e.lang.object(this.elementToChange).isArray()?this.elementToChange[0]:this.elementToChange:null,d=c?c.getAttribute("style"):null,u=d?e.quirks.styleParser.parseColor(d,"color"):null;l<s;l++)(r=a[l])!==i&&(o&&"hidden"===r.type||"color"===r.getAttribute(n)&&(u?u[3]&&1!=u[3]?r.value="rgba("+u[0]+","+u[1]+","+u[2]+","+u[3]+");":r.value="rgb("+u[0]+","+u[1]+","+u[2]+");":r.value="rgb(0,0,0);"))}})}(wysihtml5),function(e){e.dom;e.toolbar.Dialog_fontSizeStyle=e.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){return{size:this.container.querySelector('[data-wysihtml5-dialog-field="size"]').value}},_interpolate:function(){var t=document.querySelector(":focus"),n=this.container.querySelector("[data-wysihtml5-dialog-field='size']"),o=this.elementToChange?e.lang.object(this.elementToChange).isArray()?this.elementToChange[0]:this.elementToChange:null,r=o?o.getAttribute("style"):null,i=r?e.quirks.styleParser.parseFontSize(r):null;n&&n!==t&&i&&!/^\s*$/.test(i)&&(n.value=i)}})}(wysihtml5),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):"object"==typeof exports?exports.Handlebars=t():e.Handlebars=t()}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){(function(o){"use strict";function r(){var e=new a.HandlebarsEnvironment;return c.extend(e,a),e.SafeString=s["default"],e.Exception=l["default"],e.Utils=c,e.escapeExpression=c.escapeExpression,e.VM=d,e.template=function(t){return d.template(t,e)},e}var i=n(6)["default"];t.__esModule=!0;var a=i(n(1)),s=i(n(2)),l=i(n(3)),c=i(n(4)),d=i(n(5)),u=r();u.create=r;var h=void 0!==o?o:window,f=h.Handlebars;u.noConflict=function(){h.Handlebars===u&&(h.Handlebars=f)},u["default"]=u,t["default"]=u,e.exports=t["default"]}).call(t,function(){return this}())},function(e,t,n){"use strict";function o(e,t){this.helpers=e||{},this.partials=t||{},r(this)}function r(e){e.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new l["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')}),e.registerHelper("blockHelperMissing",function(t,n){var o=n.inverse,r=n.fn;if(!0===t)return r(this);if(!1===t||null==t)return o(this);if(h(t))return t.length>0?(n.ids&&(n.ids=[n.name]),e.helpers.each(t,n)):o(this);if(n.data&&n.ids){var a=i(n.data);a.contextPath=s.appendContextPath(n.data.contextPath,n.name),n={data:a}}return r(t,n)}),e.registerHelper("each",function(e,t){function n(t,n,r){d&&(d.key=t,d.index=n,d.first=0===n,d.last=!!r,u&&(d.contextPath=u+t)),c+=o(e[t],{data:d,blockParams:s.blockParams([e[t],t],[u+t,null])})}if(!t)throw new l["default"]("Must pass iterator to #each");var o=t.fn,r=t.inverse,a=0,c="",d=void 0,u=void 0;if(t.data&&t.ids&&(u=s.appendContextPath(t.data.contextPath,t.ids[0])+"."),f(e)&&(e=e.call(this)),t.data&&(d=i(t.data)),e&&"object"==typeof e)if(h(e))for(var m=e.length;m>a;a++)n(a,a,a===e.length-1);else{var p=void 0;for(var g in e)e.hasOwnProperty(g)&&(p&&n(p,a-1),p=g,a++);p&&n(p,a-1,!0)}return 0===a&&(c=r(this)),c}),e.registerHelper("if",function(e,t){return f(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||s.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),e.registerHelper("with",function(e,t){f(e)&&(e=e.call(this));var n=t.fn;if(s.isEmpty(e))return t.inverse(this);if(t.data&&t.ids){var o=i(t.data);o.contextPath=s.appendContextPath(t.data.contextPath,t.ids[0]),t={data:o}}return n(e,t)}),e.registerHelper("log",function(t,n){var o=n.data&&null!=n.data.level?parseInt(n.data.level,10):1;e.log(o,t)}),e.registerHelper("lookup",function(e,t){return e&&e[t]})}function i(e){var t=s.extend({},e);return t._parent=e,t}var a=n(6)["default"];t.__esModule=!0,t.HandlebarsEnvironment=o,t.createFrame=i;var s=a(n(4)),l=a(n(3)),c="3.0.1";t.VERSION=c;var d=6;t.COMPILER_REVISION=d;var u={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};t.REVISION_CHANGES=u;var h=s.isArray,f=s.isFunction,m=s.toString,p="[object Object]";o.prototype={constructor:o,logger:g,log:y,registerHelper:function(e,t){if(m.call(e)===p){if(t)throw new l["default"]("Arg not supported with multiple helpers");s.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(m.call(e)===p)s.extend(this.partials,e);else{if(void 0===t)throw new l["default"]("Attempting to register a partial as undefined");this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]}};var g={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(e,t){if("undefined"!=typeof console&&g.level<=e){var n=g.methodMap[e];(console[n]||console.log).call(console,t)}}};t.logger=g;var y=g.log;t.log=y},function(e,t){"use strict";function n(e){this.string=e}t.__esModule=!0,n.prototype.toString=n.prototype.toHTML=function(){return""+this.string},t["default"]=n,e.exports=t["default"]},function(e,t){"use strict";function n(e,t){var r=t&&t.loc,i=void 0,a=void 0;r&&(i=r.start.line,a=r.start.column,e+=" - "+i+":"+a);for(var s=Error.prototype.constructor.call(this,e),l=0;l<o.length;l++)this[o[l]]=s[o[l]];Error.captureStackTrace&&Error.captureStackTrace(this,n),r&&(this.lineNumber=i,this.column=a)}t.__esModule=!0;var o=["description","fileName","lineNumber","message","name","number","stack"];n.prototype=new Error,t["default"]=n,e.exports=t["default"]},function(e,t){"use strict";function n(e){return c[e]}function o(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&(e[n]=arguments[t][n]);return e}function r(e,t){for(var n=0,o=e.length;o>n;n++)if(e[n]===t)return n;return-1}function i(e){if("string"!=typeof e){if(e&&e.toHTML)return e.toHTML();if(null==e)return"";if(!e)return e+"";e=""+e}return u.test(e)?e.replace(d,n):e}function a(e){return!e&&0!==e||!(!m(e)||0!==e.length)}function s(e,t){return e.path=t,e}function l(e,t){return(e?e+".":"")+t}t.__esModule=!0,t.extend=o,t.indexOf=r,t.escapeExpression=i,t.isEmpty=a,t.blockParams=s,t.appendContextPath=l;var c={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},d=/[&<>"'`]/g,u=/[&<>"'`]/,h=Object.prototype.toString;t.toString=h;(f=function(e){return"function"==typeof e})(/x/)&&(t.isFunction=f=function(e){return"function"==typeof e&&"[object Function]"===h.call(e)});var f;t.isFunction=f;var m=Array.isArray||function(e){return!(!e||"object"!=typeof e)&&"[object Array]"===h.call(e)};t.isArray=m},function(e,t,n){"use strict";function o(e){var t=e&&e[0]||1,n=f.COMPILER_REVISION;if(t!==n){if(n>t){var o=f.REVISION_CHANGES[n],r=f.REVISION_CHANGES[t]
;throw new h["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+o+") or downgrade your runtime to an older version ("+r+").")}throw new h["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function r(e,t){function n(n,o,r){r.hash&&(o=u.extend({},o,r.hash)),n=t.VM.resolvePartial.call(this,n,o,r);var i=t.VM.invokePartial.call(this,n,o,r);if(null==i&&t.compile&&(r.partials[r.name]=t.compile(n,e.compilerOptions,t),i=r.partials[r.name](o,r)),null!=i){if(r.indent){for(var a=i.split("\n"),s=0,l=a.length;l>s&&(a[s]||s+1!==l);s++)a[s]=r.indent+a[s];i=a.join("\n")}return i}throw new h["default"]("The partial "+r.name+" could not be compiled when running in runtime-only mode")}function o(t){var n=void 0===arguments[1]?{}:arguments[1],i=n.data;o._setup(n),!n.partial&&e.useData&&(i=c(t,i));var a=void 0,s=e.useBlockParams?[]:void 0;return e.useDepths&&(a=n.depths?[t].concat(n.depths):[t]),e.main.call(r,t,r.helpers,r.partials,i,s,a)}if(!t)throw new h["default"]("No environment passed to template");if(!e||!e.main)throw new h["default"]("Unknown template object: "+typeof e);t.VM.checkRevision(e.compiler);var r={strict:function(e,t){if(!(t in e))throw new h["default"]('"'+t+'" not defined in '+e);return e[t]},lookup:function(e,t){for(var n=e.length,o=0;n>o;o++)if(e[o]&&null!=e[o][t])return e[o][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:u.escapeExpression,invokePartial:n,fn:function(t){return e[t]},programs:[],program:function(e,t,n,o,r){var a=this.programs[e],s=this.fn(e);return t||r||o||n?a=i(this,e,s,t,n,o,r):a||(a=this.programs[e]=i(this,e,s)),a},data:function(e,t){for(;e&&t--;)e=e._parent;return e},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n=u.extend({},t,e)),n},noop:t.VM.noop,compilerInfo:e.compiler};return o.isTop=!0,o._setup=function(n){n.partial?(r.helpers=n.helpers,r.partials=n.partials):(r.helpers=r.merge(n.helpers,t.helpers),e.usePartial&&(r.partials=r.merge(n.partials,t.partials)))},o._child=function(t,n,o,a){if(e.useBlockParams&&!o)throw new h["default"]("must pass block params");if(e.useDepths&&!a)throw new h["default"]("must pass parent depths");return i(r,t,e[t],n,0,o,a)},o}function i(e,t,n,o,r,i,a){function s(t){var r=void 0===arguments[1]?{}:arguments[1];return n.call(e,t,e.helpers,e.partials,r.data||o,i&&[r.blockParams].concat(i),a&&[t].concat(a))}return s.program=t,s.depth=a?a.length:0,s.blockParams=r||0,s}function a(e,t,n){return e?e.call||n.name||(n.name=e,e=n.partials[e]):e=n.partials[n.name],e}function s(e,t,n){if(n.partial=!0,void 0===e)throw new h["default"]("The partial "+n.name+" could not be found");return e instanceof Function?e(t,n):void 0}function l(){return""}function c(e,t){return t&&"root"in t||(t=t?f.createFrame(t):{},t.root=e),t}var d=n(6)["default"];t.__esModule=!0,t.checkRevision=o,t.template=r,t.wrapProgram=i,t.resolvePartial=a,t.invokePartial=s,t.noop=l;var u=d(n(4)),h=d(n(3)),f=n(1)},function(e,t){"use strict";t["default"]=function(e){return e&&e.__esModule?e:{"default":e}},t.__esModule=!0}])}),this.wysihtml5=this.wysihtml5||{},this.wysihtml5.tpl=this.wysihtml5.tpl||{},this.wysihtml5.tpl.blockquote=Handlebars.template({1:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},3:function(){return'      <span class="fa fa-quote-left"></span>\n'},5:function(){return'      <span class="glyphicon glyphicon-quote"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r;return'<li>\n  <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="blockquote" data-wysihtml5-display-format-name="false" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(3,o,0),inverse:this.program(5,o,0),data:o}))?r:"")+"  </a>\n</li>\n"},useData:!0}),this.wysihtml5.tpl.color=Handlebars.template({1:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r,i=this.lambda,a=this.escapeExpression;return'<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+'" data-toggle="dropdown" tabindex="-1">\n    <span class="current-color">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.black:r,e))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="black"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="black">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.black:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="silver"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="silver">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.silver:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="gray"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="gray">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.gray:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="maroon"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="maroon">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.maroon:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="red"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="red">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.red:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="purple"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="purple">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.purple:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="green"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="green">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.green:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="olive"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="olive">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.olive:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="navy"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="navy">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.navy:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="blue"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="blue">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.blue:r,e))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="orange"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="orange">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.colours:r)?r.orange:r,e))+"</a></li>\n  </ul>\n</li>\n"},useData:!0}),this.wysihtml5.tpl.emphasis=Handlebars.template({1:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},3:function(e,t,n,o){var r;return'    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="small" title="CTRL+S" tabindex="-1">'+this.escapeExpression(this.lambda(null!=(r=null!=(r=null!=e?e.locale:e)?r.emphasis:r)?r.small:r,e))+"</a>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r,i=this.lambda,a=this.escapeExpression;return'<li>\n  <div class="btn-group">\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="bold" title="CTRL+B" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.emphasis:r)?r.bold:r,e))+'</a>\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="italic" title="CTRL+I" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.emphasis:r)?r.italic:r,e))+'</a>\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="underline" title="CTRL+U" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.emphasis:r)?r.underline:r,e))+"</a>\n"+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.emphasis:r)?r.small:r,{name:"if",hash:{},fn:this.program(3,o,0),inverse:this.noop,data:o}))?r:"")+"  </div>\n</li>\n"},useData:!0}),this.wysihtml5.tpl["font-styles"]=Handlebars.template({1:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},3:function(){return'      <span class="fa fa-font"></span>\n'},5:function(){return'      <span class="glyphicon glyphicon-font"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r,i=this.lambda,a=this.escapeExpression;return'<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+'" data-toggle="dropdown">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(3,o,0),inverse:this.program(5,o,0),data:o}))?r:"")+'    <span class="current-font">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.normal:r,e))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="p" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.normal:r,e))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h1" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.h1:r,e))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h2" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.h2:r,e))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h3" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.h3:r,e))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h4" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.h4:r,e))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h5" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.h5:r,e))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h6" tabindex="-1">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.font_styles:r)?r.h6:r,e))+"</a></li>\n  </ul>\n</li>\n"},useData:!0}),this.wysihtml5.tpl.html=Handlebars.template({1:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},3:function(){return'        <span class="fa fa-pencil"></span>\n'},5:function(){return'        <span class="glyphicon glyphicon-pencil"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r;return'<li>\n  <div class="btn-group">\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-action="change_view" title="'+this.escapeExpression(this.lambda(null!=(r=null!=(r=null!=e?e.locale:e)?r.html:r)?r.edit:r,e))+'" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(3,o,0),inverse:this.program(5,o,0),data:o}))?r:"")+"    </a>\n  </div>\n</li>\n"},useData:!0}),this.wysihtml5.tpl.image=Handlebars.template({1:function(){return"modal-sm"},3:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},5:function(){return'      <span class="fa fa-file-image-o"></span>\n'},7:function(){return'      <span class="glyphicon glyphicon-picture"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r,i=this.lambda,a=this.escapeExpression;return'<li>\n  <div class="bootstrap-wysihtml5-insert-image-modal modal fade" data-wysihtml5-dialog="insertImage">\n    <div class="modal-dialog '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.smallmodals:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+'">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.image:r)?r.insert:r,e))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-image-url form-control" data-wysihtml5-dialog-field="src">\n          </div> \n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.image:r)?r.cancel:r,e))+'</a>\n          <a class="btn btn-primary" data-dismiss="modal"  data-wysihtml5-dialog-action="save" href="#">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.image:r)?r.insert:r,e))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(3,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="insertImage" title="'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.image:r)?r.insert:r,e))+'" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(5,o,0),inverse:this.program(7,o,0),data:o}))?r:"")+"  </a>\n</li>\n"},useData:!0}),this.wysihtml5.tpl.link=Handlebars.template({1:function(){return"modal-sm"},3:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},5:function(){return'      <span class="fa fa-share-square-o"></span>\n'},7:function(){return'      <span class="glyphicon glyphicon-share"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r,i=this.lambda,a=this.escapeExpression;return'<li>\n  <div class="bootstrap-wysihtml5-insert-link-modal modal fade" data-wysihtml5-dialog="createLink">\n    <div class="modal-dialog '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.smallmodals:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+'">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.link:r)?r.insert:r,e))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-link-url form-control" data-wysihtml5-dialog-field="href">\n          </div> \n          <div class="checkbox">\n            <label> \n              <input type="checkbox" class="bootstrap-wysihtml5-insert-link-target" checked>'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.link:r)?r.target:r,e))+'\n            </label>\n          </div>\n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.link:r)?r.cancel:r,e))+'</a>\n          <a href="#" class="btn btn-primary" data-dismiss="modal" data-wysihtml5-dialog-action="save">'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.link:r)?r.insert:r,e))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(3,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="createLink" title="'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.link:r)?r.insert:r,e))+'" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(5,o,0),inverse:this.program(7,o,0),data:o}))?r:"")+"  </a>\n</li>\n"},useData:!0}),this.wysihtml5.tpl.lists=Handlebars.template({1:function(e){var t;return"btn-"+this.escapeExpression(this.lambda(null!=(t=null!=(t=null!=e?e.options:e)?t.toolbar:t)?t.size:t,e))},3:function(){return'      <span class="fa fa-list-ul"></span>\n'},5:function(){return'      <span class="glyphicon glyphicon-list"></span>\n'},7:function(){return'      <span class="fa fa-list-ol"></span>\n'},9:function(){return'      <span class="glyphicon glyphicon-th-list"></span>\n'},11:function(){return'      <span class="fa fa-outdent"></span>\n'},13:function(){return'      <span class="glyphicon glyphicon-indent-right"></span>\n'},15:function(){return'      <span class="fa fa-indent"></span>\n'},17:function(){return'      <span class="glyphicon glyphicon-indent-left"></span>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,n,o){var r,i=this.lambda,a=this.escapeExpression;return'<li>\n  <div class="btn-group">\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="insertUnorderedList" title="'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.lists:r)?r.unordered:r,e))+'" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(3,o,0),inverse:this.program(5,o,0),data:o}))?r:"")+'    </a>\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="insertOrderedList" title="'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.lists:r)?r.ordered:r,e))+'" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(7,o,0),inverse:this.program(9,o,0),data:o}))?r:"")+'    </a>\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="Outdent" title="'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.lists:r)?r.outdent:r,e))+'" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(11,o,0),inverse:this.program(13,o,0),data:o}))?r:"")+'    </a>\n    <a class="btn '+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.size:r,{name:"if",hash:{},fn:this.program(1,o,0),inverse:this.noop,data:o}))?r:"")+' btn-default" data-wysihtml5-command="Indent" title="'+a(i(null!=(r=null!=(r=null!=e?e.locale:e)?r.lists:r)?r.indent:r,e))+'" tabindex="-1">\n'+(null!=(r=t["if"].call(e,null!=(r=null!=(r=null!=e?e.options:e)?r.toolbar:r)?r.fa:r,{name:"if",hash:{},fn:this.program(15,o,0),inverse:this.program(17,o,0),data:o}))?r:"")+"    </a>\n  </div>\n</li>\n"},useData:!0}),function(e){"function"==typeof define&&define.amd?define("bootstrap.wysihtml5",["jquery","wysihtml5","bootstrap","bootstrap.wysihtml5.templates","bootstrap.wysihtml5.commands"],e):e(jQuery,wysihtml5)}(function(e,t){(function(e,t){"use strict";var n=function(e,n,o){if(t.tpl[e])return t.tpl[e]({locale:n,options:o})},o=function(n,o){this.el=n;var r=e.extend(!0,{},i,o);for(var a in r.customTemplates)t.tpl[a]=r.customTemplates[a];this.toolbar=this.createToolbar(n,r),this.editor=this.createEditor(r)};o.prototype={constructor:o,createEditor:function(n){n=n||{},(n=e.extend(!0,{},n)).toolbar=this.toolbar[0];var o=new t.Editor(this.el[0],n);if(o.composer.editableArea.contentDocument?this.addMoreShortcuts(o,o.composer.editableArea.contentDocument.body||o.composer.editableArea.contentDocument,n.shortcuts):this.addMoreShortcuts(o,o.composer.editableArea,n.shortcuts),n&&n.events)for(var r in n.events)o.on(r,n.events[r]);return o.on("beforeload",this.syncBootstrapDialogEvents),o},syncBootstrapDialogEvents:function(){var t=this;e.map(this.toolbar.commandMapping,function(e){return[e]}).filter(function(e){return e.dialog}).map(function(e){return e.dialog}).forEach(function(n){n.on("show",function(){e(this.container).modal("show")}),n.on("hide",function(){e(this.container).modal("hide"),t.composer.focus()}),e(n.container).on("shown.bs.modal",function(){e(this).find("input, select, textarea").first().focus()})})},createToolbar:function(t,o){var r=this,s=e("<ul/>",{"class":"wysihtml5-toolbar",style:"display:none"}),l=o.locale||i.locale||"en";a.hasOwnProperty(l)||(console.debug("Locale '"+l+"' not found. Available locales are: "+Object.keys(a)+". Falling back to 'en'."),l="en");var c=e.extend(!0,{},a.en,a[l]);for(var d in o.toolbar)o.toolbar[d]&&(s.append(n(d,c,o)),"html"===d&&this.initHtml(s));return s.find('a[data-wysihtml5-command="formatBlock"]').click(function(t){var n=t.delegateTarget||t.target||t.srcElement,o=e(n),i=o.data("wysihtml5-display-format-name"),a=o.data("wysihtml5-format-name")||o.html();i!==undefined&&"true"!==i||r.toolbar.find(".current-font").text(a)}),s.find('a[data-wysihtml5-command="foreColor"]').click(function(t){var n=t.target||t.srcElement,o=e(n);r.toolbar.find(".current-color").text(o.html())}),this.el.before(s),s},initHtml:function(e){var t='a[data-wysihtml5-action="change_view"]';e.find(t).click(function(){e.find("a.btn").not(t).toggleClass("disabled")})},addMoreShortcuts:function(e,n,o){t.dom.observe(n,"keydown",function(n){var r=n.keyCode,i=o[r];if((n.ctrlKey||n.metaKey||n.altKey)&&i&&t.commands[i]){var a=e.toolbar.commandMapping[i+":null"];a&&a.dialog&&!a.state?a.dialog.show():t.commands[i].exec(e.composer,i),n.preventDefault()}})}};var r={resetDefaults:function(){e.fn.wysihtml5.defaultOptions=e.extend(!0,{},e.fn.wysihtml5.defaultOptionsCache)},bypassDefaults:function(t){return this.each(function(){var n=e(this);n.data("wysihtml5",new o(n,t))})},shallowExtend:function(t){var n=e.extend({},e.fn.wysihtml5.defaultOptions,t||{},e(this).data()),o=this;return r.bypassDefaults.apply(o,[n])},deepExtend:function(t){var n=e.extend(!0,{},e.fn.wysihtml5.defaultOptions,t||{}),o=this;return r.bypassDefaults.apply(o,[n])},init:function(e){var t=this;return r.shallowExtend.apply(t,[e])}};e.fn.wysihtml5=function(t){return r[t]?r[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void e.error("Method "+t+" does not exist on jQuery.wysihtml5"):r.init.apply(this,arguments)},e.fn.wysihtml5.Constructor=o;var i=e.fn.wysihtml5.defaultOptions={toolbar:{"font-styles":!0,color:!1,emphasis:{small:!0},blockquote:!0,lists:!0,html:!1,link:!0,image:!0,smallmodals:!1},parserRules:{classes:{"wysiwyg-color-silver":1,"wysiwyg-color-gray":1,"wysiwyg-color-white":1,"wysiwyg-color-maroon":1,"wysiwyg-color-red":1,"wysiwyg-color-purple":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-olive":1,"wysiwyg-color-yellow":1,"wysiwyg-color-navy":1,"wysiwyg-color-blue":1,"wysiwyg-color-teal":1,"wysiwyg-color-aqua":1,"wysiwyg-color-orange":1},tags:{b:{},i:{},strong:{},em:{},p:{},br:{},ol:{},ul:{},li:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},blockquote:{},u:1,img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"}},a:{check_attributes:{href:"url"},set_attributes:{target:"_blank",rel:"nofollow"}},span:1,div:1,small:1,code:1,pre:1}},locale:"en",shortcuts:{83:"small"}};"undefined"==typeof e.fn.wysihtml5.defaultOptionsCache&&(e.fn.wysihtml5.defaultOptionsCache=e.extend(!0,{},e.fn.wysihtml5.defaultOptions));var a=e.fn.wysihtml5.locale={}})(e,t)}),function(e){e.commands.small={exec:function(t,n){return e.commands.formatInline.exec(t,n,"small")},state:function(t,n){return e.commands.formatInline.state(t,n,"small")}}}(wysihtml5),function(e){"function"==typeof define&&define.amd?define("bootstrap.wysihtml5.en-US",["jquery","bootstrap.wysihtml5"],e):e(jQuery)}(function(e){e.fn.wysihtml5.locale.en=e.fn.wysihtml5.locale["en-US"]={font_styles:{normal:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},emphasis:{bold:"Bold",italic:"Italic",underline:"Underline",small:"Small"},lists:{unordered:"Unordered list",ordered:"Ordered list",outdent:"Outdent",indent:"Indent"},link:{insert:"Insert link",cancel:"Cancel",target:"Open link in new window"},image:{insert:"Insert image",cancel:"Cancel"},html:{edit:"Edit HTML"},colours:{black:"Black",silver:"Silver",gray:"Grey",maroon:"Maroon",red:"Red",purple:"Purple",green:"Green",olive:"Olive",navy:"Navy",blue:"Blue",orange:"Orange"}}});